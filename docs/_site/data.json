[{"permalink":"//","layout":"default","title":null,"content":"<a href=\"https://www.top500.org/\"><img src=\"https://www.top500.org/static//images/Top500_logo.png\" align=\"right\"></a>\n\n# CSD3 applications\n\n![CI](https://github.com/rundocs/jekyll-rtd-theme/workflows/CI/badge.svg?branch=develop)\n![jsDelivr](https://data.jsdelivr.com/v1/package/gh/rundocs/jekyll-rtd-theme/badge)\n\n## The collection covers system and other software.\n\n{% include list.liquid all=true %}\n","dir":"/","name":"README.md","path":"README.md","url":"/"},{"sort":1,"layout":"default","title":"ABCtoolbox","content":"<h1 id=\"abctoolbox\">ABCtoolbox</h1>\n\n<p>Web page: https://bitbucket.org/wegmannlab/abctoolbox/wiki/Home</p>\n\n<div class=\"language-bash highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>git clone <span class=\"nt\">--depth</span> 1 https://bitbucket.org/wegmannlab/abctoolbox.git\n<span class=\"c\"># g++ -O3 -o ABCtoolbox *.cpp</span>\nmodule load openmpi/3.1.4-gcc-7.2.0\ng++ <span class=\"nt\">-O3</span> <span class=\"nt\">-o</span> ABCtoolbox <span class=\"k\">*</span>.cpp <span class=\"nt\">-DUSE_OMP</span> <span class=\"nt\">-fopenmp</span>\n</code></pre> </div></div>\n\n<p>Note that the installation guide has misspecified the repository.</p>\n","dir":"/applications/","name":"ABCtoolbox.md","path":"applications/ABCtoolbox.md","url":"/applications/ABCtoolbox.html"},{"sort":1,"permalink":"/systems/","layout":"default","title":"The system","content":"<h1 id=\"the-system\">The system</h1>\n\n<p>source: <code class=\"language-plaintext highlighter-rouge\">systems/README.md</code></p>\n\n<ul>\n <li><a href=\"/systems/system.html\">System</a></li>\n <li><a href=\"/systems/login.html\">Login</a></li>\n <li><a href=\"/systems/directories.html\">Directories</a></li>\n <li><a href=\"/systems/policies.html\">Policies</a></li>\n <li><a href=\"/systems/email.html\">email</a></li>\n <li><a href=\"/systems/software.html\">Software</a></li>\n <li><a href=\"/systems/training.html\">Training</a></li>\n <li><a href=\"/systems/acknowledgement.html\">Acknowledgement</a></li>\n <li><a href=\"/systems/contacts.html\">Contacts</a></li>\n</ul>\n","dir":"/systems/","name":"README.md","path":"systems/README.md","url":"/systems/"},{"sort":1,"layout":"default","title":"System","content":"# System\n\nCSD3 stands for the Cambridge Service for Data Driven Discovery by [Research Computing Services](https://www.csd3.cam.ac.uk/), which provies an excellent [documentation](https://docs.hpc.cam.ac.uk/hpc/) besides [other services](https://www.hpc.cam.ac.uk/).\nHere some aspects are highlighted from the perspectives of the [Cardiovascular Epidemiology Unit](https://www.phpc.cam.ac.uk/ceu/) (CEU), where all information about procedures and access requests can be found from **W:\\Administration\\CSD3 Data Users**.\n\nBasic information is available from a CSD3 console\n\n```bash\n# system bit\ngetconf LONG_BIT\n# system information\nuname -a\n# -s kernel name\n# -n node name\n# -r kernel release\n# -v kernel version\n# -p processor\n# -o operating system\n# Linux Standard Base (lsb) and distribution information\nlsb_release -a\n# CPU information\nlscpu\nwatch -n.1 \"cat /proc/cpuinfo | grep \\\"^[c]pu MHz\\\"\"\n```\n\nwhere breakdown of `uname -a` is also given and for instance `lsb_release -a` gives\n\n```\nDistributor ID: Scientific\nDescription: Scientific Linux release 7.7 (Nitrogen)\nRelease: 7.7\nCodename: Nitrogen\n```\n\nso the system is Scientific Linux 7 (SL7), see [http://www.scientificlinux.org/](http://www.scientificlinux.org/), also /usr/share/doc/HTML/en-US/index.html,\n","dir":"/systems/","name":"system.md","path":"systems/system.md","url":"/systems/system.html"},{"sort":1,"layout":"default","title":"Front matter","content":"# Front matter\n\nIf you have a Jekyll page that doesn't have a title specified in the YAML Front Matter, but the first non-whitespace line in the page is a Markdown H1/H2/H3, [this plugin](https://rubygems.org/gems/jekyll-titles-from-headings) instructs Jekyll to use that first heading as the page's title.\n\nIf you have a readme file, and your site doesn't otherwise have an index file, [this plugin](https://rubygems.org/gems/jekyll-readme-index) instructs Jekyll to use the readme as the site's index. That's it. No more, no less.\n\n```tip\nAll of the github pages features is supported\n```\n","dir":"/writing/","name":"front-matter.md","path":"writing/front-matter.md","url":"/writing/front-matter.html"},{"sort":1,"permalink":"/writing/test/","layout":"default","title":"Test Documentation","content":"<h1 id=\"test-documentation\">Test Documentation</h1>\n\n<div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>{% include list.liquid all=true %}\n</code></pre> </div></div>\n\n<ul>\n <li><a href=\"/writing/test/markdown.html\">Markdown Elements</a></li>\n <li><a href=\"/writing/test/toasts.html\">Toasts Card</a></li>\n <li><a href=\"/writing/test/codes.html\">Code Blocks</a></li>\n <li><a href=\"/writing/test/mermaid.html\">Mermaid Test</a></li>\n <li><a href=\"/writing/test/emoji.html\">Emoji Test</a></li>\n <li><a href=\"/writing/test/gist.html\">Gist Test</a></li>\n <li><a href=\"/writing/test/avatar.html\">Avatar Test</a></li>\n <li><a href=\"/writing/test/mentions.html\">Mentions Test</a></li>\n <li><a href=\"/writing/test/fonts.html\">Fonts Test</a></li>\n <li><a href=\"/writing/test/utilities.html\">Primer Utilities Test</a></li>\n</ul>\n","dir":"/writing/test/","name":"README.md","path":"writing/test/README.md","url":"/writing/test/"},{"sort":1,"layout":"default","title":"Markdown Elements","content":"# Markdown Elements\n\nText can be **bold**, _italic_, or ~~strikethrough~~. [Links](https://github.com) should be blue with no underlines (unless hovered over).\n\nThere should be whitespace between paragraphs. There should be whitespace between paragraphs. There should be whitespace between paragraphs. There should be whitespace between paragraphs.\n\nThere should be whitespace between paragraphs. There should be whitespace between paragraphs. There should be whitespace between paragraphs. There should be whitespace between paragraphs.\n\n> There should be no margin above this first sentence.\n>\n> Blockquotes should be a lighter gray with a gray border along the left side.\n>\n> There should be no margin below this final sentence.\n\n# Header 1\n\nThis is a normal paragraph following a header. Bacon ipsum dolor sit amet t-bone doner shank drumstick, pork belly porchetta chuck sausage brisket ham hock rump pig. Chuck kielbasa leberkas, pork bresaola ham hock filet mignon cow shoulder short ribs biltong.\n\n## Header 2\n\n> This is a blockquote following a header. Bacon ipsum dolor sit amet t-bone doner shank drumstick, pork belly porchetta chuck sausage brisket ham hock rump pig. Chuck kielbasa leberkas, pork bresaola ham hock filet mignon cow shoulder short ribs biltong.\n\n### Header 3\n\n```\nThis is a code block following a header.\n```\n\n#### Header 4\n\n- This is an unordered list following a header.\n- This is an unordered list following a header.\n- This is an unordered list following a header.\n\n##### Header 5\n\n1. This is an ordered list following a header.\n2. This is an ordered list following a header.\n3. This is an ordered list following a header.\n\n###### Header 6\n\n| What | Follows |\n| ------- | -------- |\n| A table | A header |\n| A table | A header |\n| A table | A header |\n\n---\n\nThere's a horizontal rule above and below this.\n\n---\n\nHere is an unordered list:\n\n- Salt-n-Pepa\n- Bel Biv DeVoe\n- Kid 'N Play\n\nAnd an ordered list:\n\n1. Michael Jackson\n2. Michael Bolton\n3. Michael Bublé\n\nAnd an unordered task list:\n\n- [x] Create a sample markdown document\n- [x] Add task lists to it\n- [ ] Take a vacation\n\nAnd a \"mixed\" task list:\n\n- [ ] Steal underpants\n- ?\n- [ ] Profit!\n\nAnd a nested list:\n\n- Jackson 5\n - Michael\n - Tito\n - Jackie\n - Marlon\n - Jermaine\n- TMNT\n - Leonardo\n - Michelangelo\n - Donatello\n - Raphael\n\nDefinition lists can be used with HTML syntax. Definition terms are bold and italic.\n\n<dl>\n <dt>Name</dt>\n <dd>Godzilla</dd>\n <dt>Born</dt>\n <dd>1952</dd>\n <dt>Birthplace</dt>\n <dd>Japan</dd>\n <dt>Color</dt>\n <dd>Green</dd>\n</dl>\n\n---\n\nTables should have bold headings and alternating shaded rows.\n\n| Artist | Album | Year |\n| --------------- | -------------- | ---- |\n| Michael Jackson | Thriller | 1982 |\n| Prince | Purple Rain | 1984 |\n| Beastie Boys | License to Ill | 1986 |\n\nIf a table is too wide, it should condense down and/or scroll horizontally.\n\n<!-- prettier-ignore-start -->\n\n| Artist | Album | Year | Label | Awards | Songs |\n|-------------------|-----------------|------|-------------|----------|-----------|\n| Michael Jackson | Thriller | 1982 | Epic Records | Grammy Award for Album of the Year, American Music Award for Favorite Pop/Rock Album, American Music Award for Favorite Soul/R&B Album, Brit Award for Best Selling Album, Grammy Award for Best Engineered Album, Non-Classical | Wanna Be Startin' Somethin', Baby Be Mine, The Girl Is Mine, Thriller, Beat It, Billie Jean, Human Nature, P.Y.T. (Pretty Young Thing), The Lady in My Life |\n| Prince | Purple Rain | 1984 | Warner Brothers Records | Grammy Award for Best Score Soundtrack for Visual Media, American Music Award for Favorite Pop/Rock Album, American Music Award for Favorite Soul/R&B Album, Brit Award for Best Soundtrack/Cast Recording, Grammy Award for Best Rock Performance by a Duo or Group with Vocal | Let's Go Crazy, Take Me With U, The Beautiful Ones, Computer Blue, Darling Nikki, When Doves Cry, I Would Die 4 U, Baby I'm a Star, Purple Rain |\n| Beastie Boys | License to Ill | 1986 | Mercury Records | noawardsbutthistablecelliswide | Rhymin & Stealin, The New Style, She's Crafty, Posse in Effect, Slow Ride, Girls, (You Gotta) Fight for Your Right, No Sleep Till Brooklyn, Paul Revere, Hold It Now, Hit It, Brass Monkey, Slow and Low, Time to Get Ill |\n\n<!-- prettier-ignore-end -->\n\n---\n\nCode snippets like `var foo = \"bar\";` can be shown inline.\n\nAlso, `this should vertically align` ~~`with this`~~ ~~and this~~.\n\nCode can also be shown in a block element.\n\n```\nvar foo = \"bar\";\n```\n\nCode can also use syntax highlighting.\n\n```javascript\nvar foo = \"bar\";\n```\n\n```\nLong, single-line code blocks should not wrap. They should horizontally scroll if they are too long. This line should be long enough to demonstrate this.\n```\n\n```javascript\nvar foo =\n \"The same thing is true for code with syntax highlighting. A single line of code should horizontally scroll if it is really long.\";\n```\n\nInline code inside table cells should still be distinguishable.\n\n| Language | Code |\n| ---------- | ------------------ |\n| Javascript | `var foo = \"bar\";` |\n| Ruby | `foo = \"bar\"` |\n\n---\n\nSmall images should be shown at their actual size.\n\n![Octocat](https://github.githubassets.com/images/icons/emoji/octocat.png)\n\nLarge images should always scale down and fit in the content container.\n\n![Branching](https://guides.github.com/activities/hello-world/branching.png)\n\n```\nThis is the final element on the page and there should be no margin below this.\n```\n","dir":"/writing/test/","name":"markdown.md","path":"writing/test/markdown.md","url":"/writing/test/markdown.html"},{"sort":2,"layout":"default","title":"AEGIS","content":"<h1 id=\"aegis\">AEGIS</h1>\n\n<p>Web: http://aegis.stanford.edu/</p>\n\n<p>The installation follows the documentation but requires slight change,</p>\n\n<div class=\"language-bash highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"c\"># default Python 3.6</span>\nmodule load python\n\nvirtualenv py36\n<span class=\"nb\">source </span>py36/bin/activate\ngit clone https://github.com/junjiezhujason/aegis.git\n<span class=\"nb\">cd </span>aegis\n\n<span class=\"c\"># pip3 install -r requirements.txt</span>\n<span class=\"nb\">cat </span>requirements.txt | <span class=\"se\">\\</span>\n<span class=\"nb\">grep</span> <span class=\"nt\">-v</span> MarkupSafe | <span class=\"se\">\\</span>\nxargs pip3 <span class=\"nb\">install</span>\n\n<span class=\"c\"># setup</span>\n<span class=\"c\">#!/usr/bin/bash</span>\n<span class=\"nb\">export </span><span class=\"nv\">PROJECT_PATH</span><span class=\"o\">=</span>/home/<span class=\"nv\">$USER</span>/aegis/data\n<span class=\"nb\">cd</span> <span class=\"k\">${</span><span class=\"nv\">PROJECT_PATH</span><span class=\"k\">}</span>\n<span class=\"c\"># wget -qO- http://stanford.edu/~jjzhu/fileshare/aegis/local_20180719.tar.gz | tar -xvzf local_20180719.tar.gz</span>\n<span class=\"nb\">cd</span> -\npython3 main.py <span class=\"nt\">--lite</span> <span class=\"nt\">--port</span> 5001 <span class=\"nt\">--folder</span> <span class=\"k\">${</span><span class=\"nv\">PROJECT_PATH</span><span class=\"k\">}</span> &amp;\npython3 main.py <span class=\"nt\">--port</span> 5002 <span class=\"nt\">--folder</span> <span class=\"k\">${</span><span class=\"nv\">PROJECT_PATH</span><span class=\"k\">}</span> &amp;\nfirefox http://localhost:5002 &amp;\n</code></pre> </div></div>\n\n<p>as it appears that MarkupSafe could not be installed according to the predefined order.</p>\n","dir":"/applications/","name":"AEGIS.md","path":"applications/AEGIS.md","url":"/applications/AEGIS.html"},{"sort":2,"permalink":"/cardio/","layout":"default","title":"cardio","content":"<h1 id=\"cardio\">cardio</h1>\n\n<p>source: <code class=\"language-plaintext highlighter-rouge\">cardio/README.md</code></p>\n\n<p>Cardio is the HPC facility at the CEU.</p>\n\n<h2 id=\"csd3-partition\">CSD3 partition</h2>\n\n<div class=\"language-bash highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>scontrol show part\n<span class=\"c\"># cpu-o-1 for interactive jobs with no limit on cpus per user expecting fair usage</span>\n<span class=\"c\"># cpu-o-[2-5] for long jobs with maximum cpus per user set to 40 and a maximum wall time of 7 days</span>\n<span class=\"c\"># cpu-o-7 for short jobs with a maximum wall time of 24 hours</span>\n\n<span class=\"c\"># Interactive jobs</span>\n\n<span class=\"c\">#SBATCH -A CARDIO-SL0-CPU</span>\n<span class=\"c\">#SBATCH -p cardio_intr</span>\n<span class=\"c\">#SBATCH --qos=cardio_intr</span>\n\n<span class=\"c\"># Long jobs</span>\n\n<span class=\"c\">#SBATCH -A CARDIO-SL0-CPU</span>\n<span class=\"c\">#SBATCH -p cardio</span>\n<span class=\"c\">#SBATCH --qos=cardio</span>\n\n<span class=\"c\"># Short jobs</span>\n\n<span class=\"c\">#SBATCH -A CARDIO-SL0-CPU</span>\n<span class=\"c\">#SBATCH -p cardio_short</span>\n<span class=\"c\">#SBATCH --qos=cardio_short</span>\n</code></pre> </div></div>\n\n<hr />\n\n<h2 id=\"legacy-materials\">Legacy materials</h2>\n\n<h3 id=\"login\">login</h3>\n\n<p>Automatic login can be enabled with <code class=\"language-plaintext highlighter-rouge\">ssh-copy-id cardio-login.hpc.cam.ac.uk</code>.</p>\n\n<h3 id=\"migration\">Migration</h3>\n\n<p>It is possible to fetch <code class=\"language-plaintext highlighter-rouge\">my-file-on-Cardio</code> with</p>\n\n<div class=\"language-bash highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>scp cardio-login.hpc.cam.ac.uk:/home/<span class=\"nv\">$USER</span>/my-file-on-Cardio <span class=\"nb\">.</span>\n</code></pre> </div></div>\n\n<p>as with <code class=\"language-plaintext highlighter-rouge\">sftp</code>, noting the <code class=\"language-plaintext highlighter-rouge\">-r</code> option for both could be very useful. More generally, it is preferable to use <code class=\"language-plaintext highlighter-rouge\">rsync</code>, <a href=\"https://rsync.samba.org/\">https://rsync.samba.org/</a>.</p>\n\n<p>Old version on Cardio, rsync 3.0.6, gives errors,</p>\n\n<div class=\"language-bash highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>rsync <span class=\"nt\">-av</span> <span class=\"nt\">--partial</span> mydir/ login-cpu.hpc.cam.ac.uk:/rds/user/<span class=\"nv\">$USER</span>/hpc-work/mydir\n\nErrors after successfully sending a number of files :\nrsync: writefd_unbuffered failed to write 4 bytes to socket <span class=\"o\">[</span>sender]: Broken pipe <span class=\"o\">(</span>32<span class=\"o\">)</span>\nrsync: connection unexpectedly closed <span class=\"o\">(</span>604 bytes received so far<span class=\"o\">)</span> <span class=\"o\">[</span>sender]\nrsync error: error <span class=\"k\">in </span>rsync protocol data stream <span class=\"o\">(</span>code 12<span class=\"o\">)</span> at io.c<span class=\"o\">(</span>600<span class=\"o\">)</span> <span class=\"o\">[</span><span class=\"nv\">sender</span><span class=\"o\">=</span>3.0.6]\n</code></pre> </div></div>\n\n<p>Bram Prins (<a href=\"mailto:bp406@medschl.cam.ac.uk\">bp406@medschl.cam.ac.uk</a>) has the latest version (3.1.3) that doesn’t give this error here:</p>\n\n<p>/DO-NOT-MODIFY-SCRATCH/bp406/apps/software/data_manipulation/rsync-3.1.3/rsync</p>\n\n<p>Note <strong>/scratch</strong> at Cardio is now <strong>/DO-NOT-MODIFY-SCRATCH</strong> – an example is <a href=\"/cardio/jp.sh\">jp.sh</a>.</p>\n\n<h3 id=\"r-package-reinstallations\">R package reinstallations</h3>\n\n<p>Package redeployment is illustrated with R below for building R package list from <strong><em>/home/$USER/R</em></strong> at Cardio to be resintalled to <strong><em>/rds/user/$USER/hpc-work/R</em></strong> at CSD3.</p>\n\n<p>We can use screen copy of package list from Cardio since users do not have write permission.</p>\n\n<p><strong>On Cardio</strong></p>\n\n<div class=\"language-r highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"w\">  </span><span class=\"n\">home</span><span class=\"w\"> </span><span class=\"o\">&lt;-</span><span class=\"w\"> </span><span class=\"n\">Sys.getenv</span><span class=\"p\">(</span><span class=\"s2\">\"HOME\"</span><span class=\"p\">)</span><span class=\"w\">\n  </span><span class=\"n\">from</span><span class=\"w\"> </span><span class=\"o\">&lt;-</span><span class=\"w\"> </span><span class=\"n\">paste0</span><span class=\"p\">(</span><span class=\"n\">home</span><span class=\"p\">,</span><span class=\"s2\">\"/R\"</span><span class=\"p\">)</span><span class=\"w\">\n  </span><span class=\"n\">pkgs</span><span class=\"w\"> </span><span class=\"o\">&lt;-</span><span class=\"w\"> </span><span class=\"n\">unname</span><span class=\"p\">(</span><span class=\"n\">installed.packages</span><span class=\"p\">(</span><span class=\"n\">lib.loc</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">from</span><span class=\"p\">)[,</span><span class=\"w\"> </span><span class=\"s2\">\"Package\"</span><span class=\"p\">])</span><span class=\"w\">\n  </span><span class=\"n\">edit</span><span class=\"p\">(</span><span class=\"n\">pkgs</span><span class=\"p\">)</span><span class=\"w\">\n</span></code></pre> </div></div>\n\n<p><strong>On CSD3</strong></p>\n\n<div class=\"language-r highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"w\">  </span><span class=\"n\">pkgs</span><span class=\"w\"> </span><span class=\"o\">&lt;-</span><span class=\"w\"> </span><span class=\"s2\">\"mark and copy the list as given in c() above with Shift+Ins\"</span><span class=\"w\">\n  </span><span class=\"n\">user</span><span class=\"w\"> </span><span class=\"o\">&lt;-</span><span class=\"w\"> </span><span class=\"n\">Sys.getenv</span><span class=\"p\">(</span><span class=\"s2\">\"USER\"</span><span class=\"p\">)</span><span class=\"w\">\n  </span><span class=\"n\">to</span><span class=\"w\"> </span><span class=\"o\">&lt;-</span><span class=\"w\"> </span><span class=\"n\">paste0</span><span class=\"p\">(</span><span class=\"s2\">\"/rds/user/\"</span><span class=\"p\">,</span><span class=\"n\">user</span><span class=\"p\">,</span><span class=\"s2\">\"/hpc-work/R\"</span><span class=\"p\">)</span><span class=\"w\">\n  </span><span class=\"n\">install.packages</span><span class=\"p\">(</span><span class=\"n\">pkgs</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">lib</span><span class=\"o\">=</span><span class=\"n\">to</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">repos</span><span class=\"o\">=</span><span class=\"s2\">\"https://cran.r-project.org\"</span><span class=\"p\">)</span><span class=\"w\">\n</span></code></pre> </div></div>\n\n<p>If a package list is already built one can reinstall them as follows.</p>\n\n<div class=\"language-r highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"n\">user</span><span class=\"w\"> </span><span class=\"o\">&lt;-</span><span class=\"w\"> </span><span class=\"n\">Sys.getenv</span><span class=\"p\">(</span><span class=\"s2\">\"USER\"</span><span class=\"p\">)</span><span class=\"w\">\n</span><span class=\"n\">location</span><span class=\"w\"> </span><span class=\"o\">&lt;-</span><span class=\"w\"> </span><span class=\"n\">paste0</span><span class=\"p\">(</span><span class=\"s2\">\"/rds/user/\"</span><span class=\"p\">,</span><span class=\"n\">user</span><span class=\"p\">,</span><span class=\"s2\">\"/hpc-work/R\"</span><span class=\"p\">)</span><span class=\"w\">\n</span><span class=\"n\">pkgs</span><span class=\"w\"> </span><span class=\"o\">&lt;-</span><span class=\"w\"> </span><span class=\"n\">unname</span><span class=\"p\">(</span><span class=\"n\">installed.packages</span><span class=\"p\">(</span><span class=\"n\">lib.loc</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">location</span><span class=\"p\">)[,</span><span class=\"w\"> </span><span class=\"s2\">\"Package\"</span><span class=\"p\">])</span><span class=\"w\">\n</span><span class=\"n\">install.packages</span><span class=\"p\">(</span><span class=\"n\">pkgs</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">lib</span><span class=\"o\">=</span><span class=\"n\">location</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">repos</span><span class=\"o\">=</span><span class=\"s2\">\"https://cran.r-project.org\"</span><span class=\"p\">)</span><span class=\"w\">\n</span></code></pre> </div></div>\n\n<p>A version by Scott Ritchie (<a href=\"mailto:sr827@medschl.cam.ac.uk\">sr827@medschl.cam.ac.uk</a>), <a href=\"/cardio/reinstall_r_pkgs.R\">reinstall_r_pkgs.R</a>, also touches upon Bioconductor,\nwhose package installations and updates are described at <a href=\"https://bioconductor.org/install/\">https://bioconductor.org/install/</a>.</p>\n","dir":"/cardio/","name":"README.md","path":"cardio/README.md","url":"/cardio/"},{"sort":2,"layout":"default","title":"Login","content":"# Login\n\nPossible login nodes on csd3 are: login.hpc, login-cpu.hpc, login-gpu.hpc, login-gfx.hpc, login-e-N.hpc.\n\nTo reset Raven password, follow https://password.csx.cam.ac.uk/.\n\nTo establish host keys one resorts to `ssh-keygen`; the easiest is to accept the default.\n\nThe CSD3 hostkeys are described here, https://docs.hpc.cam.ac.uk/hpc/user-guide/hostkeys.html. From 1st February 2020, the following script needs to be run\nfrom a local machine,\n\n```bash\ncp ~/.ssh/known_hosts ~/.ssh/known_hosts.`date +%F`\nsed -i -e '/128\\.232\\.224/d' -e '/.*\\.hpc\\.cam\\.ac\\.uk/d' ~/.ssh/known_hosts\n# to remove the entry, try:\n# ssh-keygen -f \"/home/$USER/.ssh/known_hosts\" -R \"login.hpc.cam.ac.uk\"\n```\n\nAutomatic login via ssh/sftp can be enabled with\n\n```bash\nssh-copy-id login.hpc.cam.ac.uk\n```\n\nfrom a Bash console after one login. If this is not set up, follow these steps,\n\n```bash\nssh-keygen\n# Enter file in which to save the key (/home/$USER/.ssh/id_rsa): mykey\n# Enter passphrase (empty for no passphrase):\n# Enter same passphrase again:\n# Your identification has been saved in mykey.\n# Your public key has been saved in mykey.pub.\nThe key fingerprint is:\nssh-copy-id -i ~/.ssh/mykey.pub login.hpc.cam.ac.uk\n```\n\nas in [https://www.ssh.com/ssh/copy-id](https://www.ssh.com/ssh/copy-id). At a specific host, try\n\n```bash\nmkdir .ssh\nchmod 700 .ssh\nssh-keygen\ncd .ssh\nchmod 700 mykey*\ntouch authorized_keys\nchmod 700 authorized_keys\nssh-copy-id -i mykey.pub user@remoteserver\n```\n\nEnvironmental variables can be set inside `~/.bashrc`. In particular when some changes have been made, one can enable them with\n\n```bash\nsource ~/.bashrc\n```\n\nwhere the `~` sign is equivalent to ${HOME}.\n\nWhen there is an error `'abrt-cli status' timed out`, one should remove ${HOME}/.cache and relogin/source .bashrc.\n","dir":"/systems/","name":"login.md","path":"systems/login.md","url":"/systems/login.html"},{"sort":2,"layout":"default","title":"List directory","content":"# List directory\n\nIf you want to list all `pages` in the current directory, add following code to your markdown file!\n\n {% raw %}\n {% include list.liquid %}\n {% endraw %}\n\nThen Generate a list like this:\n{% include list.liquid %}\n\nIf you want to list all `pages and sub directory` in the current directory, add following code to your markdown file!\n\n {% raw %}\n {% include list.liquid all=true %}\n {% endraw %}\n\nThen Generate a list like this [table of contents]({{ site.baseurl }}/docs/)!\n","dir":"/writing/","name":"list.md","path":"writing/list.md","url":"/writing/list.html"},{"sort":2,"layout":"default","title":"Toasts Card","content":"# Toasts Card\n\nTHIS IS TOO LONG, NEED UPDATE! HERE IS SOME IDEAS:\n\n- https://primer.style/css/components/box\n- https://primer.style/css/components/toasts\n\n```note\n## This is a note\n\nMarkdown is supported, Text can be **bold**, _italic_, or ~~strikethrough~~. [Links](https://github.com) should be blue with no underlines\n\n`inline code`\n\n[`inline code inside link`](./)\n```\n\n```note\nThis is note2\n```\n\n```note\nThis is note3\n```\n\n```tip\nIt’s bigger than a bread box.\n```\n\n```tip\nIt’s tip 2\n```\n\n```warning\nStrong prose may provoke extreme mental exertion. Reader discretion is strongly advised.\n```\n\n```danger\nMad scientist at work!\n```\n","dir":"/writing/test/","name":"toasts.md","path":"writing/test/toasts.md","url":"/writing/test/toasts.html"},{"sort":3,"permalink":"/applications/","layout":"default","title":"Applications","content":"<h1 id=\"applications\">Applications</h1>\n\n<p>source: <code class=\"language-plaintext highlighter-rouge\">applications/README.md</code></p>\n\n<p>Whenever appropriate, it is assumed that the destination of software installation is ${HPC_WORK}, e.g.,\nvia <code class=\"language-plaintext highlighter-rouge\">export HPC_WORK=/rds/user/$USER/hpc-work</code> in .bashrc.</p>\n\n<ul>\n <li><a href=\"/applications/ABCtoolbox.html\">ABCtoolbox</a></li>\n <li><a href=\"/applications/AEGIS.html\">AEGIS</a></li>\n <li><a href=\"/applications/akt.html\">akt</a></li>\n <li><a href=\"/applications/ANNOVAR.html\">ANNOVAR</a></li>\n <li><a href=\"/applications/bcftools.html\">bcftools</a></li>\n <li><a href=\"/applications/bedops.html\">bedops</a></li>\n <li><a href=\"/applications/bgenix.html\">bgenix</a></li>\n <li><a href=\"/applications/brms.html\">R/brms</a></li>\n <li><a href=\"/applications/CaVEMaN.html\">CaVEMaN</a></li>\n <li><a href=\"/applications/citeproc.html\">citeproc</a></li>\n <li><a href=\"/applications/DosageConverter.html\">DosageConverter</a></li>\n <li><a href=\"/applications/EasyQC.html\">EasyQC</a></li>\n <li><a href=\"/applications/gnn.html\">R/gnn</a></li>\n <li><a href=\"/applications/gsutil.html\">gsutil</a></li>\n <li><a href=\"/applications/gwas2vcf.html\">gwas2vcf</a></li>\n <li><a href=\"/applications/hail.html\">hail</a></li>\n <li><a href=\"/applications/HESS.html\">HESS</a></li>\n <li><a href=\"/applications/KentUtils.html\">KentUtils</a></li>\n <li><a href=\"/applications/lapack.html\">lapack</a></li>\n <li><a href=\"/applications/LDlinkR.html\">R/LDlinkR</a></li>\n <li><a href=\"/applications/LEMMA.html\">LEMMA</a></li>\n <li><a href=\"/applications/magick.html\">R/magick</a></li>\n <li><a href=\"/applications/MetaXcan.html\">MetaXcan</a></li>\n <li><a href=\"/applications/pandoc.html\">pandoc</a></li>\n <li><a href=\"/applications/pca_projection.html\">PCA projection</a></li>\n <li><a href=\"/applications/PhenoScanner.html\">R/PhenoScanner</a></li>\n <li><a href=\"/applications/PKI.html\">R/PKI</a></li>\n <li><a href=\"/applications/plumber.html\">R/plumber</a></li>\n <li><a href=\"/applications/polyphen-2.html\">polyphen-2</a></li>\n <li><a href=\"/applications/poppler.html\">poppler</a></li>\n <li><a href=\"/applications/protolite.html\">R/protolite</a></li>\n <li><a href=\"/applications/PRSice.html\">PRSice</a></li>\n <li><a href=\"/applications/PRSoS.html\">PRSoS</a></li>\n <li><a href=\"/applications/pspp.html\">pspp</a></li>\n <li><a href=\"/applications/qpdf.html\">qpdf</a></li>\n <li><a href=\"/applications/regenie.html\">regenie</a></li>\n <li><a href=\"/applications/rgdal.html\">R/rgdal</a></li>\n <li><a href=\"/applications/rgeos.html\">R/rgeos</a></li>\n <li><a href=\"/applications/Rhdf5lib.html\">R/Rhdf5lib</a></li>\n <li><a href=\"/applications/rjags.html\">R/rjags</a></li>\n <li><a href=\"/applications/rJava.html\">R/rJava</a></li>\n <li><a href=\"/applications/R.html\">R</a></li>\n <li><a href=\"/applications/rstan.html\">R/rstan</a></li>\n <li><a href=\"/applications/RStudio.html\">RStudio</a></li>\n <li><a href=\"/applications/SAIGE.html\">R/SAIGE 0.36.6 and 0.39.2</a></li>\n <li><a href=\"/applications/sf.html\">R/sf</a></li>\n <li><a href=\"/applications/shapeit3.html\">shapeit3</a></li>\n <li><a href=\"/applications/SMR.html\">SMR</a></li>\n <li><a href=\"/applications/snakemake.html\">snakemake</a></li>\n <li><a href=\"/applications/snpnet.html\">R/snpnet</a></li>\n <li><a href=\"/applications/SNPTEST.html\">SNPTEST</a></li>\n <li><a href=\"/applications/sojo.html\">R/sojo</a></li>\n <li><a href=\"/applications/tabix.html\">tabix</a></li>\n <li><a href=\"/applications/VEP.html\">VEP</a></li>\n <li><a href=\"/applications/xlsx.html\">R/xlsx</a></li>\n</ul>\n","dir":"/applications/","name":"README.md","path":"applications/README.md","url":"/applications/"},{"sort":3,"layout":"default","title":"akt","content":"<h1 id=\"akt\">akt</h1>\n\n<p>Web: https://github.com/Illumina/akt</p>\n\n<p>This is Illumina’s ancestry and kinship toolkit and the installation is canonical.</p>\n","dir":"/applications/","name":"akt.md","path":"applications/akt.md","url":"/applications/akt.html"},{"sort":3,"layout":"default","title":"Directories","content":"# Directories\n\nThis [section](https://docs.hpc.cam.ac.uk/hpc/user-guide/io_management.html#summary-of-available-filesystems) gives a summary of the file system.\n\nGo to **CSD3 portal**: [https://selfservice.uis.cam.ac.uk/account/](https://selfservice.uis.cam.ac.uk/account/) and accept the terms and conditions. An `rds/` directory should then be created with symbolic links as follows,\n\n```\nhpc-work -> /rds/user/$USER/hpc-work/\ngenetics_resources -> /rds/project/jmmh2/rds-jmmh2-genetics_resources/\nlegacy_projects -> /rds/project/jmmh2/rds-jmmh2-legacy_projects/\npre_qc_data -> /rds/project/jmmh2/rds-jmmh2-pre_qc_data/\nprojects -> /rds/project/jmmh2/rds-jmmh2-projects/\npublic_databases -> /rds/project/jmmh2/rds-jmmh2-public_databases/\nresults -> /rds/project/jmmh2/rds-jmmh2-results\n```\n\nShort shorter (without rds-jmmh2- prefix) names as on Cardio can be created equivalently with\n\n```bash\nif [ ! -d /home/$USER/rds ]; then mkdir /home/$USER/rds; fi\nln -sf /rds/user/$USER/hpc-work /home/$USER/rds/hpc-work\nexport rt=/rds/project/jmmh2\nfor d in $(ls $rt | xargs -l basename | sed 's/rds-jmmh2-//g'); do ln -sf $rt/rds-jmmh2-$d /home/$USER/rds/$d; done\n```\n\nNote to list the directories you need postfix them with '/'.\n","dir":"/systems/","name":"directories.md","path":"systems/directories.md","url":"/systems/directories.html"},{"sort":3,"layout":"default","title":"Mathjax","content":"# Mathjax\n\n$$\n\\begin{aligned}\n & \\phi(x,y) = \\phi \\left(\\sum_{i=1}^n x_ie_i, \\sum_{j=1}^n y_je_j \\right)\n = \\sum_{i=1}^n \\sum_{j=1}^n x_i y_j \\phi(e_i, e_j) = \\\\\n & (x_1, \\ldots, x_n) \\left( \\begin{array}{ccc}\n \\phi(e_1, e_1) & \\cdots & \\phi(e_1, e_n) \\\\\n \\vdots & \\ddots & \\vdots \\\\\n \\phi(e_n, e_1) & \\cdots & \\phi(e_n, e_n)\n \\end{array} \\right)\n \\left( \\begin{array}{c}\n y_1 \\\\\n \\vdots \\\\\n y_n\n \\end{array} \\right)\n\\end{aligned}\n$$\n\n```note\nFor documentation, see: https://kramdown.gettalong.org/syntax.html#math-blocks\n```\n","dir":"/writing/","name":"mathjax.md","path":"writing/mathjax.md","url":"/writing/mathjax.html"},{"sort":3,"layout":"default","title":"Code Blocks","content":"<h1 id=\"code-blocks\">Code Blocks</h1>\n\n<p><code class=\"language-plaintext highlighter-rouge\">inline code</code></p>\n\n<p><a href=\"./\"><code class=\"language-plaintext highlighter-rouge\">inline code inside link</code></a></p>\n\n<div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>:root {\n  @for $level from 1 through 12 {\n    @if $level % 4 == 0 {\n      --toc-#{$level}: #{darken($theme-white, 4 * 8.8%)};\n    } @else {\n      --toc-#{$level}: #{darken($theme-white, $level % 4 * 8.8%)};\n    }\n  }\n}\n</code></pre> </div></div>\n\n<p><strong>Highlight:</strong></p>\n\n<div class=\"language-scss highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"nd\">:root</span> <span class=\"p\">{</span>\n  <span class=\"k\">@for</span> <span class=\"nv\">$level</span> <span class=\"ow\">from</span> <span class=\"m\">1</span> <span class=\"ow\">through</span> <span class=\"m\">12</span> <span class=\"p\">{</span>\n    <span class=\"k\">@if</span> <span class=\"nv\">$level</span> <span class=\"o\">%</span> <span class=\"m\">4</span> <span class=\"o\">==</span> <span class=\"m\">0</span> <span class=\"p\">{</span>\n      <span class=\"nt\">--toc-</span><span class=\"si\">#{</span><span class=\"nv\">$level</span><span class=\"si\">}</span><span class=\"nd\">:</span> <span class=\"si\">#{</span><span class=\"nf\">darken</span><span class=\"p\">(</span><span class=\"nv\">$theme-white</span><span class=\"o\">,</span> <span class=\"m\">4</span> <span class=\"o\">*</span> <span class=\"m\">8</span><span class=\"mi\">.8%</span><span class=\"p\">)</span><span class=\"si\">}</span><span class=\"p\">;</span>\n    <span class=\"p\">}</span> <span class=\"k\">@else</span> <span class=\"p\">{</span>\n      <span class=\"nt\">--toc-</span><span class=\"si\">#{</span><span class=\"nv\">$level</span><span class=\"si\">}</span><span class=\"nd\">:</span> <span class=\"si\">#{</span><span class=\"nf\">darken</span><span class=\"p\">(</span><span class=\"nv\">$theme-white</span><span class=\"o\">,</span> <span class=\"nv\">$level</span> <span class=\"o\">%</span> <span class=\"m\">4</span> <span class=\"o\">*</span> <span class=\"m\">8</span><span class=\"mi\">.8%</span><span class=\"p\">)</span><span class=\"si\">}</span><span class=\"p\">;</span>\n    <span class=\"p\">}</span>\n  <span class=\"p\">}</span>\n<span class=\"p\">}</span>\n</code></pre> </div></div>\n","dir":"/writing/test/","name":"codes.md","path":"writing/test/codes.md","url":"/writing/test/codes.html"},{"sort":4,"layout":"default","title":"ANNOVAR","content":"<h1 id=\"annovar\">ANNOVAR</h1>\n\n<p>Web page: http://annovar.openbioinformatics.org/en/latest/</p>\n\n<p>Registered from http://download.openbioinformatics.org/annovar_download_form.php with the following information,</p>\n\n<div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>User Name:\nUser Email:\nUser Institution: University of Cambridge\n</code></pre> </div></div>\n\n<p>then copy the link received from email and issue commands from csd3,</p>\n\n<div class=\"language-bash highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"nb\">cd</span> <span class=\"k\">${</span><span class=\"nv\">HPC_WORK</span><span class=\"k\">}</span>\nwget http://www.openbioinformatics.org/annovar/download/.../annovar.latest.tar.gz\n<span class=\"nb\">tar </span>xvfz annovar.latest.tar.gz\n<span class=\"nb\">ls</span> <span class=\"k\">*</span>pl | <span class=\"nb\">sed</span> <span class=\"s1\">'s/*//g'</span> | parallel <span class=\"nt\">-C</span><span class=\"s1\">' '</span> <span class=\"s1\">'ln -sf ${HPC_WORK}/annovar/{} ${HPC_WORK}/bin/{}'</span>\n</code></pre> </div></div>\n\n<p>Additionally, one can download the ENSEMBL genes and whole-genome FASTA files to\nhumandb/hg19_seq for CCDS/GENCODE annotation.</p>\n\n<div class=\"language-bash highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"nb\">cd </span>annovar\n<span class=\"c\"># ENSEMBL genes</span>\nannotate_variation.pl <span class=\"nt\">-buildver</span> hg19 <span class=\"nt\">-downdb</span> <span class=\"nt\">-webfrom</span> annovar ensGene\nannotate_variation.pl <span class=\"nt\">-build</span> hg19 <span class=\"nt\">-out</span> ex1 <span class=\"nt\">-dbtype</span> ensGene example/ex1.avinput humandb/\n<span class=\"c\"># reference genome in FASTA</span>\nannotate_variation.pl <span class=\"nt\">-downdb</span> <span class=\"nt\">-build</span> hg19 <span class=\"nb\">seq </span>humandb/hg19_seq/\n<span class=\"c\"># CCDS genes</span>\nannotate_variation.pl <span class=\"nt\">-downdb</span> <span class=\"nt\">-build</span> hg19 ccdsGene humandb\nretrieve_seq_from_fasta.pl humandb/hg19_ccdsGene.txt <span class=\"nt\">-seqdir</span> humandb/hg19_seq <span class=\"nt\">-format</span> refGene <span class=\"se\">\\</span>\n                           <span class=\"nt\">-outfile</span> humandb/hg19_ccdsGeneMrna.fa\nannotate_variation.pl <span class=\"nt\">-build</span> hg19 <span class=\"nt\">-out</span> ex1 <span class=\"nt\">-dbtype</span> ccdsGene example/ex1.avinput humandb/\n<span class=\"c\"># GENCODE genes</span>\nannotate_variation.pl <span class=\"nt\">-downdb</span> wgEncodeGencodeBasicV19 humandb/ <span class=\"nt\">-build</span> hg19\nretrieve_seq_from_fasta.pl <span class=\"nt\">-format</span> genericGene <span class=\"nt\">-seqdir</span> humandb/hg19_seq/ <span class=\"se\">\\</span>\n                           <span class=\"nt\">-outfile</span> humandb/hg19_wgEncodeGencodeBasicV19Mrna.fa humandb/hg19_wgEncodeGencodeBasicV19.txt\nannotate_variation.pl <span class=\"nt\">-build</span> hg19 <span class=\"nt\">-out</span> ex1 <span class=\"nt\">-dbtype</span> wgEncodeGencodeBasicV19 example/ex1.avinput humandb/\n</code></pre> </div></div>\n\n<p>We can have region-based annotation as in http://annovar.openbioinformatics.org/en/latest/user-guide/region/,</p>\n\n<div class=\"language-bash highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"c\"># Conserved genomic elements</span>\nannotate_variation.pl <span class=\"nt\">-build</span> hg19 <span class=\"nt\">-downdb</span> phastConsElements46way humandb/\nannotate_variation.pl <span class=\"nt\">-regionanno</span> <span class=\"nt\">-build</span> hg19 <span class=\"nt\">-out</span> ex1 <span class=\"nt\">-dbtype</span> phastConsElements46way example/ex1.avinput humandb/\nannotate_variation.pl <span class=\"nt\">-regionanno</span> <span class=\"nt\">-build</span> hg19 <span class=\"nt\">-out</span> ex1 <span class=\"nt\">-dbtype</span> phastConsElements46way example/ex1.avinput humandb/ <span class=\"nt\">-normscore_threshold</span> 400\n<span class=\"c\"># Transcription factor binding sites</span>\nannotate_variation.pl <span class=\"nt\">-build</span> hg19 <span class=\"nt\">-downdb</span> tfbsConsSites humandb/\nannotate_variation.pl <span class=\"nt\">-regionanno</span> <span class=\"nt\">-build</span> hg19 <span class=\"nt\">-out</span> ex1 <span class=\"nt\">-dbtype</span> tfbsConsSites example/ex1.avinput humandb/\n<span class=\"c\"># Cytogenetic band</span>\nannotate_variation.pl <span class=\"nt\">-build</span> hg19 <span class=\"nt\">-downdb</span> cytoBand humandb/\nannotate_variation.pl <span class=\"nt\">-regionanno</span> <span class=\"nt\">-build</span> hg19 <span class=\"nt\">-out</span> ex1 <span class=\"nt\">-dbtype</span> cytoBand example/ex1.avinput humandb/\n<span class=\"c\"># microRNA, snoRNA</span>\nannotate_variation.pl <span class=\"nt\">-build</span> hg19 <span class=\"nt\">-downdb</span> wgRna humandb/\nannotate_variation.pl <span class=\"nt\">-regionanno</span> <span class=\"nt\">-build</span> hg19 <span class=\"nt\">-out</span> ex1 <span class=\"nt\">-dbtype</span> wgRna example/ex1.avinput humandb/\n<span class=\"c\"># previously reported structural variants</span>\nannotate_variation.pl <span class=\"nt\">-build</span> hg19 <span class=\"nt\">-downdb</span> dgvMerged humandb/\nannotate_variation.pl <span class=\"nt\">-regionanno</span> <span class=\"nt\">-build</span> hg19 <span class=\"nt\">-out</span> ex1 <span class=\"nt\">-dbtype</span> dgvMerged example/ex1.avinput humandb/\n<span class=\"c\"># published GWAS</span>\nannotate_variation.pl <span class=\"nt\">-build</span> hg19 <span class=\"nt\">-downdb</span> gwasCatalog humandb/\nannotate_variation.pl <span class=\"nt\">-regionanno</span> <span class=\"nt\">-build</span> hg19 <span class=\"nt\">-out</span> ex1 <span class=\"nt\">-dbtype</span> gwasCatalog example/ex1.avinput humandb/\n</code></pre> </div></div>\n\n<p>Here is a more sophisticated example contrasting <code class=\"language-plaintext highlighter-rouge\">table_annovar.pl</code> with <code class=\"language-plaintext highlighter-rouge\">annotate_variation.pl</code>,</p>\n\n<div class=\"language-bash highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"k\">if</span> <span class=\"o\">[</span> <span class=\"o\">!</span> <span class=\"nt\">-d</span> <span class=\"nb\">test</span> <span class=\"o\">]</span><span class=\"p\">;</span> <span class=\"k\">then </span><span class=\"nb\">mkdir test</span><span class=\"p\">;</span> <span class=\"k\">fi\n</span>annotate_variation.pl <span class=\"nt\">-buildver</span> hg19 <span class=\"nt\">-downdb</span> <span class=\"nt\">-webfrom</span> annovar refGene <span class=\"nb\">test</span>/\nannotate_variation.pl <span class=\"nt\">-buildver</span> hg19 <span class=\"nt\">-downdb</span> <span class=\"nt\">-webfrom</span> annovar exac03 <span class=\"nb\">test</span>/\nannotate_variation.pl <span class=\"nt\">-buildver</span> hg19 <span class=\"nt\">-downdb</span> <span class=\"nt\">-webfrom</span> annovar avsnp147 <span class=\"nb\">test</span>/\nannotate_variation.pl <span class=\"nt\">-buildver</span> hg19 <span class=\"nt\">-downdb</span> <span class=\"nt\">-webfrom</span> annovar dbnsfp30a <span class=\"nb\">test</span>/\n\nannotate_variation.pl <span class=\"nt\">-geneanno</span> <span class=\"nt\">-dbtype</span> refGene <span class=\"nt\">-buildver</span> hg19 example/ex1.avinput <span class=\"nb\">test</span>/\nannotate_variation.pl <span class=\"nt\">-filter</span> <span class=\"nt\">-dbtype</span> exac03 <span class=\"nt\">-buildver</span> hg19 example/ex1.avinput <span class=\"nb\">test</span>/\n\ntable_annovar.pl example/ex1.avinput <span class=\"nb\">test</span>/ <span class=\"nt\">-buildver</span> hg19 <span class=\"nt\">-out</span> myanno <span class=\"se\">\\</span>\n     <span class=\"nt\">-remove</span> <span class=\"nt\">-protocol</span> refGene,cytoBand,exac03,avsnp147,dbnsfp30a,gwasCatalog <span class=\"nt\">-operation</span> g,r,f,f,f,r <span class=\"se\">\\</span>\n     <span class=\"nt\">-nastring</span> <span class=\"nb\">.</span> <span class=\"nt\">-csvout</span> <span class=\"nt\">-polish</span> <span class=\"nt\">-xref</span> example/gene_xref.txt\ntable_annovar.pl example/ex1.avinput <span class=\"nb\">test</span>/ <span class=\"nt\">-buildver</span> hg19 <span class=\"nt\">--outfile</span> ex1 <span class=\"se\">\\</span>\n     <span class=\"nt\">-protocol</span> ensGene,refGene,ccdsGene,wgEncodeGencodeBasicV19,cytoBand,exac03,avsnp147,dbnsfp30a,gwasCatalog <span class=\"se\">\\</span>\n     <span class=\"nt\">-operation</span> g,g,g,g,r,f,f,f,r <span class=\"se\">\\</span>\n     <span class=\"nt\">-csvout</span> <span class=\"nt\">-polish</span> <span class=\"nt\">-remove</span> <span class=\"nt\">-nastring</span> <span class=\"nb\">.</span>\n</code></pre> </div></div>\n\n<p>The second <code class=\"language-plaintext highlighter-rouge\">table_annovar.pl</code> above works after symbolic links to relevant databases at humandb/ were created at test/.</p>\n\n<p>It is handy to create a VCF file to be used by VEP (see below),</p>\n\n<div class=\"language-bash highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>convert2annovar.pl <span class=\"nt\">-format</span> annovar2vcf example/ex1.avinput <span class=\"o\">&gt;</span> ex1.vcf\nvep <span class=\"nt\">-i</span> ex1.vcf <span class=\"nt\">-o</span> ex1.vcfoutput <span class=\"nt\">--offline</span> <span class=\"nt\">--force_overwrite</span>\n</code></pre> </div></div>\n","dir":"/applications/","name":"ANNOVAR.md","path":"applications/ANNOVAR.md","url":"/applications/ANNOVAR.html"},{"sort":4,"layout":"default","title":"Policies","content":"# Policies\n\nSee [https://docs.hpc.cam.ac.uk/hpc/user-guide/policies.html#acknowledging-csd3](https://docs.hpc.cam.ac.uk/hpc/user-guide/policies.html#acknowledging-csd3).\n","dir":"/systems/","name":"policies.md","path":"systems/policies.md","url":"/systems/policies.html"},{"sort":4,"layout":"default","title":"Admonition card","content":"<h1 id=\"admonition-card\">Admonition card</h1>\n\n<h2 id=\"note\">note</h2>\n\n<div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>```note\n### This is a note\n\nMarkdown is supported, Text can be **bold**, _italic_, or ~~strikethrough~~. [Links](https://github.com) should be blue with no underlines\n\n`inline code`\n\n[`inline code inside link`](#)\n```\n</code></pre> </div></div>\n\n<pre><code class=\"language-note\">### This is a note\n\nMarkdown is supported, Text can be **bold**, _italic_, or ~~strikethrough~~. [Links](https://github.com) should be blue with no underlines\n\n`inline code`\n\n[`inline code inside link`](#)\n</code></pre> \n\n<h2 id=\"tip\">tip</h2>\n\n<div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>```tip\nIt’s bigger than a bread box.\n```\n</code></pre> </div></div>\n\n<pre><code class=\"language-tip\">It’s bigger than a bread box.\n</code></pre> \n\n<h2 id=\"warning\">warning</h2>\n\n<div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>```warning\nStrong prose may provoke extreme mental exertion. Reader discretion is strongly advised.\n```\n</code></pre> </div></div>\n\n<pre><code class=\"language-warning\">Strong prose may provoke extreme mental exertion. Reader discretion is strongly advised.\n</code></pre> \n\n<h2 id=\"danger\">danger</h2>\n\n<div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>```danger\nMad scientist at work!\n```\n</code></pre> </div></div>\n\n<pre><code class=\"language-danger\">Mad scientist at work!\n</code></pre> \n","dir":"/writing/","name":"admonitions.md","path":"writing/admonitions.md","url":"/writing/admonitions.html"},{"sort":4,"layout":"default","title":"Mermaid Test","content":"# Mermaid Test\n\n ```mermaid\n graph TB\n c1-->a2\n subgraph one\n a1-->a2\n end\n subgraph two\n b1-->b2\n end\n subgraph three\n c1-->c2\n end\n ```\n\n```mermaid\ngraph TB\n c1-->a2\n subgraph one\n a1-->a2\n end\n subgraph two\n b1-->b2\n end\n subgraph three\n c1-->c2\n end\n```\n\n```mermaid\ngraph TD;\n A-->B;\n A-->C;\n B-->D;\n C-->D;\n```\n\n```mermaid\nclassDiagram\nclassA <|-- classB\nclassC *-- classD\nclassE o-- classF\nclassG <-- classH\nclassI -- classJ\nclassK <.. classL\nclassM <|.. classN\nclassO .. classP\n```\n\n```mermaid\nerDiagram\n CUSTOMER ||--o{ ORDER : places\n ORDER ||--|{ LINE-ITEM : contains\n CUSTOMER }|..|{ DELIVERY-ADDRESS : uses\n```\n","dir":"/writing/test/","name":"mermaid.md","path":"writing/test/mermaid.md","url":"/writing/test/mermaid.html"},{"sort":5,"layout":"default","title":"bcftools","content":"<h1 id=\"bcftools\">bcftools</h1>\n\n<p>Web: <a href=\"http://www.htslib.org/download/\">http://www.htslib.org/download/</a></p>\n\n<p>On CSD3, <code class=\"language-plaintext highlighter-rouge\">module list bcftools</code> gives a list of versions but none can query data from the web.</p>\n\n<p>However, the installation is straightforward.</p>\n\n<div class=\"language-bash highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>wget <span class=\"nt\">-qO-</span> https://github.com/samtools/bcftools/releases/download/1.12/bcftools-1.12.tar.bz2 | <span class=\"se\">\\</span>\n<span class=\"nb\">tar </span>xjf -\n<span class=\"nb\">cd </span>bcftools-1.12/\n./configure <span class=\"nt\">--prefix</span><span class=\"o\">=</span><span class=\"k\">${</span><span class=\"nv\">HPC_WORK</span><span class=\"k\">}</span>\nmake\nmake <span class=\"nb\">install\n</span>bcftools <span class=\"nt\">--version</span>\n</code></pre> </div></div>\n\n<p>The data query example as in <code class=\"language-plaintext highlighter-rouge\">tabix</code> is quoted here.</p>\n\n<div class=\"language-bash highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>bcftools query <span class=\"nt\">-f</span> <span class=\"s1\">'%ID\\t%ALT\\t%REF\\t%AF\\t[%ES]\\t[%SE]\\t[%LP]\\t[%SS]\\t%CHROM\\t%POS\\n'</span> <span class=\"nt\">-r</span> 1:1-1000000 <span class=\"se\">\\</span>\n               https://gwas.mrcieu.ac.uk/files/ebi-a-GCST010776/ebi-a-GCST010776.vcf.gz\n</code></pre> </div></div>\n\n<p>A number of other options can be used together with -r or -R.</p>\n\n<p>We can also obtain data with the header (-H)</p>\n\n<div class=\"language-bash highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"nb\">export </span><span class=\"nv\">f</span><span class=\"o\">=</span>ebi-a-GCST010776\nbcftools query <span class=\"nt\">-f</span> <span class=\"s1\">'%ID\\t%ALT\\t%REF\\t%AF\\t[%ES]\\t[%SE]\\t[%LP]\\t[%SS]\\t%CHROM\\t%POS\\n'</span> <span class=\"se\">\\</span>\n               <span class=\"nt\">-H</span> <span class=\"se\">\\</span>\n               <span class=\"nt\">-r</span> 1:1-1000000 <span class=\"se\">\\</span>\n               https://gwas.mrcieu.ac.uk/files/<span class=\"k\">${</span><span class=\"nv\">f</span><span class=\"k\">}</span>/<span class=\"k\">${</span><span class=\"nv\">f</span><span class=\"k\">}</span>.vcf.gz | <span class=\"se\">\\</span>\n               <span class=\"nb\">sed</span> <span class=\"s2\">\"s/</span><span class=\"se\">\\[</span><span class=\"s2\">[0-9]*</span><span class=\"se\">\\]</span><span class=\"s2\">//g;s/^[</span><span class=\"se\">\\#</span><span class=\"s2\">] //;s/</span><span class=\"k\">${</span><span class=\"nv\">f</span><span class=\"k\">}</span><span class=\"s2\">://g\"</span> <span class=\"o\">&gt;</span> chr1:1-1000000.dat\n</code></pre> </div></div>\n","dir":"/applications/","name":"bcftools.md","path":"applications/bcftools.md","url":"/applications/bcftools.html"},{"sort":5,"layout":"default","title":"email","content":"# email\n\nThis can be done with `mutt` from the console.\n","dir":"/systems/","name":"email.md","path":"systems/email.md","url":"/systems/email.html"},{"sort":5,"permalink":"/writing/","layout":"default","title":"Writing Related","content":"<h1 id=\"writing-related\">Writing Related</h1>\n\n<ul>\n <li><a href=\"/writing/front-matter.html\">Front matter</a></li>\n <li><a href=\"/writing/list.html\">List directory</a></li>\n <li><a href=\"/writing/mathjax.html\">Mathjax</a></li>\n <li><a href=\"/writing/admonitions.html\">Admonition card</a></li>\n</ul>\n","dir":"/writing/","name":"README.md","path":"writing/README.md","url":"/writing/"},{"sort":5,"layout":"default","title":"Emoji Test","content":"# Emoji Test\n\n```\nI give this theme two :+1:!\n```\n\nI give this theme two :+1:!\n\n```tip\nSet config `plugins: [jemoji]`, Emoji searcher, see: [https://emoji.muan.co/](https://emoji.muan.co/)\n```\n","dir":"/writing/test/","name":"emoji.md","path":"writing/test/emoji.md","url":"/writing/test/emoji.html"},{"sort":6,"layout":"default","title":"bedops","content":"<h1 id=\"bedops\">bedops</h1>\n\n<p>Web, https://bedops.readthedocs.io/en/latest/</p>\n\n<div class=\"language-bash highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>wget <span class=\"nt\">-qO-</span> https://github.com/bedops/bedops/releases/download/v2.4.39/bedops_linux_x86_64-v2.4.39.tar.bz2 | <span class=\"se\">\\</span>\n<span class=\"nb\">tar </span>xfj -\n</code></pre> </div></div>\n\n<p>would extract the executables into the bin/ directory.</p>\n","dir":"/applications/","name":"bedops.md","path":"applications/bedops.md","url":"/applications/bedops.html"},{"sort":6,"layout":"default","title":"Software","content":"# Software\n\nThe CEU software repository is here, /usr/local/Cluster-Apps/ceuadmin/. As of December 2019, the list is\n\n```\nbgenix/ LDstore/ plink_linux_x86_64_beta3.32/ raremetal_4.14.0/ snptest_new/\nbiobank/ magma/ plinkseq-0.08-x86_64/ raremetal_4.14.1/ source/\nboltlmm/ MAGMA_Celltyping/ plinkseq-0.10/ raremetal_BPGen/ stata/\nboltlmm_2.2/ metabolomics/ qctool_v1.4-linux-x86_64/ Raremetal_linux_executables/ tabix/\nexomeplus/ metal/ R/ Raremetal_linux_executables.tgz temp/\ngcta/ metal_updated/ raremetal_4.13/ raremetal.log vcftools/\ngtool_v0.7.5_x86_64/ plink/ raremetal_4.13.3/ samtools_1.2/ vcftools_ps629/\nhpg/ plink_1.90_beta/ raremetal_4.13.4/ shapeit.v2.r790.RHELS_5.4.dynamic/\nimpute_v2.3.2_x86_64_static/ plink_bgi_Dev/ raremetal_4.13.5/ snptest/\ninterval/ plink-bgi_linux_x86_64_may/ raremetal_4.13.7/ snptest_2.5.2/\nJAGS/ plink_linux_x86_64_beta2a/ raremetal_4.13.8/ snptest_2.5.4_beta3/\n```\n\nThese can be loaded with `module load ceuadmin/<module name>`.\n\n#### git\n\nTo have the latest git, e.g.,\n\n```bash\nwget -qO- https://github.com/git/git/archive/v2.30.0.tar.gz | tar xfz -\ncd git-2.30.0\nmake NO_GETTEXT=YesPlease install\n```\n\nand the executables will be put to ~/bin.\n\n#### matlab\n\nOfficial website: [https://www.mathworks.com/products/matlab.html](https://www.mathworks.com/products/matlab.html).\n\n```\nmodule avail matlab\nmodule load matlab/r2019b\n```\n\nfollowed by `matlab`.\n\n#### Python\n\nOfficial website: [https://www.python.org/](https://www.python.org/).\n\nThis can be invoked from a CSD3 console via `python` and `python3`. Libraries can be installed via `pip` and `pip3` (or equivalently `python -m pip install` and `python3 -m pip install`), e.g., the script\n\n```bash\npip install mygene --user\npip install tensorflow --user\npip install keras --user\npip install jupyter --user\n```\n\ninstalls libraries at `$HOME/.local`.\n\nIt is advised to use virual environments, i.e.,\n\n```bash\n# inherit system-wide packages as well\nmodule load python/3.5\nvirtualenv --system-site-packages py35\nsource py35/bin/activate\n# pip new packages\ndeactivate\n```\n\nNote that when this is set up, one only needs to restart from the `source` command. The `pip` is appropriate for installing small number of package; otherwise Anaconda ([https://www.anaconda.com/](https://www.anaconda.com/)) and Jupyter notebook ([https://jupyter.org/](https://jupyter.org/)) are useful.\n\nWe first load Anaconda and create virtual environments,\n\n```bash\nmodule avail miniconda\nmodule load miniconda2-4.3.14-gcc-5.4.0-xjtq53h\nconda create -n py27 python=2.7 ipykernel\n```\n\nfor Python 2.7 at `/home/$USER/.conda/envs/py27`, where envs could be replaced with the `--prefix` option. These are only required once.\n\nWe can then load Anaconda and activate Python 3.5,\n\n```bash\nmodule load miniconda/3\nconda create -n py35 python=3.5 ipykernel\nsource activate py35\n```\n\nand follow [Autoencoder in Keras tutorial](https://www.datacamp.com/community/tutorials/autoencoder-keras-tutorial) on\ndata from [http://yann.lecun.com/exdb/mnist/](http://yann.lecun.com/exdb/mnist/)\n\nThe Jupyter notebook can be started as follows,\n\n```bash\nhostname\n$HOME/.local/bin/jupyter notebook --ip=127.0.0.1 --no-browser --port 8081\n```\n\nIf it fails to assign the port number, let the system choose (by dropping the `--port` option). The process which use the port can be shown with `lsof -i:8081` or stopped by `lsof -ti:8081 | xargs kill -9`. The command `hostname` gives the name of the node. Once the port number is assigned, it is\nused by another ssh session _elsewhere_ and the URL generated openable from a browser, e.g.,\n\n```bash\nssh -4 -L 8081:127.0.0.1:8081 -fN <hostname>.hpc.cam.ac.uk\nfirefox <URL> &\n```\n\npaying attention to the port number as it may change.\n\nAn `hello world` example is [hello.ipynb](/systems/files/hello.ipynb) from which [hello.html](/systems/files/hello.html) and [hello.pdf](/systems/files/hello.pdf) were generated with `jupyter nbconvert --to html|pdf hello.ipynb`.\n\nSee also https://docs.hpc.cam.ac.uk/hpc/software-tools/python.html#using-anaconda-python and https://docs.hpc.cam.ac.uk/hpc/software-packages/jupyter.html.\n\nSee [HPC docuementation](https://docs.hpc.cam.ac.uk/hpc/) for additional information on PyTorch, Tensorflow and GPU.\n\n#### R\n\nOfficial website: [https://www.r-project.org/](https://www.r-project.org/) and also [https://bioconductor.org/](https://bioconductor.org/).\n\nUnder HPC, the default version is 3.3.3 with /usr/bin/R; alternatively choose the desired version of R from\n\n```bash\nmodule avail R\nmodule avail r\n# if you would also like to use RStudio\nmodule avail rstudio\n```\n\ne.g., `module load r-3.6.0-gcc-5.4.0-bzuuksv rstudio/1.1.383`.\n\nFor information about Bioconductor installation, see [https://bioconductor.org/install/](https://bioconductor.org/install/).\n\nThe following code installs package for weighted correlation network analysis ([WGCNA](https://horvath.genetics.ucla.edu/html/CoexpressionNetwork/Rpackages/WGCNA/)).\n\n```r\n# from CRAN\ndependencies <- c(\"matrixStats\", \"Hmisc\", \"splines\", \"foreach\", \"doParallel\",\n \"fastcluster\", \"dynamicTreeCut\", \"survival\")\ninstall.packages(dependencies)\n# from Bioconductor\nsource(\"http://bioconductor.org/biocLite.R\")\nbiocLite(c(\"GO.db\", \"preprocessCore\", \"impute\"))\n# R >= 3.5.0\ninstall.packages(\"BiocManager\")\nBiocManager::install(\"WGCNA\")\n```\n\nA good alternative is to use `remotes` or `devtools` package, e.g.,\n\n```r\nremotes::install_bioc(\"snpStats\")\n```\n\nIn case of difficulty it is still useful to install directly, e.g.,\n\n```bash\nwget http://master.bioconductor.org/packages//2.10/bioc/src/contrib/ontoCAT_1.8.0.tar.gz\nR CMD INSTALL ontoCAT_1.8.0.tar.gz\n# Alternatively,\nR -e \"install.packages('ontoCAT_1.8.0.tar.gz',repos=NULL)\"\n```\n\nThe package installation directory can be spefied explicitly with R_LIBS, i.e.,\n\n```bash\nexport R_LIBS=/rds/user/$USER/hpc-work/R:/rds/user/$USER/hpc-work/R-3.6.1/library\n```\n\n#### SLURM\n\nOfficial website: [https://slurm.schedmd.com/](https://slurm.schedmd.com/).\n\n##### Account details\n\n```bash\nmybalance\n```\n\n##### Partition\n\n```bash\nscontrol show partition\n```\n\n##### An interacive job\n\n```bash\nsintr -A MYPROJECT -p skylake -N2 -n2 -t 1:0:0 --qos=INTR\n```\n\nand also\n\n```bash\nsrun -N1 -n1 -c4 -p skylake-himem -t 12:0:0 --pty bash -i\n```\n\nor `sintr` then check with `squeue -u $USER`, `qstat -u $USER` and `sacct`. The directory `/usr/local/software/slurm/current/bin/` contains all the executables while sample scripts are in `/usr/local/Cluster-Docs/SLURM`, e.g., [template for Skylake](/systems/files/slurm_submit.peta4-skylake).\n\n##### An example\n\nTo convert a large number of PDF files (INTERVAL.\\*.manhattn.pdf) to PNG with smaller file sizes. To start, we build a file list,and pipe into ``parallel`.\n\n```bash\nls *pdf | \\\nsed 's/INTERVAL.//g;s/.manhattan.pdf//g' | \\\nparallel -j8 -C' ' '\n echo {}\n pdftopng -r 300 INTERVAL.{}.manhattan.pdf\n mv {}-000001.png INTERVAL.{}.png\n'\n```\n\nwhich is equivalent to SLURM implementation using array jobs (https://slurm.schedmd.com/job_array.html).\n\n```bash\n#!/usr/bin/bash\n\n#SBATCH --ntasks=1\n#SBATCH --job-name=pdftopng\n#SBATCH --time=6:00:00\n#SBATCH --cpus-per-task=8\n#SBATCH --partition=skylake\n#SBATCH --array=1-50%10\n#SBATCH --output=pdftopng_%A_%a.out\n#SBATCH --error=pdftopng_%A_%a.err\n#SBATCH --export ALL\n\nexport p=$(awk 'NR==ENVIRON[\"SLURM_ARRAY_TASK_ID\"]' INTERVAL.list)\nexport TMPDIR=/rds/user/$USER/hpc-work/\n\necho ${p}\npdftopng -r 300 INTERVAL.${p}.manhattan.pdf ${p}\nmv ${p}-000001.png INTERVAL.${p}.png\n```\n\ninvoked by `sbatch`. As with Cardio, it is helpful to set a temporary directory, i.e.,\n\n```bash\nexport TMPDIR=/rds/user/$USER/hpc-work/\n```\n\n##### Neither `parallel` nor SLURM\n\n```bash\nexport url=https://zenodo.org/record/2615265/files/\nif [ ! -d ~/rds/results/public/proteomics/scallop-cvd1 ]; then mkdir ~/rds/results/public/proteomics/scallop-cvd1; fi\ncat cvd1.txt | xargs -I {} bash -c \"wget ${url}/{}.txt.gz -O ~/rds/results/public/proteomics/scallop-cvd1/{}.txt.gz\"\n# ln -s ~/rds/results/public/proteomics/scallop-cvd1\n```\n\nwhich downloads the SCALLOP-cvd1 sumstats for proteins listed in `cvd1.txt`.\n\n##### Trouble shooting\n\nWith error message\n\n```\nsqueue: error: _parse_next_key: Parsing error at unrecognized key:\nInteractiveStepOptions\nsqueue: error: Parse error in file\n/usr/local/software/slurm/slurm-20.11.4/etc/slurm.conf line 22:\n\"InteractiveStepOptions=\"--pty --preserve-env --mpi=none $SHELL\"\"\nsqueue: fatal: Unable to process configuration file\n```\n\nthen either log out and login again, or\n\n```bash\nunset SLURM_CONF\n```\n\n#### Stata\n\nOfficial website: [https://www.stata.com/](https://www.stata.com/).\n\nAs a CEU member the following is possible,\n\n```\nmodule load ceuadmin/stata/14\n```\n\nas with `ceuadmin/stata/15`. The meta-analysis (metan) and Mendelian Randomisation (mrrobust) packages can be installed as follows,\n\n```stata\nssc install metan\nnet install mrrobust, from(\"https://raw.github.com/remlapmot/mrrobust/master/\") replace\n```\n","dir":"/systems/","name":"software.md","path":"systems/software.md","url":"/systems/software.html"},{"sort":6,"layout":"default","title":"Gist Test","content":"# Gist Test\n\n```\n{% raw %}{% gist c08ee0f2726fd0e3909d %}{% endraw %}\n```\n\n{% gist c08ee0f2726fd0e3909d %}\n","dir":"/writing/test/","name":"gist.md","path":"writing/test/gist.md","url":"/writing/test/gist.html"},{"sort":7,"layout":"default","title":"bgenix","content":"<h1 id=\"bgenix\">bgenix</h1>\n\n<p>Web: <a href=\"https://enkre.net/cgi-bin/code/bgen/dir?ci=trunk\">https://enkre.net/cgi-bin/code/bgen/dir?ci=trunk</a></p>\n\n<p>It is now possible to compile 1.1.7 under Python 3.x.</p>\n\n<div class=\"language-bash highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"c\">#!/usr/bin/bash</span>\n<span class=\"c\"># get it</span>\nwget <span class=\"nt\">-qO-</span> http://code.enkre.net/bgen/tarball/release/bgen.tgz | <span class=\"nb\">tar </span>xvfz -\n<span class=\"nb\">mv </span>bgen.tgz bgenix\n<span class=\"nb\">cd </span>bgenix\n<span class=\"c\"># compile it</span>\n./waf configure\n./waf\n<span class=\"c\"># test it</span>\n./build/test/unit/test_bgen\n./build/apps/bgenix <span class=\"nt\">-g</span> example/example.16bits.bgen <span class=\"nt\">-list</span>\n</code></pre> </div></div>\n\n<p>and we could set up appropriate symbolic links.</p>\n","dir":"/applications/","name":"bgenix.md","path":"applications/bgenix.md","url":"/applications/bgenix.html"},{"sort":7,"layout":"default","title":"Training","content":"# Training\n\n- **First training**: Wednesday, 10th July 2019 from 10am – 12pm.\n- **Second training**: Wednesday, 31st July 2019 from 9:30am – 4pm.\n- **UCS**: [https://training.cam.ac.uk/ucs/](https://training.cam.ac.uk/ucs/).\n- **Handouts**: [June](https://www.hpc.cam.ac.uk/files/introduction_to_hpc-jun2019-handout_0.pdf) and [November](https://www.hpc.cam.ac.uk/files/introduction_to_hpc-nov2019.pdf), 2019.\n- **Presentation**: [Google document](https://tinyurl.com/y3l6jssg) by Praveen Surendran (<ps629@medschl.cam.ac.uk>).\n","dir":"/systems/","name":"training.md","path":"systems/training.md","url":"/systems/training.html"},{"sort":7,"layout":"default","title":"Avatar Test","content":"<h1 id=\"avatar-test\">Avatar Test</h1>\n\n<div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>{% avatar saowang %}\n</code></pre> </div></div>\n\n<p><img class=\"avatar avatar-small\" alt=\"saowang\" width=\"40\" height=\"40\" data-proofer-ignore=\"true\" src=\"https://avatars1.githubusercontent.com/saowang?v=3&amp;s=40\" srcset=\"https://avatars1.githubusercontent.com/saowang?v=3&amp;s=40 1x, https://avatars1.githubusercontent.com/saowang?v=3&amp;s=80 2x, https://avatars1.githubusercontent.com/saowang?v=3&amp;s=120 3x, https://avatars1.githubusercontent.com/saowang?v=3&amp;s=160 4x\" /></p>\n\n<pre><code class=\"language-tip\">Set config `plugins: [jekyll-avatar]`\n\nFor documentation, see: [https://github.com/benbalter/jekyll-avatar](https://github.com/benbalter/jekyll-avatar)\n</code></pre> \n","dir":"/writing/test/","name":"avatar.md","path":"writing/test/avatar.md","url":"/writing/test/avatar.html"},{"sort":8,"layout":"default","title":"R/brms","content":"<h1 id=\"rbrms\">R/brms</h1>\n\n<p>It is available from CRAN, so it can be installed with <code class=\"language-plaintext highlighter-rouge\">install.packages()</code>. Here is a documentation example,</p>\n\n<div class=\"language-r highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"w\">  </span><span class=\"n\">library</span><span class=\"p\">(</span><span class=\"n\">brms</span><span class=\"p\">)</span><span class=\"w\">\n</span><span class=\"c1\"># Survival regression modeling the time between the first</span><span class=\"w\">\n</span><span class=\"c1\"># and second recurrence of an infection in kidney patients.</span><span class=\"w\">\n  </span><span class=\"n\">fit3</span><span class=\"w\"> </span><span class=\"o\">&lt;-</span><span class=\"w\"> </span><span class=\"n\">brm</span><span class=\"p\">(</span><span class=\"n\">time</span><span class=\"w\"> </span><span class=\"o\">|</span><span class=\"w\"> </span><span class=\"n\">cens</span><span class=\"p\">(</span><span class=\"n\">censored</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"o\">~</span><span class=\"w\"> </span><span class=\"n\">age</span><span class=\"w\"> </span><span class=\"o\">*</span><span class=\"w\"> </span><span class=\"n\">sex</span><span class=\"w\"> </span><span class=\"o\">+</span><span class=\"w\"> </span><span class=\"n\">disease</span><span class=\"w\"> </span><span class=\"o\">+</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"m\">1</span><span class=\"o\">|</span><span class=\"n\">patient</span><span class=\"p\">),</span><span class=\"w\">\n              </span><span class=\"n\">data</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">kidney</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">family</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">lognormal</span><span class=\"p\">())</span><span class=\"w\">\n  </span><span class=\"n\">summary</span><span class=\"p\">(</span><span class=\"n\">fit3</span><span class=\"p\">)</span><span class=\"w\">\n  </span><span class=\"n\">plot</span><span class=\"p\">(</span><span class=\"n\">fit3</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">ask</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"kc\">FALSE</span><span class=\"p\">)</span><span class=\"w\">\n  </span><span class=\"n\">plot</span><span class=\"p\">(</span><span class=\"n\">conditional_effects</span><span class=\"p\">(</span><span class=\"n\">fit3</span><span class=\"p\">),</span><span class=\"w\"> </span><span class=\"n\">ask</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"kc\">FALSE</span><span class=\"p\">)</span><span class=\"w\">\n  </span><span class=\"n\">fit3cox</span><span class=\"w\"> </span><span class=\"o\">&lt;-</span><span class=\"w\"> </span><span class=\"n\">brm</span><span class=\"p\">(</span><span class=\"n\">time</span><span class=\"w\"> </span><span class=\"o\">|</span><span class=\"w\"> </span><span class=\"n\">cens</span><span class=\"p\">(</span><span class=\"n\">censored</span><span class=\"p\">)</span><span class=\"w\"> </span><span class=\"o\">~</span><span class=\"w\"> </span><span class=\"n\">age</span><span class=\"w\"> </span><span class=\"o\">*</span><span class=\"w\"> </span><span class=\"n\">sex</span><span class=\"w\"> </span><span class=\"o\">+</span><span class=\"w\"> </span><span class=\"n\">disease</span><span class=\"w\"> </span><span class=\"o\">+</span><span class=\"w\"> </span><span class=\"p\">(</span><span class=\"m\">1</span><span class=\"o\">|</span><span class=\"n\">patient</span><span class=\"p\">),</span><span class=\"w\">\n                 </span><span class=\"n\">data</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">kidney</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">family</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">family</span><span class=\"p\">(</span><span class=\"s1\">'cox'</span><span class=\"p\">))</span><span class=\"w\">\n  </span><span class=\"n\">summary</span><span class=\"p\">(</span><span class=\"n\">fit3cox</span><span class=\"p\">)</span><span class=\"w\">\n  </span><span class=\"n\">plot</span><span class=\"p\">(</span><span class=\"n\">fit3cox</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">ask</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"kc\">FALSE</span><span class=\"p\">)</span><span class=\"w\">\n</span></code></pre> </div></div>\n\n<p>In case of compilng error, it is necessary to use the developmental version of rstan (2.21.3 at the time of writing), see below.</p>\n","dir":"/applications/","name":"brms.md","path":"applications/brms.md","url":"/applications/brms.html"},{"sort":8,"layout":"default","title":"Acknowledgement","content":"<h1 id=\"acknowledgement\">Acknowledgement</h1>\n\n<p>The repository was created as a result of the cambridge-ceu organisation; information regarding system login, Jupyter, polyphen, Stata and VEP received inputs from HPC supporint team.</p>\n","dir":"/systems/","name":"acknowledgement.md","path":"systems/acknowledgement.md","url":"/systems/acknowledgement.html"},{"sort":8,"layout":"default","title":"Contacts","content":"<h1 id=\"contacts\">Contacts</h1>\n\n<ul>\n <li><strong>CSD3 account</strong>: <a href=\"https://www.hpc.cam.ac.uk/rcs-application\">https://www.hpc.cam.ac.uk/rcs-application</a> as in <a href=\"https://www.hpc.cam.ac.uk/applications-access-research-computing-services\">Applications for Access to Research Computing Services</a>.</li>\n <li><strong>HPC support</strong>: <a href=\"mailto:support@hpc.cam.ac.uk\">support@hpc.cam.ac.uk</a> with the title “cardio migration”.</li>\n <li><strong>CEU contacts</strong>: Ank Michielsen (<a href=\"mailto:am2710@medschl.cam.ac.uk\">am2710@medschl.cam.ac.uk</a>) and Niko Ovenden (<a href=\"mailto:nao26@medschl.cam.ac.uk\">nao26@medschl.cam.ac.uk</a>).</li>\n <li><strong>Request for software</strong>: Savita Karthikeyan (<a href=\"mailto:sk752@medschl.cam.ac.uk\">sk752@medschl.cam.ac.uk</a>).</li>\n <li><strong>Contacts for data access</strong>. CSD3datamanager@medschl.cam.ac.uk.</li>\n</ul>\n","dir":"/systems/","name":"contacts.md","path":"systems/contacts.md","url":"/systems/contacts.html"},{"sort":8,"layout":"default","title":"Mentions Test","content":"# Mentions Test\n\n```\nHey @saowang, what do you think of this?\n```\n\nHey @saowang, what do you think of this?\n\n```tip\nSet config `plugins: [jekyll-mentions]`\n\nFor documentation, see: [https://github.com/jekyll/jekyll-mentions](https://github.com/jekyll/jekyll-mentions)\n```\n","dir":"/writing/test/","name":"mentions.md","path":"writing/test/mentions.md","url":"/writing/test/mentions.html"},{"sort":9,"layout":"default","title":"CaVEMaN","content":"<h1 id=\"caveman\">CaVEMaN</h1>\n\n<p>Web, https://github.com/funpopgen/CaVEMaN/</p>\n\n<p>Causal Variant Evidence Mapping with Non-parametric resampling (CaVEMaN) is one of the three fine-mapping software which provided data for GTEx v8.</p>\n\n<div class=\"language-bash highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"c\"># binary distribution</span>\nhttps://github.com/funpopgen/CaVEMaN/releases/download/v1.01/CaVEMaN\n<span class=\"c\"># build from source</span>\ngit clone https://github.com/funpopgen/CaVEMaN <span class=\"o\">&amp;&amp;</span> <span class=\"nb\">cd </span>CaVEMaN\nmodule load xz\nwget <span class=\"nt\">-qO-</span> https://github.com/ldc-developers/ldc/releases/download/v1.24.0/ldc2-1.24.0-linux-x86_64.tar.xz | <span class=\"se\">\\</span>\n<span class=\"nb\">tar </span>Jxf -\nmodule load gsl/2.1\n<span class=\"c\"># modify makefile</span>\nLDC :<span class=\"o\">=</span> <span class=\"k\">${</span><span class=\"nv\">PWD</span><span class=\"k\">}</span>/ldc2-1.24.0-linux-x86_64/bin/ldc2\nDMD :<span class=\"o\">=</span> <span class=\"k\">${</span><span class=\"nv\">PWD</span><span class=\"k\">}</span>/ldc2-1.24.0-linux-x86_64/bin/dmd\nGSL :<span class=\"o\">=</span> /usr/local/Cluster-Apps/gsl/2.1\nmake\n</code></pre> </div></div>\n\n<p>Note that the D compiler setup actually requires gsl/2.1.</p>\n","dir":"/applications/","name":"CaVEMaN.md","path":"applications/CaVEMaN.md","url":"/applications/CaVEMaN.html"},{"sort":9,"text":"ABCDEFGHIJKLMNOPQRSTUVWXYZ\nabcdefghijklmnopqrstuvwxyz\n1234567890\n一二三四五六七八九十百千萬上中下左右大小春夏秋冬東南西北金木水火土\n‘?’“!”(%)[#]{@}/&\\<-+÷×=>®©$€£¥¢:;,.*\n","layout":"default","title":"Fonts Test","content":"# Fonts Test\n\n`{:.font-mono}`\n\n```\n{{ page.text -}}\n```\n\n`{:.font-body}`\n\n{:.font-body}\n{{ page.text }}\n\n`{:.font-head}`\n\n{:.font-head}\n{{ page.text }}\n\n## font-awesome\n\n```html\n<i class=\"fa fa-check-circle text-green\">checked</i>\n<i class=\"fa fa-battery-quarter text-red\">battery</i>\n```\n\n<i class=\"fa fa-check-circle text-green\">checked</i>\n<i class=\"fa fa-battery-quarter text-red\">battery</i>\n","dir":"/writing/test/","name":"fonts.md","path":"writing/test/fonts.md","url":"/writing/test/fonts.html"},{"sort":10,"layout":"default","title":"citeproc","content":"<h1 id=\"citeproc\">citeproc</h1>\n\n<p>Web: <a href=\"https://hackage.haskell.org/package/citeproc\">https://hackage.haskell.org/package/citeproc</a> (<a href=\"https://github.com/jgm/citeproc\">GitHub</a>)</p>\n\n<p>We can set up the latest version as follows,</p>\n\n<div class=\"language-bash highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"nb\">cd</span> <span class=\"k\">${</span><span class=\"nv\">HPC_WORK</span><span class=\"k\">}</span>/\nwget <span class=\"nt\">-qO-</span> https://hackage.haskell.org/package/citeproc-0.4.0.1/citeproc-0.4.0.1.tar.gz | <span class=\"se\">\\</span>\n<span class=\"nb\">tar </span>xvfz -\n<span class=\"nb\">cd </span>citeproc-0.4.0.1\nmodule load cabal/3.0.0.0 gcc/6\ncabal <span class=\"nb\">install</span> <span class=\"nt\">--installdir</span><span class=\"o\">=</span><span class=\"k\">${</span><span class=\"nv\">HPC_WORK</span><span class=\"k\">}</span>/bin exe:citeproc\n</code></pre> </div></div>\n\n<p>We have error messages as follows,</p>\n\n<div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>[1 of 1] Compiling Main             ( app/Main.hs, dist/build/citeproc/citeproc-tmp/Main.o )\n\napp/Main.hs:35:36: error:\n    • Variable not in scope: (&lt;&gt;) :: IO () -&gt; [Char] -&gt; IO a0\n    • Perhaps you meant one of these:\n        ‘&lt;|&gt;’ (imported from Control.Applicative),\n        ‘&lt;$&gt;’ (imported from Prelude), ‘*&gt;’ (imported from Prelude)\n   |\n35 |     putStrLn $ \"citeproc version \" &lt;&gt; VERSION_citeproc\n   |                                    ^^\ncabal: Failed to build exe:citeproc from citeproc-0.4.0.1. See the build log\nabove for details.\n</code></pre> </div></div>\n\n<p>and we change <code class=\"language-plaintext highlighter-rouge\">&lt;&gt;</code> to <code class=\"language-plaintext highlighter-rouge\">&lt;|&gt;</code> at line 35 of <code class=\"language-plaintext highlighter-rouge\">app/Main.hs</code> and repeat the last command with success.</p>\n\n<p>An example use with <code class=\"language-plaintext highlighter-rouge\">pandoc</code>:</p>\n\n<div class=\"language-bash highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>pandoc README.md <span class=\"nt\">--citeproc</span> <span class=\"nt\">--mathjax</span> <span class=\"nt\">-s</span> <span class=\"nt\">-o</span> index.html\n</code></pre> </div></div>\n\n<p>where <code class=\"language-plaintext highlighter-rouge\">README.md</code> contains lines,</p>\n\n<div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>---\ntitle: Shiny for Genetic Analysis Package (gap) Designs\noutput:\n  html_document:\n    mathjax:  default\n    fig_caption:  true\n    toc: true\n    section_numbering: true\nbibliography: shinygap.bib\nvignette: &gt;\n  %\\VignetteEngine{knitr::rmarkdown}\n  %\\VignetteIndexEntry{Shiny for Genetic Analysis Package (gap) Designs}\n  %\\VignetteEncoding{UTF-8}\n---\n\n# Appendix: Theory for gap designs\n\n## Family-based and population-based designs\n\nSee the R/gap package vignette jss or @zhao07.\n\n## Case-cohort design\n\n### Power\n\nFollowing @cai04, we have\n$$\\Phi\\left(Z_\\alpha+\\tilde{n}^\\frac{1}{2}\\theta\\sqrt{\\frac{p_1p_2p_D}{q+(1-q)p_D}}\\right)$$\n\nwhere $\\alpha$ is the significance level, $\\theta$ is the log-hazard ratio for\ntwo groups, $p_j, j = 1, 2$, are the proportion of the two groups\nin the population ($p_1 + p_2 = 1$), $\\tilde{n}$ is the total number of subjects in the subcohort, $p_D$ is the proportion of the failures in\nthe full cohort, and $q$ is the sampling fraction of the subcohort.\n\n### Sample size\n\n$$\\tilde{n}=\\frac{nBp_D}{n-B(1-p_D)}$$ where $B=\\frac{Z_{1-\\alpha}+Z_\\beta}{\\theta^2p_1p_2p_D}$ and $n$ is the whole cohort size.\n\n# References\n\n</code></pre> </div></div>\n\n<p>and <code class=\"language-plaintext highlighter-rouge\">shinygap.bib</code> contains two entries,</p>\n\n<div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>@article{cai04,\n   author = {Cai, J. and Zeng, D.},\n   title = {Sample size/power calculation for case–cohort studies},\n   journal = {Biometrics},\n   volume = {60},\n   number = {4},\n   pages = {1015-1024},\n   ISSN = {1471-0056},\n   DOI = {10.1111/j.0006-341X.2004.00257.x},\n   year = {2004},\n   pmid = {15606422},\n   type = {Journal Article}\n}\n\n@article{zhao07,\n   Author = {Zhao, J. H.},\n   Title = {gap: genetic analysis package},\n   Journal = {Journal of Statistical Software},\n   Volume = {23},\n   Number = {8},\n   Pages = {1-18},\n   Year = {2007}\n}\n</code></pre> </div></div>\n\n<p>We would like to use available styles as well from <a href=\"https://github.com/citation-style-language/styles\">https://github.com/citation-style-language/styles</a>, after which we add the following after the command <code class=\"language-plaintext highlighter-rouge\">bibliography</code>.</p>\n\n<div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>csl: biomed-central.csl\n</code></pre> </div></div>\n","dir":"/applications/","name":"citeproc.md","path":"applications/citeproc.md","url":"/applications/citeproc.html"},{"sort":10,"layout":"default","title":"Primer Utilities Test","content":"# Primer Utilities Test\n\nText can be **bold**, _italic_, or ~~strikethrough~~. [Links](https://github.com) should be blue with no underlines (unless hovered over).\n\n{:.text-red}\nText can be **bold**, _italic_, or ~~strikethrough~~. [Links](https://github.com) should be blue with no underlines (unless hovered over).\n\n{:.bg-yellow-dark}\nText can be **bold**, _italic_, or ~~strikethrough~~. [Links](https://github.com) should be blue with no underlines (unless hovered over).\n\n{:.bg-yellow-dark.text-white}\nText can be **bold**, _italic_, or ~~strikethrough~~. [Links](https://github.com) should be blue with no underlines (unless hovered over).\n\n{:.bg-yellow-dark.text-white.m-5}\nText can be **bold**, _italic_, or ~~strikethrough~~. [Links](https://github.com) should be blue with no underlines (unless hovered over).\n\n{:.bg-yellow-dark.text-white.p-5.mb-6}\nText can be **bold**, _italic_, or ~~strikethrough~~. [Links](https://github.com) should be blue with no underlines (unless hovered over).\n\n{:.bg-yellow-dark.text-white.p-5.mb-6}\nText can be **bold**{:.h1}, _italic_, or ~~strikethrough~~. [Links](https://github.com) should be blue with no underlines (unless hovered over).\n\n{:.bg-yellow-dark.text-white.p-2.box-shadow-large}\nText can be **bold**{:.h1}, _italic_, or ~~strikethrough~~. [Links](https://github.com) should be blue with no underlines (unless hovered over).\n\n{:.bg-yellow-dark.text-white.p-5.box-shadow-large.anim-pulse}\nText can be **bold**{:.h1}, _italic_, or ~~strikethrough~~. [Links](https://github.com) should be blue with no underlines (unless hovered over).\n\n```tip\nEdit this page to see how to add this to your docs, theme can use [@primer/css utilities](https://primer.style/css/utilities)\n```\n","dir":"/writing/test/","name":"utilities.md","path":"writing/test/utilities.md","url":"/writing/test/utilities.html"},{"sort":11,"layout":"default","title":"DosageConverter","content":"<h1 id=\"dosageconverter\">DosageConverter</h1>\n\n<div class=\"language-bash highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"c\">## assuming you use hpc-work/ with a subdirectory called bin/</span>\n<span class=\"nb\">cd</span> /rds/user/<span class=\"nv\">$USER</span>/hpc-work/\ngit clone https://github.com/Santy-8128/DosageConvertor\n<span class=\"nb\">cd </span>DosageConverter\npip <span class=\"nb\">install </span>cget <span class=\"nt\">--user</span>\nmodule load cmake-3.8.1-gcc-4.8.5-zz55m7x\n./install.sh\n<span class=\"nb\">cd</span> /rds/user/<span class=\"nv\">$USER</span>/hpc-work/bin/\n<span class=\"nb\">ln</span> <span class=\"nt\">-s</span> /rds/user/<span class=\"nv\">$USER</span>/hpc-work/DosageConvertor/release-build/DosageConvertor\n<span class=\"c\">## testing</span>\nDosageConvertor  <span class=\"nt\">--vcfDose</span>  <span class=\"nb\">test</span>/TestDataImputedVCF.dose.vcf.gz <span class=\"se\">\\</span>\n                 <span class=\"nt\">--info</span>     <span class=\"nb\">test</span>/TestDataImputedVCF.info <span class=\"se\">\\</span>\n                 <span class=\"nt\">--prefix</span>   <span class=\"nb\">test</span> <span class=\"se\">\\</span>\n                 <span class=\"nt\">--type</span>     mach\n\n<span class=\"nb\">gunzip</span> <span class=\"nt\">-c</span> test.mach.dose.gz | <span class=\"nb\">wc</span> <span class=\"nt\">-l</span>\n\nDosageConvertor  <span class=\"nt\">--vcfDose</span>  <span class=\"nb\">test</span>/TestDataImputedVCF.dose.vcf.gz <span class=\"se\">\\</span>\n                 <span class=\"nt\">--info</span>     <span class=\"nb\">test</span>/TestDataImputedVCF.info <span class=\"se\">\\</span>\n                 <span class=\"nt\">--prefix</span>   <span class=\"nb\">test</span> <span class=\"se\">\\</span>\n                 <span class=\"nt\">--type</span>     plink\n\n<span class=\"nb\">gunzip</span> <span class=\"nt\">-c</span> test.plink.dosage.gz | <span class=\"nb\">wc</span> <span class=\"nt\">-l</span>\n</code></pre> </div></div>\n\n<p>so the MaCH dosage file is individual x genotype whereas PLINK dosage file is genotype x individual.</p>\n","dir":"/applications/","name":"DosageConverter.md","path":"applications/DosageConverter.md","url":"/applications/DosageConverter.html"},{"sort":12,"layout":"default","title":"EasyQC","content":"<h1 id=\"easyqc\">EasyQC</h1>\n\n<p>Web: <a href=\"https://www.uni-regensburg.de/medizin/epidemiologie-praeventivmedizin/genetische-epidemiologie/software/index.html\">https://www.uni-regensburg.de/medizin/epidemiologie-praeventivmedizin/genetische-epidemiologie/software/index.html</a></p>\n\n<h2 id=\"setup\">Setup</h2>\n\n<div class=\"language-bash highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>Rscript <span class=\"nt\">-e</span> <span class=\"s2\">\"install.packages('https://homepages.uni-regensburg.de/~wit59712/easyqc/EasyQC_23.8.tar.gz', repos = NULL, type = 'source')\"</span>\n</code></pre> </div></div>\n\n<h2 id=\"documentation-example\">Documentation example</h2>\n\n<p>With installation at ${HPC_WORK} (/rds/user/$USER/hpc-work/R/EasyQC) we could modify the example script</p>\n\n<div class=\"language-bash highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"nb\">sed</span> <span class=\"nt\">-i</span> <span class=\"s2\">\"s|EASY_INSTALL_DIR|/rds/user/</span><span class=\"nv\">$USER</span><span class=\"s2\">/hpc-work/R/EasyQC/extdata/|\"</span> /rds/user/<span class=\"nv\">$USER</span>/hpc-work/R/EasyQC/extdata/example_qc.ecf\nRscript <span class=\"nt\">-e</span> <span class=\"s2\">\"library(EasyQC);installDir=system.file('extdata', package='EasyQC');ecfFileQc=file.path(installDir,'example_qc.ecf');EasyQC(ecfFileQc)\"</span>\n</code></pre> </div></div>\n\n<p>and we have these output available from the current directory:</p>\n\n<div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>CLEANED.studyX_file1.txt\nCLEANED.studyX_file1.txt.10rows\nCLEANED.studyX_file2.txt\nCLEANED.studyX_file2.txt.10rows\nexample_qc.rep\n</code></pre> </div></div>\n\n<p>One can carry on with downloading reference data from the website above as well.</p>\n","dir":"/applications/","name":"EasyQC.md","path":"applications/EasyQC.md","url":"/applications/EasyQC.html"},{"sort":13,"layout":"default","title":"R/gnn","content":"# R/gnn\n\nIt requires libgsl, so\n\n```bash\nmodule load gsl/2.4\n```\n","dir":"/applications/","name":"gnn.md","path":"applications/gnn.md","url":"/applications/gnn.html"},{"sort":14,"layout":"default","title":"gsutil","content":"# gsutil\n\nWeb site: https://cloud.google.com/storage/docs/gsutil_install#linux\n\nthe authentification is achieved via Google SDK (e.g. [301.0.0](https://dl.google.com/dl/cloudsdk/channels/rapid/downloads/google-cloud-sdk-301.0.0-linux-x86_64.tar.gz))\n\n```bash\nwget https://dl.google.com/dl/cloudsdk/channels/rapid/downloads/google-cloud-sdk-301.0.0-linux-x86_64.tar.gz\ntar xfz google-cloud-sdk-301.0.0-linux-x86_64.tar.gz\ncd google-cloud-sdk\n./install.sh\n# to gain a bit flexibility by not using the awkward browser (Konqueror) at CSD3\ngcloud auto login --no-launch-browser\n# to set PROJECT_ID=divine-aegis-278909\ngcloud config set divine-aegis-278909\n```\n\nfollowed by `gsutil config` where `gsutil` is installed via `virtualenv` as follows,\n\n```bash\nmodule load python/3.7\nvirtualenv py37\nsource py37/bin/activate\npip install gsutil==4.50\ncd ${dir}/py37/bin\ngsutil ls\n# gsutil cp test gs::/covid19-hg-upload-bugbank\ngsutil cp test gs://covid19-hg-upload-uk--blood-donors-cohort\n```\n\nLess useful is the usual way to install.\n\n```bash\nwget https://storage.googleapis.com/pub/gsutil.tar.gz\ntar xvfz gsutil.tar.gz -C ..\ncd ../gsutil\npip install pyasn1==0.4.8 --user\npython setup.py install --prefix=$HPC_WORK\n```\n","dir":"/applications/","name":"gsutil.md","path":"applications/gsutil.md","url":"/applications/gsutil.html"},{"sort":15,"layout":"default","title":"gwas2vcf","content":"# gwas2vcf\n\nWeb: https://github.com/MRCIEU/gwas2vcf\n\nThe required setup script is as follows,\n\n```bash\nmodule load jdk-8u141-b15-gcc-5.4.0-p4aaopt\nmodule load gatk\nmodule load python/3.7\ngit clone https://github.com/MRCIEU/gwas2vcf\ncd gwas2vcf\npython -m venv env\nsource env/bin/activate\npip install -r requirements.txt\npip install git+git://github.com/bioinformed/vgraph@v1.4.0#egg=vgraph\nln -s ~/rds/public_databases/GRCh37_reference_fasta/human_g1k_v37.fasta\nln -s ~/rds/public_databases/GRCh37_reference_fasta/human_g1k_v37.fasta.fai\npython -m pytest -v test\npython main.py -h\n\n## these are not necessarily required and GRC37 is here, ~/rds/public_databases/GRCh37_reference_fasta/\n# GRCh36/hg18/b36\nwget http://fileserve.mrcieu.ac.uk/ref/2.8/b36/human_b36_both.fasta\nwget http://fileserve.mrcieu.ac.uk/ref/2.8/b36/human_b36_both.fasta.fai\n\n# GRCh37/hg19/b37\nwget http://fileserve.mrcieu.ac.uk/ref/2.8/b37/human_g1k_v37.fasta\nwget http://fileserve.mrcieu.ac.uk/ref/2.8/b37/human_g1k_v37.fasta.fai\n\n# GRCh38/hg38/b38\nwget https://storage.googleapis.com/genomics-public-data/resources/broad/hg38/v0/Homo_sapiens_assembly38.fasta\nwget https://storage.googleapis.com/genomics-public-data/resources/broad/hg38/v0/Homo_sapiens_assembly38.fasta.fai\n```\n","dir":"/applications/","name":"gwas2vcf.md","path":"applications/gwas2vcf.md","url":"/applications/gwas2vcf.html"},{"sort":16,"layout":"default","title":"hail","content":"# hail\n\nWeb: [https://hail.is/](https://hail.is/) as with [hail on cloud](https://github.com/danking/hail-cloud-docs/blob/master/how-to-cloud.md). We proceed as follows,\n\n```bash\nmodule load python/3.7 hadoop/2.7.7\nvirtualenv py37\nsource py37/bin/activate\npip install hail\npip install gnomAD\npython\n>>> import hail as hl\n>>> mt = hl.balding_nichols_model(n_populations=3, n_samples=50, n_variants=100)\n>>> mt.describe()\n>>> mt.summarize()\n>>> mt.count()\n>>> mt.show()\n>>> mt.write(\"hail\")\n>>> at = hl.import_vcf(\"INTERVAL.vcf.bgz\")\n>>> hl.export_vcf(at,\"at.vcf.bgz\")\n```\n\nSome files can be made available with `gsutil` installed. The HGDP data comes with release 3.1, `gs://gcp-public-data--gnomad/release/`.\n","dir":"/applications/","name":"hail.md","path":"applications/hail.md","url":"/applications/hail.html"},{"sort":17,"layout":"default","title":"HESS","content":"<h1 id=\"hess\">HESS</h1>\n\n<p>This section is extracted from https://github.com/jinghuazhao/software-notes.</p>\n\n<p>HESS (Heritability Estimation from Summary Statistics) is now available from https://github.com/huwenboshi/hess and has a web page at</p>\n\n<p>https://huwenboshi.github.io/hess-0.5/#hess</p>\n\n<p>To prepare for the software, one can proceeds with</p>\n\n<div class=\"language-bash highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>python <span class=\"nt\">-m</span> pip <span class=\"nb\">install </span>pysnptools <span class=\"nt\">--user</span>\n</code></pre> </div></div>\n\n<p>Now we set up for analysis of height</p>\n\n<div class=\"language-bash highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"c\">#!/bin/bash</span>\n\n<span class=\"nb\">export </span><span class=\"nv\">HEIGHT</span><span class=\"o\">=</span>https://portals.broadinstitute.org/collaboration/giant/images/0/01/GIANT_HEIGHT_Wood_et_al_2014_publicrelease_HapMapCeuFreq.txt.gz\n\nwget <span class=\"nt\">-qO-</span> <span class=\"nv\">$HEIGHT</span> | <span class=\"se\">\\</span>\n<span class=\"nb\">awk</span> <span class=\"s1\">'NR&gt;1'</span> | <span class=\"se\">\\</span>\n<span class=\"nb\">sort</span> <span class=\"nt\">-k1</span>,1 | <span class=\"se\">\\</span>\n<span class=\"nb\">join</span> <span class=\"nt\">-13</span> <span class=\"nt\">-21</span> snp150.txt - | <span class=\"se\">\\</span>\n<span class=\"nb\">awk</span> <span class=\"s1\">'($9!=\"X\" &amp;&amp; $9!=\"Y\" &amp;&amp; $9!=\"Un\"){if(NR==1) print \"SNP CHR BP A1 A2 Z N\"; else print $1,$2,$3,$4,$5,$7/$8,$10}'</span> <span class=\"o\">&gt;</span> height.tsv.gz\n\n<span class=\"c\">#  SNP - rs ID of the SNP (e.g. rs62442).</span>\n<span class=\"c\">#  CHR - Chromosome number of the SNP. This should be a number between 1 and 22.</span>\n<span class=\"c\">#  BP - Base pair position of the SNP.</span>\n<span class=\"c\">#  A1 - Effect allele of the SNP. The sign of the Z-score is with respect to this allele.</span>\n<span class=\"c\">#  A2 - The other allele of the SNP.</span>\n<span class=\"c\">#  Z - The Z-score of the SNP.</span>\n<span class=\"c\">#  N - Sample size of the SNP.</span>\n</code></pre> </div></div>\n\n<p>where snp150.txt from UCSC is described at the SUMSTATS repository, <a href=\"https://github.com/jinghuazhao/SUMSTATS\">https://github.com/jinghuazhao/SUMSTATS</a>.</p>\n\n<div class=\"language-bash highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"k\">for </span>chrom <span class=\"k\">in</span> <span class=\"si\">$(</span><span class=\"nb\">seq </span>22<span class=\"si\">)</span>\n<span class=\"k\">do\n    </span>python hess.py <span class=\"se\">\\</span>\n        <span class=\"nt\">--local-hsqg</span> height <span class=\"se\">\\</span>\n        <span class=\"nt\">--chrom</span> <span class=\"nv\">$chrom</span> <span class=\"se\">\\</span>\n        <span class=\"nt\">--bfile</span> 1kg_eur_1pct/1kg_eur_1pct_chr<span class=\"k\">${</span><span class=\"nv\">chrom</span><span class=\"k\">}</span> <span class=\"se\">\\</span>\n        <span class=\"nt\">--partition</span> nygcresearch-ldetect-data-ac125e47bf7f/EUR/fourier_ls-chr<span class=\"k\">${</span><span class=\"nv\">chrom</span><span class=\"k\">}</span>.bed <span class=\"se\">\\</span>\n        <span class=\"nt\">--out</span> step1\n<span class=\"k\">done\n</span>python hess.py <span class=\"nt\">--prefix</span> step1 <span class=\"nt\">--reinflate-lambda-gc</span> 1 <span class=\"nt\">--tot-hsqg</span> 0.8 0.2 <span class=\"nt\">--out</span> step2\n</code></pre> </div></div>\n\n<p>It is preferable to use <code class=\"language-plaintext highlighter-rouge\">miniconda</code> since it associates with faster libraries.</p>\n\n<div class=\"language-bash highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>module load miniconda2-4.3.14-gcc-5.4.0-xjtq53h\nconda <span class=\"nb\">install </span>pandas\n</code></pre> </div></div>\n","dir":"/applications/","name":"HESS.md","path":"applications/HESS.md","url":"/applications/HESS.html"},{"sort":18,"layout":"default","title":"KentUtils","content":"<h1 id=\"kentutils\">KentUtils</h1>\n\n<p>This is part of the Kent utilities in module <code class=\"language-plaintext highlighter-rouge\">kentutils-302.1-gcc-5.4.0-kbiujaa</code> nevertheless without the appropriate chain file.</p>\n\n<p>To download the latest utilitiess, try <code class=\"language-plaintext highlighter-rouge\">rsync -aP rsync://hgdownload.soe.ucsc.edu/genome/admin/exe/linux.x86_64/ ./</code>.</p>\n\n<p>The most notable is liftOver from UCSC here, <a href=\"https://genome.ucsc.edu/cgi-bin/hgLiftOver\">https://genome.ucsc.edu/cgi-bin/hgLiftOver</a>.</p>\n\n<p>Suppose we have <code class=\"language-plaintext highlighter-rouge\">r6-b38-A2.bed</code>,</p>\n\n<div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>#CHROM\tstart\tend\tSNP\nchr1\t841851\t841852\t1:841852:C:T\nchr1\t856472\t856473\t1:856473:G:A\nchr1\t858951\t858952\t1:858952:G:A\nchr1\t859841\t859842\t1:859842:C:G\nchr1\t863420\t863421\t1:863421:G:A\nchr1\t863578\t863579\t1:863579:G:A\nchr1\t864118\t864119\t1:864119:T:C\nchr1\t866155\t866156\t1:866156:T:G\nchr1\t866280\t866281\t1:866281:C:T\n</code></pre> </div></div>\n\n<p>To convert back to b37, our syntax is as follows,</p>\n\n<div class=\"language-bash highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>liftOver r6-b38-A2.bed hg38ToHg19.over.chain.gz r6-b37-A2.bed r6-b37-A2.unlifted.bed\n</code></pre> </div></div>\n\n<p>with <code class=\"language-plaintext highlighter-rouge\">r6-b37-A2.bed</code> containing these lines,</p>\n\n<div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>chr1\t777231\t777232\t1:841852:C:T\nchr1\t791852\t791853\t1:856473:G:A\nchr1\t794331\t794332\t1:858952:G:A\nchr1\t795221\t795222\t1:859842:C:G\nchr1\t798800\t798801\t1:863421:G:A\nchr1\t798958\t798959\t1:863579:G:A\nchr1\t799498\t799499\t1:864119:T:C\nchr1\t801535\t801536\t1:866156:T:G\nchr1\t801660\t801661\t1:866281:C:T\n</code></pre> </div></div>\n","dir":"/applications/","name":"KentUtils.md","path":"applications/KentUtils.md","url":"/applications/KentUtils.html"},{"sort":19,"layout":"default","title":"lapack","content":"# lapack\n\nWeb: [http://www.netlib.org/lapack/](http://www.netlib.org/lapack/)\n\nThe sequence is as follows,\n\n```bash\nwget http://www.netlib.org/lapack/lapack-3.9.0.tar.gz\ntar xvfz lapack-3.9.0.tar.gz\ncd lapack-3.9.0\nmkdir build\ncd build\n## ccmake .\ncmake ..\nmake\nmake install\n```\n\nNote `ccmake` is commented as it does not work properly on csd3. By default these build static libraries into build/lib/. It is also possible to build the static libraries in lapack-3.9.0/ by making a copy of `make.inc.example` as `make.inc` and compile `libblas.a`,`liblapack.a` as well as `libcblas.a` and `liblapacke.a` from BLAS/ and LAPACKE/ directories.\n\nTo enable the shared libraries, proceed with\n\n```bash\ncmake -DCMAKE_INSTALL_PREFIX=${HPC_WORK} -DCMAKE_BUILD_TYPE=RELEASE -DBUILD_SHARED_LIBS=ON -DLAPACKE=ON -DCBLAS=ON ..\n```\n","dir":"/applications/","name":"lapack.md","path":"applications/lapack.md","url":"/applications/lapack.html"},{"sort":20,"layout":"default","title":"R/LDlinkR","content":"<h1 id=\"rldlinkr\">R/LDlinkR</h1>\n\n<p>Issue <code class=\"language-plaintext highlighter-rouge\">install.packages(\"LDlinkR\")</code> from R but requires registration at <a href=\"https://ldlink.nci.nih.gov/?tab=apiaccess\">https://ldlink.nci.nih.gov/?tab=apiaccess</a>.</p>\n","dir":"/applications/","name":"LDlinkR.md","path":"applications/LDlinkR.md","url":"/applications/LDlinkR.html"},{"sort":21,"layout":"default","title":"LEMMA","content":"<h1 id=\"lemma\">LEMMA</h1>\n\n<p>A by-product of SAIGE installation is LEMMA,</p>\n\n<div class=\"language-bash highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>wget <span class=\"nt\">-qO-</span> https://github.com/mkerin/LEMMA/archive/v1.0.2.tar.gz | <span class=\"se\">\\</span>\n<span class=\"nb\">tar </span>xvfz | <span class=\"se\">\\</span>\n<span class=\"nb\">cd </span>LEMMA-1.0.2\ncmake <span class=\"nt\">-S</span> <span class=\"nb\">.</span> <span class=\"nt\">-B</span> build <span class=\"se\">\\</span>\n      <span class=\"nt\">-DBGEN_ROOT</span><span class=\"o\">=</span><span class=\"k\">${</span><span class=\"nv\">HOME</span><span class=\"k\">}</span>/SAIGE/thirdParty/bgen <span class=\"se\">\\</span>\n      <span class=\"nt\">-DBOOST_ROOT</span><span class=\"o\">=</span><span class=\"k\">${</span><span class=\"nv\">HOME</span><span class=\"k\">}</span>/SAIGE/thirdParty/bgen/3rd_party/boost_1_55_0\n<span class=\"nb\">cd </span>build\nmake\n</code></pre> </div></div>\n","dir":"/applications/","name":"LEMMA.md","path":"applications/LEMMA.md","url":"/applications/LEMMA.html"},{"sort":22,"layout":"default","title":"R/magick","content":"# R/magick\n\nWhen installing the package we have error message,\n\n```\n> install.packages(\"magick\")\nInstalling package into ‘/rds/user/jhz22/hpc-work/R’\n(as ‘lib’ is unspecified)\ntrying URL 'https://cran.r-project.org/src/contrib/magick_2.7.1.tar.gz'\nContent type 'application/x-gzip' length 4813079 bytes (4.6 MB)\n==================================================\ndownloaded 4.6 MB\n\n* installing *source* package ‘magick’ ...\n** package ‘magick’ successfully unpacked and MD5 sums checked\n** using staged installation\nPackage Magick++ was not found in the pkg-config search path.\nPerhaps you should add the directory containing `Magick++.pc'\nto the PKG_CONFIG_PATH environment variable\nNo package 'Magick++' found\nUsing PKG_CFLAGS=\nUsing PKG_LIBS=-lMagick++-6.Q16\n--------------------------- [ANTICONF] --------------------------------\nConfiguration failed to find the Magick++ library. Try installing:\n - deb: libmagick++-dev (Debian, Ubuntu)\n - rpm: ImageMagick-c++-devel (Fedora, CentOS, RHEL)\n - csw: imagemagick_dev (Solaris)\n - brew imagemagick@6 (MacOS)\nFor Ubuntu versions Trusty (14.04) and Xenial (16.04) use our PPA:\n sudo add-apt-repository -y ppa:cran/imagemagick\n sudo apt-get update\n sudo apt-get install -y libmagick++-dev\nIf Magick++ is already installed, check that 'pkg-config' is in your\nPATH and PKG_CONFIG_PATH contains a Magick++.pc file. If pkg-config\nis unavailable you can set INCLUDE_DIR and LIB_DIR manually via:\nR CMD INSTALL --configure-vars='INCLUDE_DIR=... LIB_DIR=...'\n-------------------------- [ERROR MESSAGE] ---------------------------\n<stdin>:1:22: fatal error: Magick++.h: No such file or directory\ncompilation terminated.\n--------------------------------------------------------------------\nERROR: configuration failed for package ‘magick’\n* removing ‘/rds/user/jhz22/hpc-work/R/magick’\n\nThe downloaded source packages are in\n ‘/tmp/RtmpI9BUec/downloaded_packages’\nWarning message:\nIn install.packages(\"magick\") :\n installation of package ‘magick’ had non-zero exit status\n```\n\nAlthough `which convert` and `which display` both point to `/usr/bin`,\nit turned out that the required ImageMick needs to be loaded as follows,\n\n```bash\nmodule load image-magick-7.0.5-9-gcc-5.4.0-d4lemcc\n```\n","dir":"/applications/","name":"magick.md","path":"applications/magick.md","url":"/applications/magick.html"},{"sort":23,"layout":"default","title":"MetaXcan","content":"<h1 id=\"metaxcan\">MetaXcan</h1>\n\n<p>Web: https://github.com/hakyimlab/MetaXcan</p>\n\n<p>Installation and a test run,</p>\n\n<div class=\"language-bash highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>git clone https://github.com/hakyimlab/MetaXcan\n<span class=\"nb\">cd </span>MetaXcan/software\n<span class=\"c\"># download sample_data.tar.gz</span>\n<span class=\"nb\">tar</span> <span class=\"nt\">-xzvpf</span> sample_data.tar.gz\nmodule load miniconda3/4.5.1\nconda <span class=\"nb\">env </span>create <span class=\"nt\">-f</span> <span class=\"nv\">$HPC_WORK</span>/MetaXcan/software/conda_env.yaml\nconda activate imlabtools\nconda <span class=\"nb\">install </span>pandas\npython setup.py <span class=\"nb\">install</span> <span class=\"nt\">--user</span>\n\n./SPrediXcan.py <span class=\"se\">\\</span>\n<span class=\"nt\">--model_db_path</span> data/DGN-WB_0.5.db <span class=\"se\">\\</span>\n<span class=\"nt\">--covariance</span> data/covariance.DGN-WB_0.5.txt.gz <span class=\"se\">\\</span>\n<span class=\"nt\">--gwas_folder</span> data/GWAS <span class=\"se\">\\</span>\n<span class=\"nt\">--gwas_file_pattern</span> <span class=\"s2\">\".*gz\"</span> <span class=\"se\">\\</span>\n<span class=\"nt\">--snp_column</span> SNP <span class=\"se\">\\</span>\n<span class=\"nt\">--effect_allele_column</span> A1 <span class=\"se\">\\</span>\n<span class=\"nt\">--non_effect_allele_column</span> A2 <span class=\"se\">\\</span>\n<span class=\"nt\">--beta_column</span> BETA <span class=\"se\">\\</span>\n<span class=\"nt\">--pvalue_column</span> P <span class=\"se\">\\</span>\n<span class=\"nt\">--output_file</span> results/test.csv\n</code></pre> </div></div>\n","dir":"/applications/","name":"MetaXcan.md","path":"applications/MetaXcan.md","url":"/applications/MetaXcan.html"},{"sort":24,"layout":"default","title":"pandoc","content":"# pandoc\n\nWeb: [https://pandoc.org/](https://pandoc.org/)\n\nThe latest release: [https://github.com/jgm/pandoc/releases/tag/2.13](https://github.com/jgm/pandoc/releases/tag/2.13)\n\nSome applications requires the more recent version than those from CSD3; it is straightforward to install.\n\n```bash\ncd ${HPC_WORK}\nwget -qO- https://github.com/jgm/pandoc/releases/download/2.13/pandoc-2.13-linux-amd64.tar.gz | tar xvfz - --strip-components=1\n```\n\nso that the executable file and documentation are made available from bin/ and share/ directories, respectively.\n\nSee citeproc for handling bibliography.\n","dir":"/applications/","name":"pandoc.md","path":"applications/pandoc.md","url":"/applications/pandoc.html"},{"sort":25,"layout":"default","title":"PCA projection","content":"# PCA projection\n\nOfficial page: [https://github.com/covid19-hg/pca_projection](https://github.com/covid19-hg/pca_projection).\n\n```bash\ngit clone https://github.com/covid19-hg/pca_projection\ncd pca_projection\n```\n\n## setup\n\nThe required steps according to the documentation can be summarised as follows,\n\n```bash\n# Pre-computed PCA loadings, reference allele frequencies and scores\nwget https://storage.googleapis.com/covid19-hg-public/pca_projection/hgdp_tgp_pca_covid19hgi_snps_loadings.GRCh37.plink.tsv\nwget https://storage.googleapis.com/covid19-hg-public/pca_projection/hgdp_tgp_pca_covid19hgi_snps_loadings.GRCh37.plink.afreq\nwget https://storage.googleapis.com/covid19-hg-public/pca_projection/hgdp_tgp_pca_covid19hgi_snps_loadings.GRCh38.plink.tsv\nwget https://storage.googleapis.com/covid19-hg-public/pca_projection/hgdp_tgp_pca_covid19hgi_snps_loadings.GRCh38.plink.afreq\nwget https://storage.googleapis.com/covid19-hg-public/pca_projection/hgdp_tgp_pca_covid19hgi_snps_loadings.rsid.plink.tsv\nwget https://storage.googleapis.com/covid19-hg-public/pca_projection/hgdp_tgp_pca_covid19hgi_snps_loadings.rsid.plink.afreq\nwget https://storage.googleapis.com/covid19-hg-public/pca_projection/hgdp_tgp_pca_covid19hgi_snps_scores.txt.gz\n\n# imputed PLINK2 dosage files\n\ncut -f1 [path to the pre-computed loadings file] | tail -n +2 > variants.extract\n\n## .pgen/.pvar/.psam\nplink2 \\\n --pfile [path to your per-chromosome pfile] \\\n --extract variants.extract \\\n --make-pfile \\\n --out [per-chromosome output name]\nls [the previous per-chromosome output prefix].*.pgen | sed -e ‘s/.pgen//’ > merge-list.txt\nplink2 --pmerge-list merge-list.txt --out [all-chromosome output name]\n\n## .bed/.bim/.fam\n\nplink \\\n --bfile [path to your per-chromosome pfile] \\\n --extract variants.extract \\\n --make-bed \\\n --out [per-chromosome output name]\nls [outname].*.bed | sed -e ‘s/.bed//’ > merge-list.txt\nplink --merge-list merge-list.txt --out [all-chromosome output name]\n\n## .bgen/.sample (in doubt)\n\nbgenix \\\n -g [path to your per-chromosome bgen] \\\n -incl-rsids variant.extract \\\n > [per-chromosome output name].bgen\ncat-bgen \\\n-g [path to your per-chromosome bgen 1] \\\n [path to your per-chromosome bgen 2] \\\n...\n [path to your per-chromosome bgen 22] \\\n-og [all-chromosome outname]\nplink2 \\\n --bgen [path to all-chromosome bgen] [REF/ALT mode] \\\n --make-pfile \\\n --out [output pfile name]\n\n## .vcf\n\nbcftools view -Oz \\\n -i “ID = @variants.extract” \\\n [path to your per-chromosome vcf file] \\\n > [per-chromosome outname>.vcf.gz]\nbcftools concat -Oz [per-chromosome vcf files] > [all-chromosome outname].vcf.gz\nplink2 \\\n --vcf [all-chromosome outname].vcf.gz \\\n dosage=[dosage field name] \\\n --make-pfile \\\n --out [outname]\n\n# project and plot PC\n\nplink2 \\\n ${input_command} \\\n --score ${PCA_LOADINGS} \\\n center \\\n cols=-scoreavgs,+scoresums \\\n list-variants \\\n header-read \\\n --score-col-nums 3-22 \\\n --read-freq ${PCA_AF} \\\n --out ${OUTNAME}\n\nRscript -e \"install.packages(c(\"data.table\", \"hexbin\", \"optparse\", \"patchwork\", \"R.utils\", \"tidyverse\"))\"\nRscript plot_projected_pc.R \\\n --sscore [path to .sscore output] \\\n --phenotype-file [path to phenotype file] \\\n --phenotype-col [phenotype column name]\n --covariate-file [path to covariate file] \\\n --pc-prefix [prefix of PC columns] \\\n --pc-num [number of PCs used in GWAS] \\\n --ancestry [ancestry code: AFR, AMR, EAS, EUR, MID, or SAS] \\\n --study [your study name] \\\n --out [output name prefix]\n\n# --ancestry-file [path to ancestry file] \\\n# --ancestry-col [ancestry column name]\n# --reference-score-file\n```\n\n## Implementation\n\nThis is detailed below by section.\n\n```bash\n#!/usr/bin/bash\n\nexport TMPDIR=${HPC_WORK}/work\n# genotype\nexport autosomes=~/rds/post_qc_data/interval/imputed/uk10k_1000g_b37/\n# location of PCs\nexport ref=~/rds/post_qc_data/interval/reference_files/genetic/reference_files_genotyped_imputed/\n# HGI working directory\nexport prefix=~/rds/rds-asb38-ceu-restricted/projects/covid/HGI\nexport dir=20201201-ANA_C2_V2\n\nexport PCA_projection=pca_projection\nexport PCA_loadings=hgdp_tgp_pca_covid19hgi_snps_loadings.GRCh37.plink.tsv\nexport PCA_af=hgdp_tgp_pca_covid19hgi_snps_loadings.GRCh37.plink.afreq\nexport sscore=hgdp_tgp_pca_covid19hgi_snps_scores.txt.gz\n\nmodule load plink/2.00-alpha ceuadmin/stata\n\nfunction extract_data()\n{\n cut -f1 ${PCA_projection}/${PCA_loadings} | tail -n +2 > variants.extract\n (\n cat variants.extract\n awk '{split($1,a,\":\");print \"chr\"a[1]\":\"a[2]\"_\"a[4]\"_\"a[3]}' variants.extract\n ) > variants.extract2\n\n cp ${prefix}/${dir}/output/INTERVAL-*.bgen.bgi ${TMPDIR}\n seq 22 | \\\n parallel -C' ' --env prefix --env dir '\n ln -sf ${prefix}/${dir}/output/INTERVAL-{}.bgen ${TMPDIR}/INTERVAL-{}.bgen\n python update_bgi.py --bgi ${TMPDIR}/INTERVAL-{}.bgen.bgi\n bgenix -g ${TMPDIR}/INTERVAL-{}.bgen -incl-rsids variants.extract2 > ${prefix}/work/INTERVAL-{}.bgen\n '\n}\n\nfunction twist()\n{\n cat-bgen -g $(echo ${prefix}/work/INTERVAL-{1..22}.bgen) -og ${prefix}/work/INTERVAL.bgen -clobber\n bgenix -g ${prefix}/work/INTERVAL.bgen -index -clobber\n\n plink2 --bgen ${prefix}/work/INTERVAL.bgen ref-first --make-pfile --out INTERVAL\n\n export csvfile=INTERVAL.csv\n python update_bgi.py --bgi INTERVAL.bgen.bgi\n (\n head -1 INTERVAL.pvar\n paste <(sed '1d' INTERVAL.pvar | cut -f1,2) \\\n <(sed '1d' INTERVAL.csv | cut -d, -f3) | \\\n paste - <(sed '1d' INTERVAL.pvar | cut -f4,5)\n ) > ${prefix}/work/INTERVAL.pvar\n cp INTEVAL.p?? ${prefix}/work\n}\n\nfunction project_pc()\n{\n#!/bin/bash\n\n set -eu\n################################################################################\n# Please fill in the below variables\n################################################################################\n# Metadata\n STUDY_NAME=\"INTERVAL\"\n ANALYST_LAST_NAME=\"ZHAO\"\n DATE=\"$(date +'%Y%m%d')\"\n OUTNAME=\"${prefix}/work/${STUDY_NAME}.${ANALYST_LAST_NAME}.${DATE}\"\n################################################################################\n# Location of downloaded input files\n PCA_LOADINGS=\"${PCA_projection}/${PCA_loadings}\"\n PCA_AF=\"${PCA_projection}/${PCA_af}\"\n################################################################################\n# Location of imputed genotype files\n# [Recommended]\n# PLINK 2 binary format: a prefix (with directories) of .pgen/.pvar/.psam files\n PFILE=\"${prefix}/work/INTERVAL\"\n# [Acceptable]\n# PLINK 1 binary format: a prefix of .bed/.bim/.fam files\n BFILE=\"\"\n################################################################################\n\n function error_exit() {\n echo \"${1:-\"Unknown Error\"}\" 1>&2\n exit 1\n }\n\n# Input checks\n if [[ -z \"${STUDY_NAME}\" ]]; then\n error_exit \"Please specify \\$STUDY_NAME.\"\n fi\n\n if [[ -z \"${ANALYST_LAST_NAME}\" ]]; then\n error_exit \"Please specify \\$ANALYST_LAST_NAME.\"\n fi\n\n if [[ -z \"${PCA_LOADINGS}\" ]]; then\n error_exit \"Please specify \\$PCA_LOADINGS.\"\n fi\n\n if [[ -z \"${PCA_AF}\" ]]; then\n error_exit \"Please specify \\$PCA_AF.\"\n fi\n\n if [[ -n \"${PFILE}\" ]]; then\n input_command=\"--pfile ${PFILE}\"\n elif [[ -n \"${BFILE}\" ]]; then\n input_command=\"--bfile ${BFILE}\"\n else\n error_exit \"Either \\$PFILE or \\$BFILE should be specified\"\n fi\n\n# Run plink2 --score\n plink2 \\\n ${input_command} \\\n --score ${PCA_LOADINGS} \\\n variance-standardize \\\n cols=-scoreavgs,+scoresums \\\n list-variants \\\n header-read \\\n --score-col-nums 3-12 \\\n --read-freq ${PCA_AF} \\\n --out ${OUTNAME}\n\n# The score file does not have FID (=0)\n awk '\n {\n if (NR==1) $1=\"#FID IID\"\n else $1=0\" \"$1\n print\n }' ${OUTNAME}.sscore > ${prefix}/work/snpid.sscore\n ln -sf ${OUTNAME}.sscore.vars ${prefix}/work/snpid.sscore.vars\n\n# Our PCs are PC_# rather than PC#\n# The phenotype and covariate file missed FID (=0) column\n awk '\n {\n if (NR==1)\n {\n $1=\"FID I\"$1\n gsub(/PC_/,\"PC\",$0)\n }\n else $1=0\" \" $1\n };1' ${dir}/work/INTERVAL-covid.txt | \\\n tr ' ' '\\t' > ${prefix}/work/snpid.txt\n cut -f1-3 ${prefix}/work/snpid.txt > ${prefix}/work/snpid.pheno\n cut -f3 --complement ${prefix}/work/snpid.txt > ${prefix}/work/snpid.covars\n\n stata -b do ethnic.do\n\n Rscript ${PCA_projection}/plot_projected_pc.R \\\n --sscore ${prefix}/work/snpid.sscore \\\n --phenotype-file ${prefix}/work/snpid.pheno \\\n --phenotype-col SARS_CoV \\\n --covariate-file ${prefix}/work/snpid.covars \\\n --pc-prefix PC \\\n --pc-num 20 \\\n --ancestry-file ethnic.txt \\\n --ancestry-col ethnic \\\n --study ${STUDY_NAME} \\\n --out ${OUTNAME}\n}\n\nextract_data;twist;project_pc\n```\n\n### update_bgi.py\n\nThe magic `update_bgi.py` is as follows\n\n```python\nimport argparse\nimport os\nimport pandas as pd\nimport sqlite3\n\n# mapping chromosome string (incluing 01-09, 23, and X) and correct string\nCHROM_MAPPING_STR = dict([(str(i), str(i)) for i in range(1, 23)] + [('0' + str(i), str(i)) for i in range(1, 10)] +\n [('X', 'X')])\ncsvfile=os.environ['csvfile']\n\ndef main(args):\n conn = sqlite3.connect(args.bgi)\n c = conn.cursor()\n df = pd.read_sql(\"select * from Variant\", conn)\n print(df,flush=True)\n df.rsid = df.apply(lambda x: \"{}:{}:{}:{}\".format(CHROM_MAPPING_STR[x[0]], x[1], x[4], x[5]), axis=1)\n print(df,flush=True)\n df.to_sql(\"Variant\", conn, if_exists=\"replace\", index=False)\n if csvfile != '':\n df.to_csv(csvfile,index=False)\n conn.close()\n\nif __name__ == '__main__':\n parser = argparse.ArgumentParser()\n parser.add_argument('--bgi', type=str, required=True)\n args = parser.parse_args()\n main(args)\n```\n\n### bgi.sql\n\nOne may wonder the information regarding `.bgen.bgi` at all, which can be viewed as follows,\n\n```bash\nsqlite3 INTERVAL.bgen.bgi < bgi.sql\n```\n\nwhile `bgi.sql` has the following lines\n\n```sqlite3\n.tables\n.separator \"\\t\"\n.header on\n.output metadata.txt\nselect * from metadata;\n.output Variant.txt\nselect * from Variant;\n```\n\n### ethnic.do\n\nThe Stata program generates files containing FID, IID and ethnicity\n\n```stata\ngzuse work/INTERVAL-omics-covid.dta.gz\nsort identifier\ngzsave INTERVAL-omics-covid, replace\ninsheet using 20201201/INTERVALdata_01DEC2020.csv, case clear\nsort identifier\ngzmerge identifier using INTERVAL-omics-covid.dta.gz\ntabulate ethnicPulse SARS_CoV, all\ngen str20 ethnic=ethnicPulse\nreplace ethnic=\"EUR\" if inlist(ethnicPulse,\"Eng/W/Scot/NI/Brit\",\"White Irish\")==1\nreplace ethnic=\"EAS\" if inlist(ethnicPulse,\"Asian- Bangladeshi\",\"Asian- Indian\",\"Asian- Pakistani\",\"Chinese\")==1\nreplace ethnic=\"MID\" if ethnicPulse==\"Arab\"\ngen ethnic_NA=ethnic\nreplace ethnic_NA=\"NA\" if inlist(ethnic,\"EUR\",\"EAS\",\"MID\")==0\ntab ethnic SARS_CoV, all\ntab ethnic_NA SARS_CoV, all\ngen FID=0\nrename ID IID\noutsheet FID IID ethnic using ethnic.txt if IID!=., noquote replace\noutsheet FID IID ethnic_NA using ethnic_NA.txt if IID!=., noquote replace\nrm INTERVAL-omics-covid.dta.gz\n```\n","dir":"/applications/","name":"pca_projection.md","path":"applications/pca_projection.md","url":"/applications/pca_projection.html"},{"sort":26,"layout":"default","title":"R/PhenoScanner","content":"<h1 id=\"rphenoscanner\">R/PhenoScanner</h1>\n\n<h2 id=\"r-package-setup\">R package setup</h2>\n\n<div class=\"language-bash highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>install.packages<span class=\"o\">(</span><span class=\"s2\">\"devtools\"</span><span class=\"o\">)</span>\nlibrary<span class=\"o\">(</span>devtools<span class=\"o\">)</span>\ninstall_github<span class=\"o\">(</span><span class=\"s2\">\"phenoscanner/phenoscanner\"</span><span class=\"o\">)</span>\nlibrary<span class=\"o\">(</span>phenoscanner<span class=\"o\">)</span>\nexample<span class=\"o\">(</span>phenoscanner<span class=\"o\">)</span>\n</code></pre> </div></div>\n\n<h2 id=\"long-query\">Long query</h2>\n\n<p>The call is made by chunks, e.g.,</p>\n\n<div class=\"language-r highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"n\">options</span><span class=\"p\">(</span><span class=\"n\">width</span><span class=\"o\">=</span><span class=\"m\">500</span><span class=\"p\">)</span><span class=\"w\">\n</span><span class=\"n\">require</span><span class=\"p\">(</span><span class=\"n\">phenoscanner</span><span class=\"p\">)</span><span class=\"w\">\n</span><span class=\"n\">rsid</span><span class=\"w\"> </span><span class=\"o\">&lt;-</span><span class=\"w\"> </span><span class=\"n\">scan</span><span class=\"p\">(</span><span class=\"s2\">\"swath-ms-invn.snp\"</span><span class=\"p\">,</span><span class=\"n\">what</span><span class=\"o\">=</span><span class=\"s2\">\"\"</span><span class=\"p\">)</span><span class=\"w\">\n</span><span class=\"n\">batches</span><span class=\"w\"> </span><span class=\"o\">&lt;-</span><span class=\"w\"> </span><span class=\"n\">split</span><span class=\"p\">(</span><span class=\"n\">rsid</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"nf\">ceiling</span><span class=\"p\">(</span><span class=\"nf\">seq_along</span><span class=\"p\">(</span><span class=\"n\">rsid</span><span class=\"p\">)</span><span class=\"o\">/</span><span class=\"m\">100</span><span class=\"p\">))</span><span class=\"w\">\n</span><span class=\"n\">s</span><span class=\"w\"> </span><span class=\"o\">&lt;-</span><span class=\"w\"> </span><span class=\"n\">t</span><span class=\"w\"> </span><span class=\"o\">&lt;-</span><span class=\"w\"> </span><span class=\"nf\">list</span><span class=\"p\">()</span><span class=\"w\">\n</span><span class=\"k\">for</span><span class=\"p\">(</span><span class=\"n\">i</span><span class=\"w\"> </span><span class=\"k\">in</span><span class=\"w\"> </span><span class=\"m\">1</span><span class=\"o\">:</span><span class=\"nf\">length</span><span class=\"p\">(</span><span class=\"n\">batches</span><span class=\"p\">))</span><span class=\"w\">\n</span><span class=\"p\">{</span><span class=\"w\">\n  </span><span class=\"n\">q</span><span class=\"w\"> </span><span class=\"o\">&lt;-</span><span class=\"w\"> </span><span class=\"n\">phenoscanner</span><span class=\"p\">(</span><span class=\"n\">snpquery</span><span class=\"o\">=</span><span class=\"n\">batches</span><span class=\"p\">[[</span><span class=\"n\">i</span><span class=\"p\">]],</span><span class=\"w\"> </span><span class=\"n\">catalogue</span><span class=\"o\">=</span><span class=\"s2\">\"pQTL\"</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">proxies</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"s2\">\"EUR\"</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">pvalue</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"m\">1e-07</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">r2</span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"m\">0.6</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">build</span><span class=\"o\">=</span><span class=\"m\">37</span><span class=\"p\">)</span><span class=\"w\">\n  </span><span class=\"n\">s</span><span class=\"p\">[[</span><span class=\"n\">i</span><span class=\"p\">]]</span><span class=\"w\"> </span><span class=\"o\">&lt;-</span><span class=\"w\"> </span><span class=\"n\">with</span><span class=\"p\">(</span><span class=\"n\">q</span><span class=\"p\">,</span><span class=\"n\">snps</span><span class=\"p\">)</span><span class=\"w\">\n  </span><span class=\"n\">t</span><span class=\"p\">[[</span><span class=\"n\">i</span><span class=\"p\">]]</span><span class=\"w\"> </span><span class=\"o\">&lt;-</span><span class=\"w\"> </span><span class=\"n\">with</span><span class=\"p\">(</span><span class=\"n\">q</span><span class=\"p\">,</span><span class=\"n\">results</span><span class=\"p\">)</span><span class=\"w\">\n</span><span class=\"p\">}</span><span class=\"w\">\n</span><span class=\"n\">snps</span><span class=\"w\"> </span><span class=\"o\">&lt;-</span><span class=\"w\"> </span><span class=\"n\">do.call</span><span class=\"p\">(</span><span class=\"n\">rbind</span><span class=\"p\">,</span><span class=\"n\">s</span><span class=\"p\">)</span><span class=\"w\">\n</span><span class=\"n\">results</span><span class=\"w\"> </span><span class=\"o\">&lt;-</span><span class=\"w\"> </span><span class=\"n\">do.call</span><span class=\"p\">(</span><span class=\"n\">rbind</span><span class=\"p\">,</span><span class=\"n\">t</span><span class=\"p\">)</span><span class=\"w\">\n</span><span class=\"n\">r</span><span class=\"w\"> </span><span class=\"o\">&lt;-</span><span class=\"w\"> </span><span class=\"nf\">list</span><span class=\"p\">(</span><span class=\"n\">snps</span><span class=\"o\">=</span><span class=\"n\">snps</span><span class=\"p\">,</span><span class=\"n\">results</span><span class=\"o\">=</span><span class=\"n\">results</span><span class=\"p\">)</span><span class=\"w\">\n</span></code></pre> </div></div>\n\n<p>i.e., each chunk has 100 SNPs and chunks are combined manually.</p>\n\n<h2 id=\"command-line-interface-cli\">Command-line interface (CLI)</h2>\n\n<div class=\"language-bash highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>module load ceuadmin/phenoscanner\nphenoscanner <span class=\"nt\">--help</span>\nphenoscanner <span class=\"nt\">--snp</span><span class=\"o\">=</span>rs704 <span class=\"nt\">-c</span> All <span class=\"nt\">-x</span> EUR <span class=\"nt\">-r</span> 0.8\nphenoscanner <span class=\"nt\">-s</span> T <span class=\"nt\">-c</span> All <span class=\"nt\">-x</span> EUR <span class=\"nt\">-p</span> 0.0000001 <span class=\"nt\">--r2</span> 0.6 <span class=\"nt\">-i</span> INF1.merge.snp <span class=\"nt\">-o</span> INF1\n</code></pre> </div></div>\n\n<p>Note that <code class=\"language-plaintext highlighter-rouge\">module load phenoscanner</code> is enabled from ~/.bashrc:</p>\n\n<div class=\"language-bash highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"nb\">export </span><span class=\"nv\">MODULEPATH</span><span class=\"o\">=</span><span class=\"k\">${</span><span class=\"nv\">MODULEPATH</span><span class=\"k\">}</span>:/usr/local/Cluster-Config/modulefiles/ceuadmin/\n</code></pre> </div></div>\n\n<p>via <code class=\"language-plaintext highlighter-rouge\">source ~/.bashrc</code> or a new login.</p>\n\n<h2 id=\"r-4xx\">R 4.x.x</h2>\n\n<p>Section above would fail under R 4.x.x; to get around, make a copy of phenoscanner according to</p>\n\n<div class=\"language-bash highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>module load ceuadmin/phenoscanner\nwhich phenoscanner\n<span class=\"c\"># /rds/project/jmmh2/rds-jmmh2-projects/phenoscanner/mrcatalogue/mrcatalogue/phenoscanner_v2/phenoscanner</span>\n</code></pre> </div></div>\n\n<p>and edit the header to call packages at the default R_LIBS location,</p>\n\n<div class=\"language-r highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"c1\">#!/rds/user/jhz22/hpc-work/bin/Rscript</span><span class=\"w\">\n</span><span class=\"n\">suppressPackageStartupMessages</span><span class=\"p\">(</span><span class=\"n\">library</span><span class=\"p\">(</span><span class=\"n\">getopt</span><span class=\"p\">))</span><span class=\"w\">\n</span><span class=\"n\">suppressPackageStartupMessages</span><span class=\"p\">(</span><span class=\"n\">library</span><span class=\"p\">(</span><span class=\"n\">optparse</span><span class=\"p\">))</span><span class=\"w\">\n</span><span class=\"n\">suppressPackageStartupMessages</span><span class=\"p\">(</span><span class=\"n\">library</span><span class=\"p\">(</span><span class=\"n\">DBI</span><span class=\"p\">))</span><span class=\"w\">\n</span><span class=\"n\">suppressPackageStartupMessages</span><span class=\"p\">(</span><span class=\"n\">library</span><span class=\"p\">(</span><span class=\"n\">RMySQL</span><span class=\"p\">))</span><span class=\"w\">\n</span><span class=\"n\">suppressPackageStartupMessages</span><span class=\"p\">(</span><span class=\"n\">library</span><span class=\"p\">(</span><span class=\"n\">reshape2</span><span class=\"p\">))</span><span class=\"w\">\n</span><span class=\"n\">suppressPackageStartupMessages</span><span class=\"p\">(</span><span class=\"n\">library</span><span class=\"p\">(</span><span class=\"n\">plyr</span><span class=\"p\">))</span><span class=\"w\">\n</span><span class=\"n\">suppressPackageStartupMessages</span><span class=\"p\">(</span><span class=\"n\">library</span><span class=\"p\">(</span><span class=\"n\">stringi</span><span class=\"p\">))</span><span class=\"w\">\n</span></code></pre> </div></div>\n\n<p>then deposit this to a directory on the search path and invoke,</p>\n\n<div class=\"language-bash highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>module load gcc/6\nphenoscanner <span class=\"nt\">-h</span>\n</code></pre> </div></div>\n","dir":"/applications/","name":"PhenoScanner.md","path":"applications/PhenoScanner.md","url":"/applications/PhenoScanner.html"},{"sort":27,"layout":"default","title":"R/PKI","content":"<h1 id=\"rpki\">R/PKI</h1>\n\n<p>When installing/updating the package, the following error message appears,</p>\n\n<div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>Error: package or namespace load failed for ‘PKI’ in dyn.load(file, DLLpath = DLLpath, ...):\n unable to load shared object '/rds/user/jhz22/hpc-work/R/00LOCK-PKI/00new/PKI/libs/PKI.so':\n  /rds/user/jhz22/hpc-work/R/00LOCK-PKI/00new/PKI/libs/PKI.so: undefined symbol: EVP_CIPHER_CTX_reset\nError: loading failed\nExecution halted\nERROR: loading failed\n</code></pre> </div></div>\n\n<p>and one can get around with a twist of openssl, e.g.,</p>\n\n<div class=\"language-bash highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>Rscript <span class=\"nt\">-e</span> <span class=\"s2\">\"download.packages('PKI','.')\"</span>\n<span class=\"nb\">tar </span>xvfz PKI_0.1-8.tar.gz\nmodule load openssl-1.1.0e-gcc-5.4.0-a4xxzqm\n<span class=\"nb\">cd </span>PKI\n./configure <span class=\"nv\">PKG_CPPFLAGS</span><span class=\"o\">=</span><span class=\"s2\">\"-I/usr/local/software/spack/spack-0.11.2/opt/spack/linux-rhel7-x86_64/gcc-5.4.0/openssl-1.1.0e-a4xxzqmcsb3o2o7yctmpxef3cp36qk33/include/openssl/\"</span> <span class=\"se\">\\</span>\n            <span class=\"nv\">PKG_LIBS</span><span class=\"o\">=</span><span class=\"s2\">\"-L/usr/local/software/spack/spack-0.11.2/opt/spack/linux-rhel7-x86_64/gcc-5.4.0/openssl-1.1.0e-a4xxzqmcsb3o2o7yctmpxef3cp36qk33/lib\"</span>\n<span class=\"c\"># with openssl-1.1.1h installed locally</span>\n<span class=\"c\"># ./configure PKG_CPPFLAGS=\"-I/rds-d4/user/jhz22/hpc-work/openssl-1.1.1h/include/openssl\" PKG_LIBS=\"-L/rds-d4/user/jhz22/hpc-work/openssl-1.1.1h\"</span>\n<span class=\"nb\">mv </span>configure configure.sav\n<span class=\"nb\">cd</span> -\nR CMD INSTALL PKI\n</code></pre> </div></div>\n","dir":"/applications/","name":"PKI.md","path":"applications/PKI.md","url":"/applications/PKI.html"},{"sort":28,"layout":"default","title":"R/plumber","content":"# R/plumber\n\n## Installation\n\nIt requires R/sodium which in turn requires `libsodium`, [https://doc.libsodium.org/](https://doc.libsodium.org/).\n\n```bash\nwget -qO- https://download.libsodium.org/libsodium/releases/libsodium-1.0.18.tar.gz | \\\ntar xvfz -\ncd libsodium-1.0.18\nconfigure --prefix=${HPC_WORK}\nmake\nmake install\n```\n\nFollowing this, we could issue `Rscript -e \"install.packages('plumber')\"`.\n\n## Example\n\nThis is adapted from [https://www.rplumber.io/](https://www.rplumber.io/).\n\nWe first create a file named [`plumber.R`](/applications/files/plumber.R) as follows,\n\n```r\n# plumber.R\n\n#* Echo back the input\n#* @param msg The message to echo\n#* @get /echo\nfunction(msg=\"\") {\n list(msg = paste0(\"The message is: '\", msg, \"'\"))\n}\n\n#* Plot a histogram\n#* @serializer png\n#* @get /plot\nfunction() {\n rand <- rnorm(100)\n hist(rand)\n}\n\n#* Return the sum of two numbers\n#* @param a The first number to add\n#* @param b The second number to add\n#* @post /sum\nfunction(a, b) {\n as.numeric(a) + as.numeric(b)\n}\n```\n\nWe could then start\n\n```r\nRscript -e \"library(plumber);pr('plumber.R') %>% pr_run(port=8000)\"\n```\n\nand GET and POST as follows,\n\n```bash\ncurl \"http://localhost:8000/echo\"\ncurl \"http://localhost:8000/echo?msg=hello\"\ncurl \"http://localhost:8000/plot\" | display # -o plot.png\ncurl --data \"a=4&b=3\" \"http://localhost:8000/sum\"\ncurl -H \"Content-Type: application/json\" --data '{\"a\":4, \"b\":5}' http://localhost:8000/sum\n```\n","dir":"/applications/","name":"plumber.md","path":"applications/plumber.md","url":"/applications/plumber.html"},{"sort":29,"layout":"default","title":"polyphen-2","content":"# polyphen-2\n\nOfficial page: [http://genetics.bwh.harvard.edu/pph2/dokuwiki/start](http://genetics.bwh.harvard.edu/pph2/dokuwiki/start).\n\nThe setup can be furnished as follows,\n\n```bash\ncd $HPC_WORK\nwget -qO- http://genetics.bwh.harvard.edu/pph2/dokuwiki/_media/polyphen-2.2.2r405c.tar.gz | tar xfz\nwget -qO- ftp://genetics.bwh.harvard.edu/pph2/bundled/polyphen-2.2.2-databases-2011_12.tar.bz2 | tar xjf\nwget -qO- ftp://genetics.bwh.harvard.edu/pph2/bundled/polyphen-2.2.2-alignments-mlc-2011_12.tar.bz2 | tar xjf\nwget -qO- ftp://genetics.bwh.harvard.edu/pph2/bundled/polyphen-2.2.2-alignments-multiz-2009_10.tar.bz2 | tar xjf\nls | sed 's/\\*//g' | parallel -C' ' 'ln -sf $HPC_WORK/polyphen-2.2.2/bin/{} $HPC_WORK/bin/{}'\ncd polyphen-2.2.2\n# set up BLAST/nrdb/PDB as decribed below\ncd src\nmake\nmake install\ncd -\nconfigure\ncd bin\nrsync -aP rsync://hgdownload.soe.ucsc.edu/genome/admin/exe/linux.x86_64/ ./\ncd -\n```\n\nThe MLC/MULTIZ databases need to be extracted to $HOME and symbolically linked if the number of files exceed 1 million\n(limit on RDS). Then these are necessary,\n\n```bash\ncd $HPC_WORK/polyphen-2.2.2\nln -s $HOME/polyphen-2.2.2/precompiled\ncd ucsc/hg19/multiz\nln -s $HOME/polyphen-2.2.2/ucsc/hg19/multiz/precomputed\n```\n\nThe availability of MLC/MULTIZ databases make the annotation considerably faster.\n\nThe command `configure` creates files at config/ which can be changed maunaually. There is also\n[user's guide](http://genetics.bwh.harvard.edu/pph2/dokuwiki/_media/hg0720.pdf). The line `rsync` obtains\nprograms such as `twoBitToFa` as required by the example below.\n\nBLAST and nrdb can be set up as follows,\n\n```bash\nrmdir blast\nln -sf /usr/local/Cluster-Apps/blast/2.4.0 blast\ncd nrdb\nwget -qO- ftp://ftp.uniprot.org/pub/databases/uniprot/current_release/uniref/uniref100/uniref100.fasta.gz | \\\ngunzip -c > uniref100.fasta\n../update/format_defline.pl uniref100.fasta >uniref100-formatted.fasta\n../blast/bin/makeblastdb -in uniref100-formatted.fasta -dbtype prot -out uniref100 -parse_seqids\nrm -f uniref100.fasta uniref100-formatted.fasta\n```\n\nand for PDB\n\n```bash\nrsync -rltv --delete-after --port=33444 \\\n rsync.wwpdb.org::ftp/data/structures/divided/pdb/ wwpdb/divided/pdb/\nrsync -rltv --delete-after --port=33444 \\\n rsync.wwpdb.org::ftp/data/structures/all/pdb/ wwpdb/all/pdb/\n```\n\nOur test is then,\n\n```bash\ncd $HPC_WORK/polyphen-2.2.2\nrun_pph.pl sets/test.input 1>test.pph.output 2>test.pph.log\nrun_weka.pl test.pph.output >test.humdiv.output\nrun_weka.pl -l models/HumVar.UniRef100.NBd.f11.model test.pph.output >test.humvar.output\n\nsdiff test.humdiv.output sets/test.humdiv.output\nsdiff test.humvar.output sets/test.humvar.output\n```\n\nNow we turn to an genomic SNPs query examples with snps.pph.list containing the following line,\n\n> chr1:154426970 A/C\n\nto be called by `mapsnps.pl` and others.\n\n```bash\nmapsnps.pl -g hg19 -m -U -y snps.pph.input snps.pph.list 1>snps.pph.features 2>snps.log\nrun_pph.pl snps.pph.input 1>snps.pph.output 2>snps.pph.log\nrun_weka.pl snps.pph.output >snps.humdiv.output\nrun_weka.pl -l models/HumVar.UniRef100.NBd.f11.model snps.pph.output >snps.humvar.output\n```\n\nfor [.pph.input](/applications/files/snps.pph.input), [.pph.features](/applications/files/snps.pph.features), [.pph.output](/applications/files/snps.pph.output), [.humvar.output](/applications/files/snps.humvar.output) and [.humdiv.output](/applications/files/snps.humdiv.output).\n","dir":"/applications/","name":"polyphen-2.md","path":"applications/polyphen-2.md","url":"/applications/polyphen-2.html"},{"sort":30,"layout":"default","title":"poppler","content":"# poppler\n\nOfficial page: [https://poppler.freedesktop.org/](https://poppler.freedesktop.org/).\n\nWe work on the latest version, 0.84.0.\n\n```bash\nmodule load xz/5.2.2\nwget https://poppler.freedesktop.org/poppler-0.84.0.tar.xz\ntar xf poppler-0.84.0.tar.xz\ncd poppler-0.84.0\nmkdir build\ncd build\nmodule load gcc/5\nmodule load openjpeg-2.1-gcc-5.4.0-myd2p3o\ncmake ..\nmake\nmake install\n```\n\nNote it is necessary to change prefix, cc and c++ to gcc and g++ in line with gcc/5, e.g.,\n\n```\nCMAKE_INSTALL_PREFIX:PATH=/rds/user/$USER/hpc-work\nCMAKE_C_COMPILER:FILEPATH=/usr/local/software/master/gcc/5/bin/gcc\nCMAKE_CXX_COMPILER:FILEPATH=/usr/local/software/master/gcc/5/bin/g++\n```\n\nwhich could be done by editing CMakeCache.txt and/or calling `ccmake .`. After these we have\nthe followihg utilities:\npdfattach, pdfdetach, pdffonts, pdfimages, pdfinfo, pdfseparate, pdftocairo, pdftohtml, pdftoppm, pdftops, pdftotext, pdfunite,\nand following libraries: libpoppler.so, libpoppler-cpp.so, libpoppler-glibc.so, libpoppler-qt5.so.\n\nNote that `poppler-cpp.pc` is installed at `hpc-work/lib64/pkgconfig` and preferably in the search path with\n\n```bash\nexport PKG_CONFIG_PATH=$HPC_WORK/lib/pkgconfig:$HPC_WORK/lib64/pkgconfig:$PKG_CONFIG_PATH\n```\n\nafter which we could install R/pdftools from CRAN.\n\nNote also the packages `R/Rpoppler` and `qpdf` from CRAN.\n","dir":"/applications/","name":"poppler.md","path":"applications/poppler.md","url":"/applications/poppler.html"},{"sort":31,"layout":"default","title":"R/protolite","content":"# R/protolite\n\nWe may see this message,\n\n```\nError: package or namespace load failed for ‘protolite’ in dyn.load(file, DLLpath = DLLpath, ...):\n unable to load shared object '/rds/user/jhz22/hpc-work/R/00LOCK-protolite/00new/protolite/libs/protolite.so':\n /rds/user/jhz22/hpc-work/R/00LOCK-protolite/00new/protolite/libs/protolite.so: undefined symbol: _ZNK6google8protobuf11MessageLite25InitializationErrorStringB5cxx11Ev\nError: loading failed\nExecution halted\nERROR: loading failed\n```\n\nThis can be furnished with\n\n```bash\nmodule load protobuf-3.4.0-gcc-5.4.0-zkpendv\n```\n\nand try again.\n","dir":"/applications/","name":"protolite.md","path":"applications/protolite.md","url":"/applications/protolite.html"},{"sort":32,"layout":"default","title":"PRSice","content":"<h1 id=\"prsice\">PRSice</h1>\n\n<p>Web page: https://github.com/choishingwan/PRSice and http://www.prsice.info/.</p>\n\n<div class=\"language-bash highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"nb\">cd</span> <span class=\"nv\">$HPC_WORK</span>\ngit clone https://github.com/choishingwan/PRSice\n<span class=\"nb\">cd </span>PRSice\n<span class=\"nb\">mkdir </span>build\n<span class=\"nb\">cd </span>build\nmodule load cmake/3.9\ncmake ..\nmake\n<span class=\"nb\">ln</span> <span class=\"nt\">-sf</span> <span class=\"nv\">$HPC_WORK</span>/PRSice/bin/PRSice <span class=\"nv\">$HPC_WORK</span>/bin/PRSice\nwget https://github.com/choishingwan/PRS-Tutorial/raw/master/resources/GIANT.height.gz\nwget <span class=\"nt\">-qO-</span> https://github.com/choishingwan/PRS-Tutorial/raw/master/resources/EUR.zip | jar xv\n</code></pre> </div></div>\n\n<p>The last two commands download/unpack the documentation example, which is described here, https://choishingwan.github.io/PRS-Tutorial/, whose scripts are partly extracted <a href=\"/applications/files/pgs.sh\">here</a>.</p>\n","dir":"/applications/","name":"PRSice.md","path":"applications/PRSice.md","url":"/applications/PRSice.html"},{"sort":33,"layout":"default","title":"PRSoS","content":"<h1 id=\"prsos\">PRSoS</h1>\n\n<p>Web page: https://github.com/MeaneyLab/PRSoS.</p>\n\n<div class=\"language-bash highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>git clone https://github.com/MeaneyLab/PRSoS.git\n<span class=\"nb\">cd </span>PRSoS\npip <span class=\"nb\">install</span> –r requirements.txt\n~/.local/bin/spark-submit <span class=\"nt\">--master</span> <span class=\"nb\">local</span><span class=\"o\">[</span><span class=\"k\">*</span><span class=\"o\">]</span> PRSoS.py examples/example.vcf examples/gwasfile.txt test_output\n</code></pre> </div></div>\n","dir":"/applications/","name":"PRSoS.md","path":"applications/PRSoS.md","url":"/applications/PRSoS.html"},{"sort":34,"layout":"default","title":"pspp","content":"# pspp\n\nOfficial page: [https://www.gnu.org/software/pspp/](https://www.gnu.org/software/pspp/).\n\n```bash\nmodule load pspp/1.2.0\npspp example.sps\n```\n\nwhere [example.sps](/applications/files/example.sps) is the documentation example. Nevertheless `psppire` is not yet functioning.\n\nHowever, it is possible to compile it directly by using\n\n- gtksourceview 4.0.3 (4.4.0 is more demanding with Python 3.5, meson, Vala, etc.) and use PKG_CONFIG_PATH when appropriate\n- spread-sheet-widget-0.3\n- fribidi-1.0.8\n- GTKSOURVIEW_CFLAGS and GTKSOURVIEW_LIBS in the configuration.\n\n```bash\nexport PREFIX=/rds/user/$USER/hpc-work\nexport GTKSOURCEVIEW_CFLAGS=-I${PREFIX}/include/gtksourceview-4\nexport GTKSOURCEVIEW_LIBS=\"-L${PREFIX}/lib -lgtksourceview-4\"\n./configure --prefix=${PREFIX}\nmake\nmake install\n```\n\nnote that it is necessary to comment on the statement `kludge = gtk_source_view_get_type ();` from `src/ui/gui/widgets.c`\nand to remove the `PREFIX=` specification in the Perl part of compiling, i.e,\n\n```\ncd perl-module\n/usr/bin/perl Makefile.PL PREFIX=/rds/user/$USER/hpc-work OPTIMIZE=\"-g -O2 -I/rds-d4/user/$USER/hpc-work/include/fribidi -I/usr/include/cairo -I/usr/include/glib-2.0 -I/usr/lib64/glib-2.0/include -I/usr/include/pixman-1 -I/usr/include/freetype2 -I/usr/include/libpng15 -I/usr/include/uuid -I/usr/include/libdrm -I/usr/include/pango-1.0 -I/usr/include/harfbuzz \"\n```\n\nNow we can execute [plot.sps](/applications/files/plot.sps)\n\n```bash\npsppire plot.ps &\n```\n\nMore documentation examples are in the [examples](files/examples) directory.\n\nVersion 1.4.1 requires spread-sheet-widget 0.6 and we follow the following steps,\n\n```bash\nwget http://alpha.gnu.org/gnu/ssw/spread-sheet-widget-0.7.tar.gz\ntar xvfz spread-sheet-widget-0.7.tar.gz\ncd spread-sheet-widget-0.7\n./configure --prefix=$HPC_WORK\nmake\nmake install\nexport PREFIX=/rds/user/$USER/hpc-work\nexport GTKSOURCEVIEW_CFLAGS=-I${PREFIX}/include/gtksourceview-4\nexport GTKSOURCEVIEW_LIBS=\"-L${PREFIX}/lib -lgtksourceview-4\"\nwget http://mirror.lyrahosting.com/gnu/pspp/pspp-1.4.1.tar.gz\ntar xvfz pspp-1.4.1.tar.gz\ncd pspp-1.4.1\n./configure --prefix=${PREFIX}\n```\n\nAgain we removed PREFIX= in call to perl-module/Makefile.PL.\n\nFinally, the LD = flag was not set in perl-module/Makefile and we use LD = 'gcc'.\n\n---\n\nThe package seems really attractive with its support for over 1 billion cases and 1 billion variables, while giving the appeal of data visualisation in SPSS. The following is an example code generated by the package to read/list GREAT annotation.\n\n```pspp\nGET DATA\n /TYPE=TXT\n /FILE=\"IL12B-all.tsv\"\n /ARRANGEMENT=DELIMITED\n /DELCASE=LINE\n /FIRSTCASE=2\n /DELIMITERS=\"\\t\"\n /VARIABLES=\n Ontology A21\n ID A10\n Desc A158\n BinomRank F3.0\n BinomP F12.7\n BinomBonfP F9.0\n BinomFdrQ F10.2\n RegionFoldEnrich F9.5\n ExpRegions F12.7\n ObsRegions F1.0\n GenomeFrac F12.8\n SetCov F5.2\n HyperRank F3.0\n HyperP F12.7\n HyperBonfP F9.0\n HyperFdrQ F9.2\n GeneFoldEnrich F9.5\n ExpGenes F12.7\n ObsGenes F2.0\n TotalGenes F5.0\n GeneSetCov F6.3\n TermCov F12.7\n Regions A193\n Genes A98.\nVARIABLE LEVEL Ontology (SCALE).\nVARIABLE ALIGNMENT Ontology (RIGHT).\nVARIABLE WIDTH Ontology (8).\nVARIABLE LEVEL ID (SCALE).\nVARIABLE ALIGNMENT ID (RIGHT).\nVARIABLE WIDTH ID (8).\nVARIABLE LEVEL Desc (SCALE).\nVARIABLE ALIGNMENT Desc (RIGHT).\nVARIABLE WIDTH Desc (8).\nVARIABLE LEVEL Regions (SCALE).\nVARIABLE ALIGNMENT Regions (RIGHT).\nVARIABLE WIDTH Regions (8).\nVARIABLE LEVEL Genes (SCALE).\nVARIABLE ALIGNMENT Genes (RIGHT).\nVARIABLE WIDTH Genes (8).\nlist.\n```\n","dir":"/applications/","name":"pspp.md","path":"applications/pspp.md","url":"/applications/pspp.html"},{"sort":35,"layout":"default","title":"qpdf","content":"# qpdf\n\nWeb page: https://sourceforge.net/projects/qpdf/.\n\n```bash\ncd $HPC_WORK\nwget -qO- https://sourceforge.net/projects/qpdf/files/qpdf/9.1.0/qpdf-9.1.0.tar.gz | \\\ntar xvfz -\ncd qpdf-9.1.0\n./configure --prefix=$HPC_WORK\nmake\nmake install\n```\n","dir":"/applications/","name":"qpdf.md","path":"applications/qpdf.md","url":"/applications/qpdf.html"},{"sort":36,"layout":"default","title":"regenie","content":"# regenie\n\nWeb: [https://github.com/rgcgithub/regenie](https://github.com/rgcgithub/regenie) ([documentation](https://rgcgithub.github.io/regenie/))\n\nIt is the easiest to use the Centos 7 distribution,\n\n```bash\nwget -qO- https://github.com/rgcgithub/regenie/releases/download/v2.0.1-newest/regenie_v2.0.2.gz_x86_64_Centos7_mkl.zip | \\\ngunzip -c > regenie_v2.0.2\nchmod +x regenie_v2.0.2\nregenie_v2.0.2 --help\n```\n\nThe last command gives the following information (Why .gz in the banner?),\n\n```\n |=============================|\n | REGENIE v2.0.2.gz |\n |=============================|\n\nCopyright (c) 2020-2021 Joelle Mbatchou, Andrey Ziyatdinov and Jonathan Marchini.\nDistributed under the MIT License.\nCompiled with Boost Iostream library.\nUsing Intel MKL with Eigen.\n\n\nUsage:\n regenie_v2.0.2 [OPTION...]\n\n -h, --help print list of available options\n --helpFull print list of all available options\n\n Main options:\n --step INT specify if fitting null model (=1) or\n association testing (=2)\n --bed PREFIX prefix to PLINK .bed/.bim/.fam files\n --pgen PREFIX prefix to PLINK2 .pgen/.pvar/.psam files\n --bgen FILE BGEN file\n --sample FILE sample file corresponding to BGEN file\n --ref-first use the first allele as the reference for\n BGEN or PLINK bed/bim/fam input format [default\n assumes reference is last]\n --keep FILE file listing samples to retain in the\n analysis (no header; starts with FID IID)\n --remove FILE file listing samples to remove from the\n analysis (no header; starts with FID IID)\n --extract FILE file with IDs of variants to retain in the\n analysis\n --exclude FILE file with IDs of variants to remove from the\n analysis\n -p, --phenoFile FILE phenotype file (header required starting with\n FID IID)\n --phenoCol STRING phenotype name in header (use for each\n phenotype to keep; can use parameter expansion\n {i:j})\n --phenoColList STRING,..,STRING\n comma separated list of phenotype names to\n keep (can use parameter expansion {i:j})\n -c, --covarFile FILE covariate file (header required starting with\n FID IID)\n --covarCol STRING covariate name in header (use for each\n covariate to keep; can use parameter expansion\n {i:j})\n --covarColList STRING,..,STRING\n comma separated list of covariate names to\n keep (can use parameter expansion {i:j})\n --catCovarList STRING,..,STRING\n comma separated list of categorical\n covariates\n -o, --out PREFIX prefix for output files\n --bt analyze phenotypes as binary\n -1, --cc12 use control=1,case=2,missing=NA encoding for\n binary traits\n -b, --bsize INT size of genotype blocks\n --cv INT(=5) number of cross validation (CV) folds\n --loocv use leave-one out cross validation (LOOCV)\n --l0 INT(=5) number of ridge parameters to use when\n fitting models within blocks [evenly spaced in\n (0,1)]\n --l1 INT(=5) number of ridge parameters to use when\n fitting model across blocks [evenly spaced in (0,1)]\n --lowmem reduce memory usage by writing level 0\n predictions to temporary files\n --lowmem-prefix PREFIX prefix where to write the temporary files in\n step 1 (default is to use prefix from --out)\n --split-l0 PREFIX,N split level 0 across N jobs and set prefix of\n output files\n --run-l0 FILE,K run level 0 for job K in {1..N} using master\n file created from '--split-l0'\n --run-l1 FILE run level 1 using master file from\n '--split-l0'\n --keep-l0 avoid deleting the level 0 predictions\n written on disk after fitting the level 1 models\n --strict remove all samples with missingness at any of\n the traits\n --print-prs also output polygenic predictions without\n using LOCO (=whole genome PRS)\n --gz compress output files (gzip format)\n --threads INT number of threads\n --pred FILE file containing the list of predictions files\n from step 1\n --ignore-pred skip reading predictions from step 1\n (equivalent to linear/logistic regression with only\n covariates)\n --use-prs when using whole genome PRS step 1 output in\n '--pred'\n --write-samples write IDs of samples included for each trait\n (only in step 2)\n --minMAC FLOAT(=5) minimum minor allele count (MAC) for tested\n variants\n --minINFO DOUBLE(=0) minimum imputation info score (Impute/Mach\n R^2) for tested variants\n --split split asssociation results into separate\n files for each trait\n --firth use Firth correction for p-values less than\n threshold\n --approx use approximation to Firth correction for\n computational speedup\n --spa use Saddlepoint approximation (SPA) for\n p-values less than threshold\n --pThresh FLOAT(=0.05) P-value threshold below which to apply\n Firth/SPA correction\n --chr STRING specify chromosome to test in step 2 (use for\n each chromosome)\n --chrList STRING,..,STRING\n Comma separated list of chromosomes to test\n in step 2\n --range CHR:MINPOS-MAXPOS\n to specify a physical position window for\n variants to test in step 2\n --test STRING 'dominant' or 'recessive' (default is\n additive test)\n --interaction STRING perform interaction testing with a\n quantitative/categorical covariate\n --hc4-mac FLOAT(=100) minor allele count (MAC) threshold below\n which to use robust SE with HC4 instead of HC3 for\n interaction testing\n --set-list FILE file with sets definition\n --extract-sets FILE file with IDs of sets to retain in the\n analysis\n --exclude-sets FILE file with IDs of sets to remove from the\n analysis\n --extract-setlist FILE comma separated list of sets to retain in the\n analysis\n --exclude-setlist FILE comma separated list of sets to remove from\n the analysis\n --anno-file FILE file with variant annotations\n --anno-labels FILE file with labels to annotations\n --mask-def FILE file with mask definitions\n --aaf-file FILE file with AAF to use when building masks\n --aaf-bins FLOAT,..,FLOAT\n comma separated list of AAF bins cutoffs for\n building masks\n --build-mask STRING rule to construct masks, can be 'max', 'sum'\n or 'comphet' (default is max)\n --singleton-carrier define singletons as variants with a single\n carrier in the sample\n --write-mask write masks in PLINK bed/bim/fam format\n --mask-lovo STRING apply Leave-One-Variant-Out (LOVO) scheme\n when building masks\n (<set_name>,<mask_name>,<aaf_cutoff>)\n --mask-lodo STRING apply Leave-One-Domain-Out (LODO) scheme when\n building masks\n (<set_name>,<mask_name>,<aaf_cutoff>)\n --skip-test skip computing association tests after\n building masks\n --check-burden-files check annotation file, set list file and mask\n file for consistency\n --strict-check-burden to exit early if the annotation, set list and\n mask definition files dont agree\n\nFor more information, use option '--help' or visit the website: https://rgcgithub.github.io/regenie/\n\n```\n\n## Reference\n\nMbatchou, J., et al. (2020). \"Computationally efficient whole genome regression for quantitative and binary traits.\" bioRxiv: 2020.2006.2019.162354.\nhttps://www.biorxiv.org/content/10.1101/2020.06.19.162354v1\n","dir":"/applications/","name":"regenie.md","path":"applications/regenie.md","url":"/applications/regenie.html"},{"sort":37,"layout":"default","title":"R/rgdal","content":"# R/rgdal\n\nWe have .R/Makevars as follows,\n\n```bash\nCC=gcc\nCXX=g++ -std=gnu++11\nPKG_CXXFLAGS= -std=c++11\nCFLAGS = -std=c99 -I/usr/include -g -O2 -Wall -pedantic -mtune=native -Wno-ignored-attributes -Wno-deprecated-declarations -Wno-parentheses -Wimplicit-function-declaration\nCXXFLAGS = -std=c++11\n```\n\nthe proceed with\n\n```bash\nmodule load gcc/5\nmodule load geos-3.6.2-gcc-5.4.0-vejexvy\nmodule load gdal-2.3.1-gcc-5.4.0-m7j7nw6\nmodule load proj-5.0.1-gcc-5.4.0-cpqxtzr\nRscript -e \"install.packages('sf')\"\n# R 3.6.3 also requires\nmodule load json-c-0.13.1-gcc-5.4.0-ffamohj\nmodule load libgeotiff-1.4.2-gcc-5.4.0-2emzhxh\nmodule load libpng-1.6.29-gcc-5.4.0-3qwhidp\nmodule load cfitsio-3.450-gcc-5.4.0-colpo6h\nmodule load zlib/1.2.11\nmodule load mpich-3.2-gcc-5.4.0-idlluti\nRscript -e \"install.packages('rgdal')\"\n```\n\nUnder R 3.6.3, there are complaints about `-std=c++11` when installing `sf` but can be dealt with it first (as described in its own section).\n\nFinally, gdal could also be installed with proj 6 available,\n\n```bash\nmodule load geos-3.6.2-gcc-5.4.0-vejexvy\n./configure --with-proj=$HPC_WORK --without-sqlite3 --prefix=$HPC_WORK\n```\n\nThen `proj_api.h` should have a statement\n\n```c\n#define ACCEPT_USE_OF_DEPRECATED_PROJ_API_H 1\n```\n","dir":"/applications/","name":"rgdal.md","path":"applications/rgdal.md","url":"/applications/rgdal.html"},{"sort":38,"layout":"default","title":"R/rgeos","content":"# R/rgeos\n\nThis requires geos to be loaded,\n\n```bash\nmodule load geos-3.6.2-gcc-5.4.0-vejexvy\n```\n","dir":"/applications/","name":"rgeos.md","path":"applications/rgeos.md","url":"/applications/rgeos.html"},{"sort":39,"layout":"default","title":"R/Rhdf5lib","content":"<h1 id=\"rrhdf5lib\">R/Rhdf5lib</h1>\n\n<p>This is useful for hdf5 file handling, but BiocManager::install() gives error <code class=\"language-plaintext highlighter-rouge\">cp: cannot stat ‘hdf5/c++/src/.libs/libhdf5_cpp.a’: No such file or directory </code> so we proceed manually,</p>\n\n<div class=\"language-bash highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>module load gcc/6\n<span class=\"nb\">cd</span> <span class=\"nv\">$HOME</span>\nwget https://bioconductor.org/packages/3.11/bioc/src/contrib/Rhdf5lib_1.10.1.tar.gz\n<span class=\"nb\">tar </span>xfz Rhdf5lib_1.10.1.tar.gz\n<span class=\"nb\">cd </span>Rhdf5lib\n./configure\n<span class=\"nb\">mv </span>configure configure.sav\n<span class=\"nb\">cd </span>src\n<span class=\"nb\">tar </span>xfz hdf5small_cxx_hl_1.10.6.tar.gz\n<span class=\"nb\">cd </span>hdf5\n./configure <span class=\"nt\">--prefix</span><span class=\"o\">=</span><span class=\"nv\">$HPC_WORK</span> <span class=\"nt\">--enable-build-all</span> <span class=\"nt\">--enable-cxx</span> <span class=\"nv\">CFLAGS</span><span class=\"o\">=</span><span class=\"nt\">-fPIC</span>\nmake\nmake <span class=\"nb\">install\nmv </span>configure configure.sav\n<span class=\"nb\">cd</span> <span class=\"nv\">$HOME</span>\nR CMD INSTALL Rhdf5lib\n</code></pre> </div></div>\n","dir":"/applications/","name":"Rhdf5lib.md","path":"applications/Rhdf5lib.md","url":"/applications/Rhdf5lib.html"},{"sort":40,"layout":"default","title":"R/rjags","content":"# R/rjags\n\nWeb page: [https://sourceforge.net/projects/mcmc-jags/files/rjags/](https://sourceforge.net/projects/mcmc-jags/files/rjags/).\n\nIt is known for sometime for its difficulty to install; here is what was done\n\n```bash\n\n# Cardio\nexport PKG_CONFIG_PATH=/scratch/$USER/lib/pkgconfig\n\nR CMD INSTALL rjags_4-6.tar.gz --configure-args='CPPFLAGS=\"-fPIC\" LDFLAGS=\"-L/scratch/$USER/lib -ljags\"\n--with-jags-prefix=/scratch/$USER\n--with-jags-libdir=/scratch/$USER/lib\n--with-jags-includedir=/scratch/$USER/include'\n\n# csd3\nexport hpcwork=/rds-d4/user/$USER/hpc-work\nexport PKG_CONFIG_PATH=${hpcwork}/lib/pkgconfig\n\nwget https://cran.r-project.org/src/contrib/rjags_4-10.tar.gz\nR CMD INSTALL rjags_4-10.tar.gz --configure-args='CPPFLAGS=\"-fPIC\" LDFLAGS=\"-L${hpcwork}/lib -ljags\"\n--with-jags-prefix=${hpcwork}\n--with-jags-libdir=${hpcwork}/lib\n--with-jags-includedir=${hpcwork}/include'\n```\n\nAs is with the module `jags-4.3.0-gcc-5.4.0-4z5shby`, we would see this error message from R 4.1.0,\n\n```\n** testing if installed package can be loaded from temporary location\nError: package or namespace load failed for ‘rjags’:\n .onLoad failed in loadNamespace() for 'rjags', details:\n call: dyn.load(file, DLLpath = DLLpath, ...)\n error: unable to load shared object '/rds/user/jhz22/hpc-work/R/00LOCK-rjags/00new/rjags/libs/rjags.so':\n /rds/user/jhz22/hpc-work/R/00LOCK-rjags/00new/rjags/libs/rjags.so: undefined symbol: _ZN4jags7Console10setRNGnameERKNSt7__cxx1112basic_stringIcSt11char_t$\nError: loading failed\nExecution halted\nERROR: loading failed\n```\n\nthen this is due to different versions of compilers were used to build JAGS and rjags, so the former needs to be rebuilt.\n","dir":"/applications/","name":"rjags.md","path":"applications/rjags.md","url":"/applications/rjags.html"},{"sort":41,"layout":"default","title":"R/rJava","content":"# R/rJava\n\nOne may see the messages\n\n```\n...\nchecking whether JNI programs can be compiled... configure: error: Cannot compile a simple JNI program. See config.log for details.\n...\nERROR: configuration failed for package ‘rJava’\n```\n\nso quit R and run\n\n```bash\nR CMD javareconf\nRscript -e 'install.packages(\"rJava\")'\n```\n","dir":"/applications/","name":"rJava.md","path":"applications/rJava.md","url":"/applications/rJava.html"},{"sort":42,"layout":"default","title":"R","content":"<h1 id=\"r\">R</h1>\n\n<p>To compile all the PDF documentations, load texlive.</p>\n\n<div class=\"language-bash highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>module load gcc/6\nmodule load pcre/8.38\nmodule load texlive\nwget https://cran.r-project.org/src/base/R-4/R-4.0.0.tar.gz\n<span class=\"nb\">tar </span>xvfz R-4.0.0.tar.gz\n<span class=\"nb\">cd </span>R-4.0.0\n<span class=\"nb\">export </span><span class=\"nv\">prefix</span><span class=\"o\">=</span>/rds-d4/user/<span class=\"nv\">$USER</span>/hpc-work\n./configure <span class=\"nt\">--prefix</span><span class=\"o\">=</span><span class=\"k\">${</span><span class=\"nv\">prefix</span><span class=\"k\">}</span> <span class=\"se\">\\</span>\n            <span class=\"nt\">--with-pcre1</span> <span class=\"se\">\\</span>\n            <span class=\"nt\">--enable-R-shlib</span> <span class=\"nv\">CPPFLAGS</span><span class=\"o\">=</span><span class=\"nt\">-I</span><span class=\"k\">${</span><span class=\"nv\">prefix</span><span class=\"k\">}</span>/include <span class=\"nv\">LDFLAGS</span><span class=\"o\">=</span><span class=\"nt\">-L</span><span class=\"k\">${</span><span class=\"nv\">prefix</span><span class=\"k\">}</span>/lib\nmake\nmake <span class=\"nb\">install</span>\n</code></pre> </div></div>\n\n<p>With this setup, <code class=\"language-plaintext highlighter-rouge\">R CMD check --as-cran</code> for a CRAN package check can be run smoothly.</p>\n\n<p>Package reinstallation could be done with <code class=\"language-plaintext highlighter-rouge\">update.packages(checkBuilt = TRUE, ask = FALSE)</code>.</p>\n\n<p>It may complain about libiconv.so.2,</p>\n\n<blockquote>\n <p>… R: error while loading shared libraries: libiconv.so.2: cannot open shared object file: No such file or directory</p>\n</blockquote>\n\n<p>which can be installed as follows,</p>\n\n<div class=\"language-bash highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>wget <span class=\"nt\">-qO-</span> https://ftp.gnu.org/pub/gnu/libiconv/libiconv-1.16.tar.gz | <span class=\"nb\">tar </span>xvfz -\n<span class=\"nb\">cd </span>libiconv-1.16\n./configure <span class=\"nt\">--prefix</span><span class=\"o\">=</span><span class=\"k\">${</span><span class=\"nv\">HPC_WORK</span><span class=\"k\">}</span>\nmake\nmake <span class=\"nb\">install</span>\n</code></pre> </div></div>\n","dir":"/applications/","name":"R.md","path":"applications/R.md","url":"/applications/R.html"},{"sort":43,"layout":"default","title":"R/rstan","content":"# R/rstan\n\nOfficial page: [https://mc-stan.org/users/interfaces/rstan](https://mc-stan.org/users/interfaces/rstan) and also [https://cran.r-project.org/package=rstan](https://cran.r-project.org/package=rstan).\n\nIt is necessary to have `¬/.R/Makevars` the following lines,\n\n```\nCXX14 = g++ -fPIC -std=gnu++11 -fext-numeric-literals\n```\n\nto deal with `error: unable to find numeric literal operator 'operator\"\"Q'` but\n\n```\nCXX14 = g++ -std=c++1y -fPIC\n```\n\nto do away with the error message ``C++14 standard requested but CXX14 is not defined`.\n\nIn case `ggplot2` installed with `gcc 5.2.0` it is also necessary to preceed with `module load gcc/5`.\n\nFor the developmental version, try `remotes::install_github(\"stan-dev/rstan\", ref = \"develop\", subdir = \"rstan/rstan\")`.\n","dir":"/applications/","name":"rstan.md","path":"applications/rstan.md","url":"/applications/rstan.html"},{"sort":44,"layout":"default","title":"RStudio","content":"<h1 id=\"rstudio\">RStudio</h1>\n\n<p>Web: <a href=\"https://www.rstudio.com/\">https://www.rstudio.com/</a></p>\n\n<h2 id=\"csd3-modules\">CSD3 modules</h2>\n\n<p>We first check its availability,</p>\n\n<div class=\"language-bash highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>module avail rstudio\n</code></pre> </div></div>\n\n<p>and it obtains</p>\n\n<div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>---------------------------------------------------------- /usr/local/Cluster-Config/modulefiles -----------------------------------------------------------\nrstudio/0.99/rstudio-0.99 rstudio/1.1.383           rstudio/1.3.1093\n</code></pre> </div></div>\n\n<p>We intend to use the most recent version with <code class=\"language-plaintext highlighter-rouge\">module load rstudio/1.3.1093; rstudio</code> but it fails with messages:</p>\n\n<div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>qt.qpa.plugin: Could not load the Qt platform plugin \"xcb\" in \"\" even though it was found.\nThis application failed to start because no Qt platform plugin could be initialized. Reinstalling the application may fix this problem.\n\nAvailable platform plugins are: eglfs, linuxfb, minimal, minimalegl, offscreen, vnc, wayland-egl, wayland, wayland-xcomposite-egl, wayland-xcomposite-glx, xcb.\n\nAborted\n</code></pre> </div></div>\n\n<p>Additional information could also be seen from <code class=\"language-plaintext highlighter-rouge\">export QT_DEBUG_PLUGINS=1</code> and run <code class=\"language-plaintext highlighter-rouge\">rstudio</code> again.</p>\n\n<p>The error messages above can be bypassed with</p>\n\n<div class=\"language-bash highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"nb\">export </span><span class=\"nv\">QT_PLUGIN_PATH</span><span class=\"o\">=</span>/usr/lib64/qt5/plugins\nmodule load rstudio/1.3.1093\nrstudio &amp;\n</code></pre> </div></div>\n\n<h2 id=\"rstudio-14\">RStudio 1.4</h2>\n\n<p>This is also the latest version</p>\n\n<div class=\"language-bash highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>wget <span class=\"nt\">-qO-</span> https://download1.rstudio.org/desktop/xenial/amd64/rstudio-1.4.1106-amd64-debian.tar.gz | <span class=\"nb\">tar </span>xfz -\n<span class=\"nb\">cd </span>rstudio-1.4\nbin/rstudio\n</code></pre> </div></div>\n\n<p>However it requires openssl.so.1.0.0, which in turn requires specific installation to get away with <code class=\"language-plaintext highlighter-rouge\">No version informaiton for openssl.so.1.0.0</code>, with <code class=\"language-plaintext highlighter-rouge\">openssl.ld</code>, according to https://stackoverflow.com/questions/18390833/no-version-information-available, as follows</p>\n\n<div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>OPENSSL_1.0.0 {\n    global:\n    *;\n};\n</code></pre> </div></div>\n\n<p>and</p>\n\n<div class=\"language-bash highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>wget <span class=\"nt\">-qO-</span> https://www.openssl.org/source/old/1.0.0/openssl-1.0.0s.tar.gz | <span class=\"nb\">tar </span>xfz -\n<span class=\"nb\">cd </span>openssl-1.0.0s\n./config <span class=\"nt\">--prefix</span><span class=\"o\">=</span><span class=\"k\">${</span><span class=\"nv\">HPC_WORK</span><span class=\"k\">}</span> shared <span class=\"nt\">-Wl</span>,--version-script<span class=\"o\">=</span><span class=\"k\">${</span><span class=\"nv\">HPC_WORK</span><span class=\"k\">}</span>/openssl-1.0.0s/openssl.ld\nmake\nmake <span class=\"nb\">install</span>\n</code></pre> </div></div>\n\n<p>We can proceed after setting <code class=\"language-plaintext highlighter-rouge\">export QT_PLUGIN_PATH=/usr/lib64/qt5/plugins</code> as above. It is certainly more desirable to do this only once, as follows,</p>\n\n<div class=\"language-bash highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"nb\">echo</span> <span class=\"s2\">\"export QT_PLUGIN_PATH=/usr/lib64/qt5/plugins\"</span> <span class=\"o\">&gt;&gt;</span> ~/.bashrc\n</code></pre> </div></div>\n\n<p>and invoke with <code class=\"language-plaintext highlighter-rouge\">source ~/.bashrc</code> from current session or automatically from the next onwards.</p>\n\n<h2 id=\"qt5\">qt/5</h2>\n\n<p>These are side notes on installation of Qt5 according to https://forums.linuxmint.com/viewtopic.php?t=306738, but no longer necessary for reasons above.</p>\n\n<div class=\"language-bash highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>git clone git://code.qt.io/qt/qt5.git\n<span class=\"nb\">cd </span>qt5\ngit checkout 5.12\n./init-repository\n<span class=\"nb\">export </span><span class=\"nv\">LLVM_INSTALL_DIR</span><span class=\"o\">=</span><span class=\"k\">${</span><span class=\"nv\">HPC_WORK</span><span class=\"k\">}</span>/llvm\n../qt5/configure <span class=\"nt\">-developer-build</span> <span class=\"nt\">-opensource</span> <span class=\"nt\">-nomake</span> examples <span class=\"nt\">-nomake</span> tests\nmake\n</code></pre> </div></div>\n","dir":"/applications/","name":"RStudio.md","path":"applications/RStudio.md","url":"/applications/RStudio.html"},{"sort":45,"layout":"default","title":"R/SAIGE 0.36.6 and 0.39.2","content":"<h1 id=\"rsaige-0366-and-0392\">R/SAIGE 0.36.6 and 0.39.2</h1>\n\n<p>Full name: Scalable and Accurate Implementation of GEneralized mixed model (SAIGE)</p>\n\n<p>GitHub page: <a href=\"https://github.com/weizhouUMICH/SAIGE\">https://github.com/weizhouUMICH/SAIGE</a>.</p>\n\n<p>The following is based on source from GitHub (so with the possibility to git pull),</p>\n\n<div class=\"language-bash highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>module load cmake/3.9 gcc/5\nmodule load python/2.7\nvirtualenv py27\n<span class=\"nb\">source </span>py27/bin/activate\npip <span class=\"nb\">install </span>cget\ngit clone https://github.com/weizhouUMICH/SAIGE\nR CMD INSTALL SAIGE\n</code></pre> </div></div>\n\n<p>Now we see <code class=\"language-plaintext highlighter-rouge\">.../SAIGE.so: undefined symbol: sgecon_</code>. One can get away with it by renaming <code class=\"language-plaintext highlighter-rouge\">configure</code> to <code class=\"language-plaintext highlighter-rouge\">configure.sav</code> (so avoid repeated downloads) and amend the last <code class=\"language-plaintext highlighter-rouge\">g++ ... -o SAIGE.so</code> with <code class=\"language-plaintext highlighter-rouge\">-L$HPC_WORK/lib64 -llapack</code> and then rerun <code class=\"language-plaintext highlighter-rouge\">R CMD INSTALL SAIGE</code>. After successful installation, we can try <code class=\"language-plaintext highlighter-rouge\">cd SAIGE/extdata; bash cmd.sh</code>.</p>\n\n<p>One of the third party software is <code class=\"language-plaintext highlighter-rouge\">bgenix</code> (BE careful with a buggy <code class=\"language-plaintext highlighter-rouge\">cat-bgen</code>!), whose <code class=\"language-plaintext highlighter-rouge\">wscript</code> uses Python 2 syntax so it is necessary to stick to python/2.7 explicitly since gcc/5 automatically loads python 3.</p>\n\n<div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>cd SAIGE\ncd thirdParty\ncd bgen\n./waf configure --prefix=$HPC_WORK\n./waf\n./waf install\nbuild/test/unit/test_bgen\nbuild/apps/bgenix -g example/example.16bits.bgen -list\ncd ../../..\n</code></pre> </div></div>\n\n<p>See <a href=\"https://github.com/weizhouUMICH/SAIGE/issues/98\">https://github.com/weizhouUMICH/SAIGE/issues/98</a>.</p>\n\n<p>For the latest version 0.39.2 which deals with the chromosome X ploidy, the following steps are necessary</p>\n\n<div class=\"language-bash highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>R <span class=\"nt\">-e</span> <span class=\"s2\">\"devtools::install_github('leeshawn/MetaSKAT')\"</span>\nR <span class=\"nt\">-e</span> <span class=\"s2\">\"devtools::install_github('leeshawn/SPAtest')\"</span>\ngit clone <span class=\"nt\">--depth</span> 1 <span class=\"nt\">-b</span> 0.39.2 https://github.com/weizhouUMICH/SAIGE\nR CMD INSTALL SAIGE\n</code></pre> </div></div>\n\n<p>which first installs MetaSKAT 0.80 also at CRAN but SPAtest 3.1.2 instead of 3.0.2 from CRAN.</p>\n","dir":"/applications/","name":"SAIGE.md","path":"applications/SAIGE.md","url":"/applications/SAIGE.html"},{"sort":46,"layout":"default","title":"R/sf","content":"# R/sf\n\nA number of packages use it as dependency and there might be error such as this,\n\n```\nError in dyn.load(file, DLLpath = DLLpath, ...) :\n unable to load shared object '/rds/user/jhz22/hpc-work/R/sf/libs/sf.so':\n /rds/user/jhz22/hpc-work/R/sf/libs/sf.so: undefined symbol: GEOSSTRtree_nearest_generic_r\nCalls: <Anonymous> ... asNamespace -> loadNamespace -> library.dynam -> dyn.load\nExecution halted\n```\n\nWe can get away with this,\n\n```bash\nmodule load geos-3.6.2-gcc-5.4.0-vejexvy\nmodule load gcc/6\nRscript -e \"install.packages('sf')\"\n```\n","dir":"/applications/","name":"sf.md","path":"applications/sf.md","url":"/applications/sf.html"},{"sort":47,"layout":"default","title":"shapeit3","content":"# shapeit3\n\nWeb: [https://jmarchini.org/shapeit3/](https://jmarchini.org/shapeit3/)\n\nIt could be directly used with download from Dropbox; one executable requires boost 1.60.\n\n```bash\n./shapeit3.r884.1\nmodule load boost/1.60/gcc-5.2.0-python-2.7.10\n./shapeit3.r884.2\n```\n","dir":"/applications/","name":"shapeit3.md","path":"applications/shapeit3.md","url":"/applications/shapeit3.html"},{"sort":48,"layout":"default","title":"SMR","content":"<h1 id=\"smr\">SMR</h1>\n\n<p>Web: https://cnsgenomics.com/software/smr/</p>\n\n<div class=\"language-bash highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>wget https://cnsgenomics.com/software/smr/download/smr_1.03_src.zip\nunzip <span class=\"nt\">-v</span> smr_1.03_src.zip\n<span class=\"nb\">mkdir </span>smr\n<span class=\"nb\">cd </span>smr\nunzip ../smr_1.03_src.zip\n<span class=\"nb\">rm</span> <span class=\"nt\">-rf</span> __MACOSX/\n<span class=\"nb\">mv </span>smr_1.03_src/ ../..\n<span class=\"nb\">cd</span> ..\n<span class=\"nb\">rmdir </span>smr\n<span class=\"nb\">cd</span> ../smr_1.03_src/\nmodule load eigen/latest\nmodule load zlib/1.2.8\nmake\n./smr_linux\n</code></pre> </div></div>\n\n<p>One may also use the R code for plotting,</p>\n\n<div class=\"language-bash highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>wget https://cnsgenomics.com/software/smr/download/plot.zip\nunzip plot.zip\n</code></pre> </div></div>\n\n<p>The documentation example is done in R as follows,</p>\n\n<div class=\"language-r highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"n\">source</span><span class=\"p\">(</span><span class=\"s2\">\"plot_SMR.r\"</span><span class=\"p\">)</span><span class=\"w\">\n</span><span class=\"n\">SMRData</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">ReadSMRData</span><span class=\"p\">(</span><span class=\"s2\">\"ILMN_1719097.ILMN_1719097.txt\"</span><span class=\"p\">)</span><span class=\"w\">\n</span><span class=\"n\">SMRLocusPlot</span><span class=\"p\">(</span><span class=\"n\">data</span><span class=\"o\">=</span><span class=\"n\">SMRData</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">smr_thresh</span><span class=\"o\">=</span><span class=\"m\">8.4e-6</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">heidi_thresh</span><span class=\"o\">=</span><span class=\"m\">0.05</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">plotWindow</span><span class=\"o\">=</span><span class=\"m\">1000</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">max_anno_probe</span><span class=\"o\">=</span><span class=\"m\">16</span><span class=\"p\">)</span><span class=\"w\">\n</span></code></pre> </div></div>\n","dir":"/applications/","name":"SMR.md","path":"applications/SMR.md","url":"/applications/SMR.html"},{"sort":49,"layout":"default","title":"snakemake","content":"# snakemake\n\nWeb: [https://snakemake.readthedocs.io/en/stable/index.html](https://snakemake.readthedocs.io/en/stable/index.html)\n\nIt is a python-based workflow management system.\n\nWe illustrate installation through `mamba` and designated location.\n\n```bash\nmodule load miniconda3/4.5.1\nexport mypath=${HOME}/COVID-19/miniconda37\nconda create --prefix ${mypath} python=3.7 ipykernel\nconda init bash\nsource ~/.bashrc\nconda activate ${mypath}\nconda install -c conda-forge mamba\nmamba install -c conda-forge -c bioconda snakemake-minimal\nsnakemake --help\nconda deactivate\n```\n\nBy default, the installation path is ${HOME}/.conda/envs/miniconda37.\n\nAfter installation, the call later on will be simpler,\n\n```bash\nmodule load miniconda3/4.5.1\nexport mypath=${HOME}/COVID-19/miniconda37\nconda activate ${mypath}\n```\n\n## Application example\n\n[Mendelian Randomziation](https://github.com/marcoralab/MRPipeline)\n","dir":"/applications/","name":"snakemake.md","path":"applications/snakemake.md","url":"/applications/snakemake.html"},{"sort":50,"layout":"default","title":"R/snpnet","content":"# R/snpnet\n\nGitHub page: [https://github.com/rivas-lab/snpnet](https://github.com/rivas-lab/snpnet).\n\nA number of software needs to be set up with the current version.\n\n```bash\nmodule load lz4-1.8.1.2-intel-17.0.4-celw56p\nwget https://github.com/facebook/zstd/releases/download/v1.4.4/zstd-1.4.4.tar.gz\ntar xfz zstd-1.4.4.tar.gz\ncd zstd-1.4.4\nmake\nmake install prefix=$HPC_WORK\n# gcc/6 is required for pgenlibr\nmodule load gcc/6\n```\n\nFile `dotCall64/Makevars` needs to be modified, but can be difficult (e.g., reinstallation of gettext, https://ftp.gnu.org/gnu/gettext/gettext-0.20.tar.gz), then\n\n```\nPKG_CFLAGS = $(SHLIB_OPENMP_CFLAGS) -I../inst/include/ -DDOTCAL64_PRIVATE -I$HPC_WORK/include\nPKG_LIBS = $(SHLIB_OPENMP_CFLAGS) -L$HPC_WORK/lib -lintl\n```\n\nFinally, we can proceed\n\n```r\ndevtools::install_github(\"junyangq/glmnetPlus\")\ndevtools::install_github(\"chrchang/plink-ng\", subdir=\"/2.0/cindex\")\ndevtools::install_github(\"chrchang/plink-ng\", subdir=\"/2.0/pgenlibr\")\ndevtools::install_github(\"rivas-lab/snpnet\")\n```\n","dir":"/applications/","name":"snpnet.md","path":"applications/snpnet.md","url":"/applications/snpnet.html"},{"sort":51,"layout":"default","title":"SNPTEST","content":"<h1 id=\"snptest\">SNPTEST</h1>\n\n<p>Web: <a href=\"https://www.well.ox.ac.uk/~gav/snptest/\">https://www.well.ox.ac.uk/~gav/snptest/</a> and <a href=\"https://jmarchini.org/snptest/\">https://jmarchini.org/snptest/</a></p>\n\n<div class=\"language-bash highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"nb\">cd</span> <span class=\"k\">${</span><span class=\"nv\">HPC_WORK</span><span class=\"k\">}</span>\nwget <span class=\"nt\">-qO-</span> http://www.well.ox.ac.uk/~gav/resources/snptest_v2.5.6_CentOS_Linux7.8-x86_64_dynamic.tgz | <span class=\"se\">\\</span>\n<span class=\"nb\">tar </span>xvfz -\n<span class=\"nb\">ln</span> <span class=\"nt\">-sf</span> <span class=\"k\">${</span><span class=\"nv\">HPC_WORK</span><span class=\"k\">}</span>/snptest_v2.5.6_CentOS_Linux7.8.2003-x86_64_dynamic/snptest_v2.5.6 <span class=\"k\">${</span><span class=\"nv\">HPC_WORK</span><span class=\"k\">}</span>/bin/snptest_v2.5.6\n<span class=\"o\">(</span>\n  <span class=\"nb\">echo </span>module load gcc/5\n  <span class=\"nb\">echo</span> <span class=\"s2\">\"snptest_v2.5.6 #@\"</span>\n<span class=\"o\">)</span> <span class=\"o\">&gt;</span> <span class=\"k\">${</span><span class=\"nv\">HPC_WORK</span><span class=\"k\">}</span>/bin/snptest\n</code></pre> </div></div>\n","dir":"/applications/","name":"SNPTEST.md","path":"applications/SNPTEST.md","url":"/applications/SNPTEST.html"},{"sort":52,"layout":"default","title":"R/sojo","content":"# R/sojo\n\nGitHub page: [https://github.com/zhenin/sojo](https://github.com/zhenin/sojo).\n\n```r\ninstall.packages(\"sojo\", repos = \"http://R-Forge.R-project.org\")\n# Swedish twin registry\ndownload.file(\"https://www.dropbox.com/s/ty1udfhx5ohauh8/LD_chr22.rda?raw=1\",\ndestfile = paste0(find.package('sojo'), \"/LD_chr22.rda\"))\nload(file = paste0(find.package('sojo'), \"/LD_chr22.rda\"))\n# 1000Genomes\ndownload.file(\"https://data.broadinstitute.org/alkesgroup/LDSCORE/1000G_Phase3_plinkfiles.tgz\",\ndestfile = paste0(find.package('sojo'), \"/1000G_Phase3_plinkfiles.tgz\"))\nuntar(paste0(find.package('sojo'), \"/1000G_Phase3_plinkfiles.tgz\"),exdir=find.package('sojo'))\nrequire(sojo)\ndata(sum.stat.discovery)\nhpc_work <- Sys.getenv(\"HPC_WORK\")\npath.plink <- paste0(hpc_work,\"/bin/plink\")\npath.1kG <- paste0(find.package('sojo'),\"/1000G_EUR_Phase3_plink\")\nsnps <- sum.stat.discovery$SNP\nwrite.table(snps, file = paste0(snps[1],\"_snp_list.txt\"), quote = F, row.names = F, col.names = F)\nchr <- 22\nsystem(paste0(path.plink,\" -bfile \", path.1kG,\"/1000G.EUR.QC.\",chr,\" --r square --extract \", snps[1], \"_snp_list.txt --out \", snps[1], \" --noweb\"))\nsystem(paste0(path.plink,\" -bfile \", path.1kG,\"/1000G.EUR.QC.\",chr,\" --freq --extract \", snps[1], \"_snp_list.txt --out \", snps[1], \" --noweb\"))\nLD_1kG <- as.matrix(read.table(paste0(snps[1], \".ld\")))\nmaf_1kG <- read.table(paste0(snps[1], \".frq\"), header = T)\nsnp_ref_1kG <- maf_1kG[,\"A2\"]\nnames(snp_ref_1kG) <- maf_1kG[,\"SNP\"]\ncolnames(LD_1kG) <- rownames(LD_1kG) <- maf_1kG$SNP\nres <- sojo(sum.stat.discovery, LD_ref = LD_mat, snp_ref = snp_ref, nvar = 20)\nmatplot(log(res$lambda.v), t(as.matrix(res$beta.mat)), lty = 1, type = \"l\",\n xlab = expression(paste(log, \" \", lambda)), ylab = \"Coefficients\", main = \"Summary-level LASSO\")\ndata(sum.stat.validation)\nres.valid <- sojo(sum.stat.discovery, sum.stat.validation, LD_ref = LD_mat, snp_ref = snp_ref, nvar = 20)\n```\n","dir":"/applications/","name":"sojo.md","path":"applications/sojo.md","url":"/applications/sojo.html"},{"sort":53,"layout":"default","title":"tabix","content":"# tabix\n\nWeb: [https://github.com/samtools/htslib](https://github.com/samtools/htslib).\n\nTheir availability on CSD3 can be seen with\n\n```bash\nmodule avail tabix\nmodule avail htslib\n```\n\nIts utility to extract data has only been realised recently\n\n```bash\ntabix ftp://ftp.ebi.ac.uk/pub/databases/spot/eQTL/csv/BLUEPRINT/ge/BLUEPRINT_ge_monocyte.all.tsv.gz 20:46120612-46120613\ntabix https://gwas.mrcieu.ac.uk/files/ebi-a-GCST010776/ebi-a-GCST010776.vcf.gz 1:1-1000000\n```\n\nwith earlier versions possibly giving error messages; we install the latest,\n\n```bash\nmodule load gcc/6\nwget -qO- https://github.com/samtools/htslib/releases/download/1.12/htslib-1.12.tar.bz2 | \\\ntar -vxjf -\ncd htslib-1.12/\nautoreconf -i\n./configure --enable-libcurl --prefix=${HPC_WORK}\nmake\nmake install\n```\n\nOne could obtain a list of outcomes as follows,\n\n```bash\nRscript -e \"write.table(TwoSampleMR::available_outcomes(),file='ao.txt',quote=FALSE,row.names=FALSE,sep='\\t')\"\n```\n\n**NOTE**\n\nSee specific section on bcftools for additional information.\n\n`bcftools query` works similarly on a local VCF file nevertheless the option `-r` is necessary.\n\n```bash\nbcftools query -f '%ID\\t%ALT\\t%REF\\t%AF\\t[%ES]\\t[%SE]\\t[%LP]\\t[%SS]\\t%CHROM\\t%POS\\n' -r 1:1-1000000 \\\n https://gwas.mrcieu.ac.uk/files/ebi-a-GCST010776/ebi-a-GCST010776.vcf.gz\n```\n\nThe rather perplexing syntax (cut and paste from here in which case) gains its appeal for an output in a well-defined format.\n","dir":"/applications/","name":"tabix.md","path":"applications/tabix.md","url":"/applications/tabix.html"},{"sort":54,"layout":"default","title":"VEP","content":"<h1 id=\"vep\">VEP</h1>\n\n<p>Official page: <a href=\"https://www.ensembl.org/info/docs/tools/vep/index.html\">https://www.ensembl.org/info/docs/tools/vep/index.html</a>\n(<a href=\"https://www.ensembl.org/Tools/VEP\">web interface</a>).</p>\n\n<p>Detailed instructions for installation are available from here,</p>\n\n<p>http://www.ensembl.org/info/docs/tools/vep/script/vep_download.html#installer.</p>\n\n<p>There are several possible ways to install under csd3: GitHub, R and docker.</p>\n\n<h3 id=\"-github-\">— GitHub —</h3>\n\n<p>GitHub Page: <a href=\"https://github.com/Ensembl/ensembl-vep\">https://github.com/Ensembl/ensembl-vep</a>.</p>\n\n<p>The ease with this option lies with GitHub in that updates can simply be made with <code class=\"language-plaintext highlighter-rouge\">git pull</code> to an exisiting release.</p>\n\n<div class=\"language-bash highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"nb\">cd</span> <span class=\"nv\">$HPC_WORK</span>\ngit clone https://github.com/Ensembl/ensembl-vep.git\n<span class=\"nb\">cd </span>ensembl-vep\n<span class=\"nb\">mkdir</span> .vep\n<span class=\"nb\">ln</span> <span class=\"nt\">-sf</span> <span class=\"nv\">$HPC_WORK</span>/ensembl-vep/.vep <span class=\"nv\">$HOME</span>/.vep\nmodule load htslib/1.4\nperl INSTALL.pl\n<span class=\"c\"># set up symbolic links to the executables</span>\n<span class=\"k\">for </span>f <span class=\"k\">in </span>convert_cache.pl filter_vep haplo variant_recoder vep<span class=\"p\">;</span>\n    <span class=\"k\">do </span><span class=\"nb\">ln</span> <span class=\"nt\">-sf</span> <span class=\"nv\">$HPC_WORK</span>/ensembl-vep/<span class=\"nv\">$f</span> <span class=\"nv\">$HPC_WORK</span>/bin/<span class=\"nv\">$f</span><span class=\"p\">;</span> <span class=\"k\">done\n</span>vep <span class=\"nt\">-i</span> examples/homo_sapiens_GRCh37.vcf <span class=\"nt\">-o</span> examples/homo_sapiens_GRCh37.txt <span class=\"se\">\\</span>\n    <span class=\"nt\">--force_overwrite</span> <span class=\"nt\">--offline</span> <span class=\"nt\">--pick</span> <span class=\"nt\">--symbol</span>\n</code></pre> </div></div>\n\n<p>Note in particular that by default, the cache files will be installed at $HOME which would exceed the quota (&lt;40GB) of an ordinary user,\nand as before the destination was redirected. The setup above facilitates storage of cache files, FASTA files and plugins.</p>\n\n<blockquote>\n <p>The FASTA file should be automatically detected by the VEP when using –cache or –offline.\nIf it is not, use “–fasta $HOME/.vep/homo_sapiens/98_GRCh37/Homo_sapiens.GRCh37.75.dna.primary_assembly.fa”</p>\n</blockquote>\n\n<p>Without the htslib/1.4 module, the <code class=\"language-plaintext highlighter-rouge\">--NO_HTSLIB</code> option is needed but “Cannot use format gff without Bio::DB::HTS::Tabix module installed”.\nBio::DB:HTS is in https://github.com/Ensembl/Bio-DB-HTS and change can be made to the <code class=\"language-plaintext highlighter-rouge\">Makefile</code> of htslibs for a desired location, to be\nused by <code class=\"language-plaintext highlighter-rouge\">Build.PL</code> via its command line parameters.</p>\n\n<p>It is notable that VEP accepts compress (.gz) input. It is worthwhile to check for the VEP plugins: <a href=\"https://github.com/Ensembl/VEP_plugins\">https://github.com/Ensembl/VEP_plugins</a>. For instance, to enable the PolyPhen_SIFT plugin we first generate the database.</p>\n\n<div class=\"language-bash highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>vep <span class=\"nt\">--database</span> <span class=\"nt\">--port</span> 3337 <span class=\"nt\">--format</span> guess <span class=\"nt\">--plugin</span> PolyPhen_SIFT,create_db<span class=\"o\">=</span>1\n</code></pre> </div></div>\n\n<p>One may wish to skip the comments (lines started with ##) in processing of the output, e.g., in R,</p>\n\n<div class=\"language-bash highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"nb\">export </span><span class=\"nv\">skips</span><span class=\"o\">=</span><span class=\"si\">$(</span><span class=\"nb\">grep</span> <span class=\"s1\">'##'</span> examples/homo_sapiens_GRCh37.txt | <span class=\"nb\">wc</span> <span class=\"nt\">-l</span><span class=\"si\">)</span>\nR <span class=\"nt\">--no-save</span> <span class=\"nt\">-q</span> <span class=\"o\">&lt;&lt;</span><span class=\"no\">END</span><span class=\"sh\">\n  vo &lt;- read.delim(\"examples/homo_sapiens_GRCh37.txt\",skip=as.numeric(Sys.getenv(\"skips\")))\n  head(vo)\n</span><span class=\"no\">END\n</span></code></pre> </div></div>\n\n<p>allowing for variable number of lines given various command-line options to be skipped to have</p>\n\n<div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>  X.Uploaded_variation    Location Allele            Gene         Feature\n1          rs116645811 21:26960070      A ENSG00000154719 ENST00000307301\n2            rs1135638 21:26965148      A ENSG00000154719 ENST00000307301\n3              rs10576 21:26965172      C ENSG00000154719 ENST00000307301\n4            rs1057885 21:26965205      C ENSG00000154719 ENST00000307301\n5          rs116331755 21:26976144      G ENSG00000154719 ENST00000307301\n6            rs7278168 21:26976222      T ENSG00000154719 ENST00000307301\n  Feature_type        Consequence cDNA_position CDS_position Protein_position\n1   Transcript   missense_variant          1043         1001              334\n2   Transcript synonymous_variant           939          897              299\n3   Transcript synonymous_variant           915          873              291\n4   Transcript synonymous_variant           882          840              280\n5   Transcript synonymous_variant           426          384              128\n6   Transcript synonymous_variant           348          306              102\n  Amino_acids  Codons Existing_variation\n1         T/M aCg/aTg                  -\n2           G ggC/ggT                  -\n3           P ccA/ccG                  -\n4           V gtA/gtG                  -\n5           L ctT/ctC                  -\n6           K aaG/aaA                  -\n                                                                     Extra\n1 IMPACT=MODERATE;STRAND=-1;SYMBOL=MRPL39;SYMBOL_SOURCE=HGNC;HGNC_ID=14027\n2      IMPACT=LOW;STRAND=-1;SYMBOL=MRPL39;SYMBOL_SOURCE=HGNC;HGNC_ID=14027\n3      IMPACT=LOW;STRAND=-1;SYMBOL=MRPL39;SYMBOL_SOURCE=HGNC;HGNC_ID=14027\n4      IMPACT=LOW;STRAND=-1;SYMBOL=MRPL39;SYMBOL_SOURCE=HGNC;HGNC_ID=14027\n5      IMPACT=LOW;STRAND=-1;SYMBOL=MRPL39;SYMBOL_SOURCE=HGNC;HGNC_ID=14027\n6      IMPACT=LOW;STRAND=-1;SYMBOL=MRPL39;SYMBOL_SOURCE=HGNC;HGNC_ID=14027\n&gt;\n</code></pre> </div></div>\n\n<p>When a particular release really works well on the system, it is possible to install it, e.g.,</p>\n\n<div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>git checkout release/98\nperl INSTALL.pl\n</code></pre> </div></div>\n\n<p>for release 98 instead of the latest from <code class=\"language-plaintext highlighter-rouge\">git pull</code>.</p>\n\n<p>It could be useful to filter VEP output, see https://www.ensembl.org/info/docs/tools/vep/script/vep_filter.html.</p>\n\n<h3 id=\"nearest-gene\"><strong>Nearest gene</strong></h3>\n\n<p>This can produces error message</p>\n\n<div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>-------------------- EXCEPTION --------------------\nMSG: ERROR: --nearest requires Set::IntervalTree perl module to be installed\n</code></pre> </div></div>\n\n<p>and we get around with</p>\n\n<div class=\"language-bash highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>perl <span class=\"nt\">-MCPAN</span> <span class=\"nt\">-e</span> shell\n<span class=\"nb\">install </span>Set::IntervalTree\n</code></pre> </div></div>\n\n<p>which will enable <code class=\"language-plaintext highlighter-rouge\">--nearest gene</code>.</p>\n\n<h3 id=\"annotation-in-chunks\"><strong>Annotation in chunks</strong></h3>\n\n<p>A toy example, following http://www.ensembl.org/info/docs/tools/vep/script/vep_other.html#faster, is given as follows,</p>\n\n<div class=\"language-bash highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"nb\">cd </span>examples\nbgzip <span class=\"nt\">-f</span> homo_sapiens_GRCh37.vcf\ntabix <span class=\"nt\">-Cf</span> homo_sapiens_GRCh37.vcf.gz\ntabix <span class=\"nt\">-h</span>  homo_sapiens_GRCh37.vcf.gz 22:50616005-50616006 | <span class=\"se\">\\</span>\nvep <span class=\"nt\">--cache</span> <span class=\"nt\">--fork</span> 4 <span class=\"nt\">--port</span> 3337 <span class=\"nt\">--format</span> vcf <span class=\"nt\">-o</span> - <span class=\"nt\">--tab</span> <span class=\"nt\">--no_stats</span> | <span class=\"se\">\\</span>\n<span class=\"nb\">grep</span> <span class=\"nt\">-v</span> <span class=\"s1\">'##'</span>\n<span class=\"nb\">cd</span> -\n</code></pre> </div></div>\n\n<p>from this we could propagate the idea for autosomes in chunks as follows,</p>\n\n<div class=\"language-bash highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"nb\">export </span><span class=\"nv\">ref</span><span class=\"o\">=</span>~/rds/post_qc_data/interval/reference_files/genetic/reference_files_genotyped_imputed/\n<span class=\"nb\">export </span><span class=\"nv\">chunk_size</span><span class=\"o\">=</span>10000\n<span class=\"nb\">seq </span>22 | <span class=\"se\">\\</span>\nparallel <span class=\"nt\">-j1</span> <span class=\"nt\">--env</span> ref <span class=\"nt\">-C</span><span class=\"s1\">' '</span> <span class=\"s1\">'\n  export n=$(awk \"END{print NR-1}\" ${ref}/impute_{}_interval.snpstats)\n  export g=$(expr ${n} / ${chunk_size})\n  export s=$(expr $n - $(( $g * $chunk_size)))\n  (\n    for i in $(seq ${g}); do\n      (\n        awk \"BEGIN{print \\\"##fileformat=VCFv4.0\\\"}\"\n        awk -vOFS=\"\\t\" \"BEGIN{print \\\"#CHROM\\\",\\\"POS\\\",\\\"ID\\\",\\\"REF\\\",\\\"ALT\\\",\\\"QUAL\\\",\\\"FILTER\\\",\\\"INFO\\\"}\"\n        (\n          sed \"1d\" ${ref}/impute_{}_interval.snpstats | \\\n          awk -v i=${i} -v chunk_size=${chunk_size} -v OFS=\"\\t\" \"NR==(i-1)*chunk_size+1,NR==i*chunk_size {\n              if(\\$1==\\\".\\\") \\$1=\\$3+0 \\\":\\\" \\$4 \\\"_\\\" \\$5 \\\"/\\\" \\$6; print \\$3+0,\\$4,\\$1,\\$5,\\$6,\\\".\\\",\\\".\\\",\\$19}\"\n          if [ ${s} -gt 0 ] &amp;&amp;  [ ${i} -eq ${g} ]; then\n             sed \"1d\" ${ref}/impute_{}_interval.snpstats | \\\n             awk -v i=${i} -v chunk_size=${chunk_size} -v OFS=\"\\t\" -v n=${n} \"NR==i*chunk_size+1,NR==n {\n                 if(\\$1==\\\".\\\") \\$1=\\$3+0 \\\":\\\" \\$4 \\\"_\\\" \\$5 \\\"/\\\" \\$6; print \\$3+0,\\$4,\\$1,\\$5,\\$6,\\\".\\\",\\\".\\\",\\$19}\"\n          fi\n        )\n      ) | \\\n      vep  --cache --offline --format vcf -o - --tab --pick --no_stats  \\\n           --species homo_sapiens --assembly GRCh37 --port 3337 | \\\n      (\n        if [ ${i} -eq 1 ]; then cat; else grep -v \"#\"; fi\n      )\n    done\n  ) | \\\n  gzip -f &gt; work/INTERVAL-{}.vep.gz\n'</span>\n</code></pre> </div></div>\n\n<p>Note we use information from <code class=\"language-plaintext highlighter-rouge\">.snpstats</code> files at location <code class=\"language-plaintext highlighter-rouge\">ref</code> to build input in vcf format on the fly and feed into VEP. For instance <code class=\"language-plaintext highlighter-rouge\">impute_22_interval.snpstats</code> contains the following lines,</p>\n\n<div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>SNPID\tRSID\tchromosome\tposition\tA_allele\tB_allele\tminor_allele\tmajor_allele\tAA\tAB\tBB\tAA_calls\tAB_calls\tBB_calls\tMAF\tHWE\tmissing\tmissing_calls\tinformation\nrs587697622\trs587697622\t22\t16050075\tA\tG\tG\tA\t43058\t1.2499\t0\t43058\t1\t0\t1.4514e-05\t-0\t0\t0\t0.81003\nrs587755077\trs587755077\t22\t16050115\tG\tA\tA\tG\t42485\t572.42\t1.7625\t42105\t306\t1\t0.0066878\t0.14341\t3.5437e-09\t0.015026\t0.68672\nrs587654921\trs587654921\t22\t16050213\tC\tT\tT\tC\t42848\t211.12\t0.16248\t42746\t124\t0\t0.0024553\t-0\t1.4175e-09\t0.0043893\t0.67168\nrs587712275\trs587712275\t22\t16050319\tC\tT\tT\tC\t43022\t36.998\t0\t43022\t23\t0\t0.00042962\t-0\t0\t0.00032514\t0.69071\n</code></pre> </div></div>\n\n<h3 id=\"ensembl-synonym-translation\"><strong>ENSEMBL-synonym translation</strong></h3>\n\n<p>The ENSEMBL-synonym translation is useful to check for the feature types – in the case of ENSG00000160712 (IL6R)\nwe found ENST00000368485 and ENST00000515190, we do</p>\n\n<div class=\"language-bash highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>wget http://hgdownload.soe.ucsc.edu/goldenPath/hg19/database/ensemblToGeneName.txt.gz\nzgrep <span class=\"nt\">-e</span> ENST00000368485 <span class=\"nt\">-e</span> ENST00000515190 ensemblToGeneName.txt.gz\n</code></pre> </div></div>\n\n<p>giving</p>\n\n<div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>ENST00000368485 IL6R\nENST00000515190 IL6R\n</code></pre> </div></div>\n\n<p>though this could also be furnished with R/biomaRt as follows,</p>\n\n<div class=\"language-r highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"n\">library</span><span class=\"p\">(</span><span class=\"n\">biomaRt</span><span class=\"p\">)</span><span class=\"w\">\n</span><span class=\"n\">ensembl</span><span class=\"w\"> </span><span class=\"o\">&lt;-</span><span class=\"w\"> </span><span class=\"n\">useMart</span><span class=\"p\">(</span><span class=\"s2\">\"ensembl\"</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">dataset</span><span class=\"o\">=</span><span class=\"s2\">\"hsapiens_gene_ensembl\"</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">host</span><span class=\"o\">=</span><span class=\"s2\">\"grch37.ensembl.org\"</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">path</span><span class=\"o\">=</span><span class=\"s2\">\"/biomart/martservice\"</span><span class=\"p\">)</span><span class=\"w\">\n</span><span class=\"n\">attr</span><span class=\"w\"> </span><span class=\"o\">&lt;-</span><span class=\"w\"> </span><span class=\"n\">listAttributes</span><span class=\"p\">(</span><span class=\"n\">ensembl</span><span class=\"p\">)</span><span class=\"w\">\n</span><span class=\"n\">g</span><span class=\"w\"> </span><span class=\"o\">&lt;-</span><span class=\"w\"> </span><span class=\"nf\">c</span><span class=\"p\">(</span><span class=\"s1\">'ensembl_gene_id'</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"s1\">'chromosome_name'</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"s1\">'start_position'</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"s1\">'end_position'</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"s1\">'description'</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"s1\">'hgnc_symbol'</span><span class=\"p\">)</span><span class=\"w\">\n</span><span class=\"n\">t</span><span class=\"w\"> </span><span class=\"o\">&lt;-</span><span class=\"w\"> </span><span class=\"nf\">c</span><span class=\"p\">(</span><span class=\"s1\">'ensembl_transcript_id'</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"s1\">'transcription_start_site'</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"s1\">'transcript_start'</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"s1\">'transcript_end'</span><span class=\"p\">)</span><span class=\"w\">\n</span><span class=\"n\">u</span><span class=\"w\"> </span><span class=\"o\">&lt;-</span><span class=\"w\"> </span><span class=\"s2\">\"uniprotswissprot\"</span><span class=\"w\">\n</span><span class=\"n\">gtu</span><span class=\"w\"> </span><span class=\"o\">&lt;-</span><span class=\"w\"> </span><span class=\"n\">getBM</span><span class=\"p\">(</span><span class=\"n\">attributes</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"nf\">c</span><span class=\"p\">(</span><span class=\"n\">g</span><span class=\"p\">,</span><span class=\"n\">t</span><span class=\"p\">,</span><span class=\"n\">u</span><span class=\"p\">),</span><span class=\"w\"> </span><span class=\"n\">mart</span><span class=\"w\"> </span><span class=\"o\">=</span><span class=\"w\"> </span><span class=\"n\">ensembl</span><span class=\"p\">)</span><span class=\"w\">\n</span></code></pre> </div></div>\n\n<p>For ENSEMBL genes, R/grex is likely to work though it was developed for other purpose, e.g.,</p>\n\n<div class=\"language-bash highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>R <span class=\"nt\">-q</span> <span class=\"nt\">-e</span> <span class=\"s2\">\"grex::grex(</span><span class=\"se\">\\\"</span><span class=\"s2\">ENSG00000160712</span><span class=\"se\">\\\"</span><span class=\"s2\">)\"</span>\n</code></pre> </div></div>\n\n<p>giving</p>\n\n<div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>       ensembl_id entrez_id hgnc_symbol              hgnc_name cyto_loc\n1 ENSG00000160712      3570        IL6R interleukin 6 receptor   1q21.3\n  uniprot_id   gene_biotype\n1     A0N0L5 protein_coding\n</code></pre> </div></div>\n\n<p>The aligment of ENSG, ENST, ENSP is <code class=\"language-plaintext highlighter-rouge\">ensGtp.txt.gz</code> at the same UCSC directory above.</p>\n\n<p>Other possibilities include UCSC/ensembl MySQL server, e.g.,</p>\n\n<div class=\"language-bash highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>mysql  <span class=\"nt\">--user</span><span class=\"o\">=</span>genome <span class=\"nt\">--host</span><span class=\"o\">=</span>genome-mysql.cse.ucsc.edu <span class=\"nt\">-A</span> <span class=\"nt\">-D</span> hg19 <span class=\"o\">&lt;&lt;</span><span class=\"no\">END</span><span class=\"sh\">\nselect distinct G.gene,N.value from ensGtp as G, ensemblToGeneName as N where\n   G.transcript=N.name and\n   G.gene in (\"ENSG00000160712\");\n</span><span class=\"no\">END\n</span></code></pre> </div></div>\n\n<p>and</p>\n\n<div class=\"language-bash highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>mysql <span class=\"nt\">-h</span> ensembldb.ensembl.org <span class=\"nt\">--port</span> 5306  <span class=\"nt\">-u</span> anonymous <span class=\"nt\">-D</span> homo_sapiens_core_64_37 <span class=\"nt\">-A</span> <span class=\"o\">&lt;&lt;</span><span class=\"no\">END</span><span class=\"sh\">\nselect distinct\n   G.stable_id,\n   S.synonym\nfrom\n  gene_stable_id as G,\n  object_xref as OX,\n  external_synonym as S,\n  xref as X ,\n  external_db as D\nwhere\n  D.external_db_id=X.external_db_id and\n  X.xref_id=S.xref_id and\n  OX.xref_id=X.xref_id and\n  OX.ensembl_object_type=\"Gene\" and\n  G.gene_id=OX.ensembl_id and\n  G.stable_id in (\"ENSG00000160712\");\n</span><span class=\"no\">END\n</span></code></pre> </div></div>\n\n<p>according to https://www.biostars.org/p/14367/.</p>\n\n<p>Perhaps it is the easiest to use <code class=\"language-plaintext highlighter-rouge\">gprofiler2</code>, i.e.,</p>\n\n<div class=\"language-r highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"n\">gprofiler2</span><span class=\"o\">::</span><span class=\"n\">gconvert</span><span class=\"p\">(</span><span class=\"s2\">\"ENSG00000164761\"</span><span class=\"p\">)</span><span class=\"w\">\n</span></code></pre> </div></div>\n\n<p>giving</p>\n\n<div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>  input_number input target_number          target name                                               description                           namespace\n1            1  IL6R           1.1 ENSG00000160712 IL6R interleukin 6 receptor [Source:HGNC Symbol;Acc:HGNC:6019] ENTREZGENE,HGNC,UNIPROT_GN,WIKIGENE\n</code></pre> </div></div>\n\n<h3 id=\"clinvar\"><strong>clinvar</strong></h3>\n\n<p>The local installation enables considerable flexibilty, and the following example, using GRCh37 assembly, is based on\n<a href=\"https://www.ensembl.org/info/docs/tools/vep/script/vep_custom.html#custom_options\">https://www.ensembl.org/info/docs/tools/vep/script/vep_custom.html#custom_options</a>.</p>\n\n<div class=\"language-bash highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"c\"># Compressed VCF file</span>\ncurl ftp://ftp.ncbi.nlm.nih.gov/pub/clinvar/vcf_GRCh37/clinvar.vcf.gz <span class=\"nt\">-o</span> clinvar_GRCh37.vcf.gz\n<span class=\"c\"># Index file</span>\ncurl ftp://ftp.ncbi.nlm.nih.gov/pub/clinvar/vcf_GRCh37/clinvar.vcf.gz.tbi <span class=\"nt\">-o</span> clinvar_GRCh37.vcf.gz.tbi\n</code></pre> </div></div>\n\n<p>Information is gathered from the header of the VCF file,</p>\n\n<table>\n <thead>\n <tr>\n <th>ClinVar Variation ID</th>\n <th>Description</th>\n <th> </th>\n </tr>\n </thead>\n <tbody>\n <tr>\n <td>AF_ESP</td>\n <td>allele frequencies from GO-ESP</td>\n <td> </td>\n </tr>\n <tr>\n <td>AF_EXAC</td>\n <td>allele frequencies from ExAC</td>\n <td> </td>\n </tr>\n <tr>\n <td>AF_TGP</td>\n <td>allele frequencies from TGP</td>\n <td> </td>\n </tr>\n <tr>\n <td>ALLELEID</td>\n <td>the ClinVar Allele ID</td>\n <td> </td>\n </tr>\n <tr>\n <td>CLNDN</td>\n <td>ClinVar’s preferred disease name for the concept specified by disease identifiers in CLNDISDB</td>\n <td> </td>\n </tr>\n <tr>\n <td>CLNDNINCL</td>\n <td>For included Variant : ClinVar’s preferred disease name for the concept specified by disease identifiers in CLNDISDB</td>\n <td> </td>\n </tr>\n <tr>\n <td>CLNDISDB</td>\n <td>Tag-value pairs of disease database name and identifier, e.g. OMIM:NNNNNN</td>\n <td> </td>\n </tr>\n <tr>\n <td>CLNDISDBINCL</td>\n <td>For included Variant: Tag-value pairs of disease database name and identifier, e.g. OMIM:NNNNNN</td>\n <td> </td>\n </tr>\n <tr>\n <td>CLNHGVS</td>\n <td>Top-level (primary assembly, alt, or patch) HGVS expression.</td>\n <td> </td>\n </tr>\n <tr>\n <td>CLNREVSTAT</td>\n <td>ClinVar review status for the Variation ID</td>\n <td> </td>\n </tr>\n <tr>\n <td>CLNSIG</td>\n <td>Clinical significance for this single variant</td>\n <td> </td>\n </tr>\n <tr>\n <td>CLNSIGCONF</td>\n <td>Conflicting clinical significance for this single variant</td>\n <td> </td>\n </tr>\n <tr>\n <td>CLNSIGINCL</td>\n <td>Clinical significance for a haplotype or genotype that includes this variant. Reported as pairs of VariationID:clinical significance.</td>\n <td> </td>\n </tr>\n <tr>\n <td>CLNVC</td>\n <td>Variant type</td>\n <td> </td>\n </tr>\n <tr>\n <td>CLNVCSO</td>\n <td>Sequence Ontology id for variant type</td>\n <td> </td>\n </tr>\n <tr>\n <td>CLNVI</td>\n <td>the variant’s clinical sources reported as tag-value pairs of database and variant identifier</td>\n <td> </td>\n </tr>\n <tr>\n <td>DBVARID</td>\n <td>nsv accessions from dbVar for the variant</td>\n <td> </td>\n </tr>\n <tr>\n <td>GENEINFO</td>\n <td>Gene(s) for the variant reported as gene symbol:gene id. The gene symbol and id are delimited by a colon (:) and each pair is delimited by a vertical bar (</td>\n <td>)</td>\n </tr>\n <tr>\n <td>MC</td>\n <td>comma separated list of molecular consequence in the form of Sequence Ontology ID</td>\n <td>molecular_consequence</td>\n </tr>\n <tr>\n <td>ORIGIN</td>\n <td>Allele origin. One or more of the following values may be added: 0 - unknown; 1 - germline; 2 - somatic ; 4 - inherited; 8 - paternal; 16 - maternal; 32 - de-novo; 64 - biparental; 128 - uniparental; 256 - not-tested; 512 - tested-inconclusive; 1073741824 - other</td>\n <td> </td>\n </tr>\n <tr>\n <td>RS</td>\n <td>dbSNP ID (i.e. rs number)</td>\n <td> </td>\n </tr>\n <tr>\n <td>SSR</td>\n <td>Variant Suspect Reason Codes. One or more of the following values may be added: 0 - unspecified, 1 - Paralog, 2 - byEST, 4 - oldAlign, 8 - Para_EST, 16 - 1kg_failed, 1024 - other</td>\n <td> </td>\n </tr>\n </tbody>\n</table>\n\n<p>We now query rs2228145,</p>\n\n<div class=\"language-bash highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>vep <span class=\"nt\">--id</span> <span class=\"s2\">\"1 154426970 154426970 A/C 1\"</span> <span class=\"nt\">--species</span> homo_sapiens <span class=\"nt\">-o</span> rs2228145 <span class=\"nt\">--cache</span> <span class=\"nt\">--offline</span> <span class=\"nt\">--force_overwrite</span> <span class=\"se\">\\</span>\n    <span class=\"nt\">--assembly</span> GRCh37 <span class=\"nt\">--custom</span> clinvar_GRCh37.vcf.gz,ClinVar,vcf,exact,0,CLNSIG,CLNREVSTAT,CLNDN\n</code></pre> </div></div>\n\n<p>which gives</p>\n\n<div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>#Uploaded_variation\tLocation\tAllele\tGene\tFeature\tFeature_type\tConsequence\tcDNA_position\tCDS_position\tProtein_position\tAmino_acids\tCodons\tExisting_variation\tExtra\n1_154426970_A/C\t1:154426970\tC\tENSG00000160712\tENST00000344086\tTranscript\tintron_variant\t-\t-\t-\t-\t-\t-\tIMPACT=MODIFIER;STRAND=1;ClinVar=14660;ClinVar_CLNDN=Interleukin_6,_serum_level_of,_quantitative_trait_locus|Soluble_interleukin-6_receptor,_serum_level_of,_quantitative_trait_locus;ClinVar_CLNREVSTAT=no_assertion_criteria_provided;ClinVar_CLNSIG=association;ClinVar_FILTER=.\n1_154426970_A/C\t1:154426970\tC\tENSG00000160712\tENST00000368485\tTranscript\tmissense_variant\t1510\t1073\t358\tD/A\tgAt/gCt\t-\tIMPACT=MODERATE;STRAND=1;ClinVar=14660;ClinVar_CLNDN=Interleukin_6,_serum_level_of,_quantitative_trait_locus|Soluble_interleukin-6_receptor,_serum_level_of,_quantitative_trait_locus;ClinVar_CLNREVSTAT=no_assertion_criteria_provided;ClinVar_CLNSIG=association;ClinVar_FILTER=.\n1_154426970_A/C\t1:154426970\tC\tENSG00000160712\tENST00000476006\tTranscript\tdownstream_gene_variant\t-\t-\t-\t-\t-\t-\tIMPACT=MODIFIER;DISTANCE=4515;STRAND=1;FLAGS=cds_start_NF,cds_end_NF;ClinVar=14660;ClinVar_CLNDN=Interleukin_6,_serum_level_of,_quantitative_trait_locus|Soluble_interleukin-6_receptor,_serum_level_of,_quantitative_trait_locus;ClinVar_CLNREVSTAT=no_assertion_criteria_provided;ClinVar_CLNSIG=association;ClinVar_FILTER=.\n1_154426970_A/C\t1:154426970\tC\tENSG00000160712\tENST00000502679\tTranscript\tnon_coding_transcript_exon_variant\t386\t-\t-\t-\t-\t-\tIMPACT=MODIFIER;STRAND=1;ClinVar=14660;ClinVar_CLNDN=Interleukin_6,_serum_level_of,_quantitative_trait_locus|Soluble_interleukin-6_receptor,_serum_level_of,_quantitative_trait_locus;ClinVar_CLNREVSTAT=no_assertion_criteria_provided;ClinVar_CLNSIG=association;ClinVar_FILTER=.\n1_154426970_A/C\t1:154426970\tC\tENSG00000160712\tENST00000507256\tTranscript\tnon_coding_transcript_exon_variant\t271\t-\t-\t-\t-\t-\tIMPACT=MODIFIER;STRAND=1;ClinVar=14660;ClinVar_CLNDN=Interleukin_6,_serum_level_of,_quantitative_trait_locus|Soluble_interleukin-6_receptor,_serum_level_of,_quantitative_trait_locus;ClinVar_CLNREVSTAT=no_assertion_criteria_provided;ClinVar_CLNSIG=association;ClinVar_FILTER=.\n1_154426970_A/C\t1:154426970\tC\tENSG00000160712\tENST00000515190\tTranscript\tmissense_variant\t481\t482\t161\tD/A\tgAt/gCt\t-\tIMPACT=MODERATE;STRAND=1;FLAGS=cds_start_NF,cds_end_NF;ClinVar=14660;ClinVar_CLNDN=Interleukin_6,_serum_level_of,_quantitative_trait_locus|Soluble_interleukin-6_receptor,_serum_level_of,_quantitative_trait_locus;ClinVar_CLNREVSTAT=no_assertion_criteria_provided;ClinVar_CLNSIG=association;ClinVar_FILTER=.\n</code></pre> </div></div>\n\n<p>A <a href=\"/applications/files/rs2228145_summary.html\">HTML summary</a> (somehow the web browser may not display the embedded figures) is also available. The <code class=\"language-plaintext highlighter-rouge\">Extra</code> column looks clumsy and we could add the <code class=\"language-plaintext highlighter-rouge\">--tab</code> option to generate a tab-delimited output.</p>\n\n<div class=\"language-bash highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>vep <span class=\"nt\">--id</span> <span class=\"s2\">\"1 154426970 154426970 A/C 1\"</span> <span class=\"nt\">--species</span> homo_sapiens <span class=\"nt\">-o</span> rs2228145 <span class=\"nt\">--cache</span> <span class=\"nt\">--offline</span> <span class=\"nt\">--force_overwrite</span> <span class=\"se\">\\</span>\n    <span class=\"nt\">--custom</span> clinvar_GRCh37.vcf.gz,ClinVar,vcf,exact,0,CLNSIG,CLNREVSTAT,CLNDN <span class=\"nt\">--tab</span> <span class=\"se\">\\</span>\n    <span class=\"nt\">--fields</span> Uploaded_variation,Gene,Consequence,ClinVar_CLNSIG,ClinVar_CLNREVSTAT,ClinVar_CLNDN\n</code></pre> </div></div>\n\n<p>to give neatly</p>\n\n<div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>#Uploaded_variation\tGene\tConsequence\tClinVar_CLNSIG\tClinVar_CLNREVSTAT\tClinVar_CLNDN\n1_154426970_A/C\tENSG00000160712\tintron_variant\tassociation\tno_assertion_criteria_provided\tInterleukin_6,_serum_level_of,_quantitative_trait_locus|Soluble_interleukin-6_receptor,_serum_level_of,_quantitative_trait_locus\n1_154426970_A/C\tENSG00000160712\tmissense_variant\tassociation\tno_assertion_criteria_provided\tInterleukin_6,_serum_level_of,_quantitative_trait_locus|Soluble_interleukin-6_receptor,_serum_level_of,_quantitative_trait_locus\n1_154426970_A/C\tENSG00000160712\tdownstream_gene_variant\tassociation\tno_assertion_criteria_provided\tInterleukin_6,_serum_level_of,_quantitative_trait_locus|Soluble_interleukin-6_receptor,_serum_level_of,_quantitative_trait_locus\n1_154426970_A/C\tENSG00000160712\tnon_coding_transcript_exon_variant\tassociation\tno_assertion_criteria_provided\tInterleukin_6,_serum_level_of,_quantitative_trait_locus|Soluble_interleukin-6_receptor,_serum_level_of,_quantitative_trait_locus\n1_154426970_A/C\tENSG00000160712\tnon_coding_transcript_exon_variant\tassociation\tno_assertion_criteria_provided\tInterleukin_6,_serum_level_of,_quantitative_trait_locus|Soluble_interleukin-6_receptor,_serum_level_of,_quantitative_trait_locus\n1_154426970_A/C\tENSG00000160712\tmissense_variant\tassociation\tno_assertion_criteria_provided\tInterleukin_6,_serum_level_of,_quantitative_trait_locus|Soluble_interleukin-6_receptor,_serum_level_of,_quantitative_trait_locus\n</code></pre> </div></div>\n\n<h3 id=\"dbnsfp\"><strong>dbNSFP</strong></h3>\n\n<p>Web page: <a href=\"https://sites.google.com/site/jpopgen/dbNSFP\">https://sites.google.com/site/jpopgen/dbNSFP</a>.</p>\n\n<p>This is set up as follows,</p>\n\n<div class=\"language-bash highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>wget ftp://dbnsfp:dbnsfp@dbnsfp.softgenetics.com/dbNSFP4.1a.zip\nunzip dbNSFP4.1a.zip <span class=\"nt\">-d</span> dbNSFP4.1a\n<span class=\"nb\">cd </span>dbNSFP4.1a\n<span class=\"c\"># code for 4.0a</span>\n<span class=\"c\"># zcat dbNSFP4.0a_variant.chr1.gz | head -n1 &gt; h</span>\n<span class=\"c\"># zgrep -h -v ^#chr dbNSFP4.0a_variant.chr* | sort -k1,1 -k2,2n - | cat h - | bgzip -c &gt; dbNSFP4.0a.gz</span>\n<span class=\"c\"># efficient version</span>\n<span class=\"o\">(</span>\n  zcat dbNSFP4.1a_variant.chr1.gz | <span class=\"nb\">head</span> <span class=\"nt\">-n1</span>\n  <span class=\"nb\">export </span><span class=\"nv\">prefix</span><span class=\"o\">=</span>dbNSFP4.1a_variant.chr\n  <span class=\"nb\">echo</span> <span class=\"k\">${</span><span class=\"nv\">prefix</span><span class=\"k\">}</span><span class=\"o\">{</span>1..22<span class=\"o\">}</span>.gz <span class=\"k\">${</span><span class=\"nv\">prefix</span><span class=\"k\">}</span>M.gz <span class=\"k\">${</span><span class=\"nv\">prefix</span><span class=\"k\">}</span>X.gz <span class=\"k\">${</span><span class=\"nv\">prefix</span><span class=\"k\">}</span>Y.gz | <span class=\"se\">\\</span>\n  xargs <span class=\"nt\">-I</span> <span class=\"o\">{}</span> bash <span class=\"nt\">-c</span> <span class=\"s2\">\"zcat {} | sed '1d'\"</span>\n<span class=\"o\">)</span> | bgzip <span class=\"nt\">-c</span> <span class=\"o\">&gt;</span> dbNSFP4.1a.gz\ntabix <span class=\"nt\">-s</span> 1 <span class=\"nt\">-b</span> 2 <span class=\"nt\">-e</span> 2 dbNSFP4.1a.gz\n<span class=\"nb\">cd</span> -\nvep <span class=\"nt\">-i</span> examples/homo_sapiens_GRCh37.vcf <span class=\"nt\">-o</span> <span class=\"nb\">test</span> <span class=\"nt\">--cache</span> <span class=\"nt\">--force_overwrite</span> <span class=\"nt\">--offline</span> <span class=\"se\">\\</span>\n    <span class=\"nt\">--plugin</span> dbNSFP,dbNSFP4.1a/dbNSFP4.1a.gz,LRT_score,FATHMM_score,MutationTaster_score\n</code></pre> </div></div>\n\n<p>Since this release is frozen on Ensembl 94’s transcript set, one may prefer to use it independently via its Java programs, e.g.,</p>\n\n<div class=\"language-bash highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>java <span class=\"nt\">-jar</span> search_dbNSFP41a.jar <span class=\"nt\">-i</span> tryhg19.in <span class=\"nt\">-o</span> tryhg19.out <span class=\"nt\">-v</span> hg19\njava <span class=\"nt\">-jar</span> search_dbNSFP41a.jar <span class=\"nt\">-i</span> tryhg38.in <span class=\"nt\">-o</span> tryhg38.out\n</code></pre> </div></div>\n\n<h3 id=\"-loftee-\">— loftee —</h3>\n\n<p>GitHub page: <a href=\"https://github.com/konradjk/loftee\">https://github.com/konradjk/loftee</a>.</p>\n\n<p>Reference: MacArthur DG et al (2012). A systematic survey of loss-of-function variants in human protein-coding genes. <em>Science</em> 335:823–828</p>\n\n<p>It is actually part of the standard VEP plugins.</p>\n\n<div class=\"language-bash highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"nb\">cd </span>loftee\n<span class=\"c\"># human_ancestor_fa</span>\n<span class=\"c\">## samtools --version gives 0.1.19</span>\nwget http://www.broadinstitute.org/~konradk/loftee/human_ancestor.fa.rz\nwget http://www.broadinstitute.org/~konradk/loftee/human_ancestor.fa.rz.fai\n<span class=\"c\">## samtools --version gives 1.x</span>\nwget https://s3.amazonaws.com/bcbio_nextgen/human_ancestor.fa.gz\nwget https://s3.amazonaws.com/bcbio_nextgen/human_ancestor.fa.gz.fai\nwget https://s3.amazonaws.com/bcbio_nextgen/human_ancestor.fa.gz.gzi\n<span class=\"c\"># conservation_file</span>\nwget https://personal.broadinstitute.org/konradk/loftee_data/GRCh37/phylocsf_gerp.sql.gz\nwget https://www.broadinstitute.org/~konradk/loftee/phylocsf_data.tsv.gz\nwget https://personal.broadinstitute.org/konradk/loftee_data/GRCh37/GERP_scores.final.sorted.txt.gz\nwget https://personal.broadinstitute.org/konradk/loftee_data/GRCh37/GERP_scores.exons.txt.gz\n<span class=\"c\"># annotation</span>\nvep <span class=\"nt\">--id</span> <span class=\"s2\">\"1 154426970 154426970 A/C 1\"</span> <span class=\"nt\">--species</span> homo_sapiens <span class=\"nt\">-o</span> rs2228145 <span class=\"nt\">--cache</span> <span class=\"nt\">--offline</span> <span class=\"nt\">--force_overwrite</span> <span class=\"se\">\\</span>\n    <span class=\"nt\">--assembly</span> GRCh37 <span class=\"nt\">--plugin</span> LoF,loftee_path:.,human_ancestor_fa:human_ancestor.fa.gz,conservation_file:phylocsf_gerp.sql.gz\n<span class=\"c\"># VEP documentation example</span>\nvep <span class=\"nt\">--input_file</span> homo_sapiens_GRCh37.vcf <span class=\"nt\">--output_file</span> <span class=\"nb\">test</span> <span class=\"nt\">--cache</span> <span class=\"nt\">--dir_cache</span> <span class=\"k\">${</span><span class=\"nv\">HPC_WORK</span><span class=\"k\">}</span>/ensembl-vep/.vep <span class=\"nt\">--dir_plugins</span> <span class=\"k\">${</span><span class=\"nv\">HPC_WORK</span><span class=\"k\">}</span>/loftee <span class=\"nt\">--offline</span> <span class=\"se\">\\</span>\n    <span class=\"nt\">--pick</span> <span class=\"nt\">--force_overwrite</span> <span class=\"nt\">--species</span> homo_sapiens <span class=\"nt\">--assembly</span> GRCh37 <span class=\"se\">\\</span>\n    <span class=\"nt\">--plugin</span> LoF,loftee_path:.,human_ancestor_fa:human_ancestor.fa.gz,conservation_file:phylocsf_gerp.sql.gz\n</code></pre> </div></div>\n\n<p>If offers implementation for parsing CSQ field but is also possible with R as described below. Note that if loftee_path uses an absolute path, that path should also be within PERL5LIB, e.g.,</p>\n\n<div class=\"language-plaintext highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>export PERL5LIB=$PERL5LIB:$HPC_WORK/loftee\n</code></pre> </div></div>\n\n<p>is put in .bashrc. We see now all files are provided, and there are complaints over rz was not generated by bgzip, so we do</p>\n\n<div class=\"language-bash highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"c\"># error</span>\nsamtools faidx human_ancestor.fa.rz\n<span class=\"c\"># rework</span>\n<span class=\"nb\">gunzip</span> <span class=\"nt\">-c</span> human_ancestor.fa.rz | bgzip <span class=\"nt\">-c</span> <span class=\"o\">&gt;</span> output.fa.gz\n<span class=\"c\"># check and put it back</span>\nll human_ancestor.fa.rz output.fa.gz\n<span class=\"nb\">mv </span>output.fa.gz human_ancestor.fa.rz\n<span class=\"c\"># now possible and check</span>\nsamtools faidx human_ancestor.fa.rz\nll human_ancestor.fa.<span class=\"k\">*</span>\n</code></pre> </div></div>\n\n<h3 id=\"-r-\">— R —</h3>\n\n<p>This is a wrapper and <code class=\"language-plaintext highlighter-rouge\">the Ensembl VEP perl script must be installed in your path</code>. Expected to be slower than the <code class=\"language-plaintext highlighter-rouge\">--offline</code> mode above, it is\nrelatively easy to set up,</p>\n\n<div class=\"language-r highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"n\">BiocManager</span><span class=\"o\">::</span><span class=\"n\">install</span><span class=\"p\">(</span><span class=\"s2\">\"ensemblVEP\"</span><span class=\"p\">)</span><span class=\"w\">\n</span><span class=\"n\">vignette</span><span class=\"p\">(</span><span class=\"s2\">\"ensemblVEP\"</span><span class=\"p\">)</span><span class=\"w\">\n</span><span class=\"n\">library</span><span class=\"p\">(</span><span class=\"n\">ensemblVEP</span><span class=\"p\">)</span><span class=\"w\">\n</span><span class=\"n\">file</span><span class=\"w\"> </span><span class=\"o\">&lt;-</span><span class=\"w\"> </span><span class=\"n\">system.file</span><span class=\"p\">(</span><span class=\"s2\">\"extdata\"</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"s2\">\"ex2.vcf\"</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">package</span><span class=\"o\">=</span><span class=\"s2\">\"VariantAnnotation\"</span><span class=\"p\">)</span><span class=\"w\">\n</span><span class=\"n\">param</span><span class=\"w\"> </span><span class=\"o\">&lt;-</span><span class=\"w\"> </span><span class=\"n\">VEPFlags</span><span class=\"p\">(</span><span class=\"n\">flags</span><span class=\"o\">=</span><span class=\"nf\">list</span><span class=\"p\">(</span><span class=\"n\">vcf</span><span class=\"o\">=</span><span class=\"kc\">TRUE</span><span class=\"p\">,</span><span class=\"n\">check_existing</span><span class=\"o\">=</span><span class=\"kc\">TRUE</span><span class=\"p\">,</span><span class=\"n\">symbol</span><span class=\"o\">=</span><span class=\"kc\">TRUE</span><span class=\"p\">,</span><span class=\"n\">terms</span><span class=\"o\">=</span><span class=\"s2\">\"SO\"</span><span class=\"p\">,</span><span class=\"n\">sift</span><span class=\"o\">=</span><span class=\"s2\">\"b\"</span><span class=\"p\">,</span><span class=\"n\">polyphen</span><span class=\"o\">=</span><span class=\"s2\">\"p\"</span><span class=\"p\">))</span><span class=\"w\">\n</span><span class=\"n\">vep</span><span class=\"w\"> </span><span class=\"o\">&lt;-</span><span class=\"w\"> </span><span class=\"n\">ensemblVEP</span><span class=\"p\">(</span><span class=\"n\">file</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">param</span><span class=\"p\">)</span><span class=\"w\">\n</span><span class=\"n\">info</span><span class=\"p\">(</span><span class=\"n\">vep</span><span class=\"p\">)</span><span class=\"o\">$</span><span class=\"n\">CSQ</span><span class=\"w\">\n</span><span class=\"n\">csq</span><span class=\"w\"> </span><span class=\"o\">&lt;-</span><span class=\"w\"> </span><span class=\"n\">parseCSQToGRanges</span><span class=\"p\">(</span><span class=\"n\">vep</span><span class=\"p\">)</span><span class=\"w\">\n</span><span class=\"n\">head</span><span class=\"p\">(</span><span class=\"n\">csq</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"m\">2</span><span class=\"p\">)</span><span class=\"w\">\n</span><span class=\"c1\"># clinvar</span><span class=\"w\">\n</span><span class=\"n\">param</span><span class=\"w\"> </span><span class=\"o\">&lt;-</span><span class=\"w\"> </span><span class=\"n\">VEPFlags</span><span class=\"p\">(</span><span class=\"n\">flags</span><span class=\"o\">=</span><span class=\"nf\">list</span><span class=\"p\">(</span><span class=\"n\">vcf</span><span class=\"o\">=</span><span class=\"kc\">TRUE</span><span class=\"p\">,</span><span class=\"n\">output_file</span><span class=\"o\">=</span><span class=\"s2\">\"clinvar.vcf\"</span><span class=\"p\">,</span><span class=\"n\">force_overwrite</span><span class=\"o\">=</span><span class=\"kc\">TRUE</span><span class=\"p\">,</span><span class=\"n\">assembly</span><span class=\"o\">=</span><span class=\"s2\">\"GRCh37\"</span><span class=\"p\">,</span><span class=\"n\">port</span><span class=\"o\">=</span><span class=\"m\">3337</span><span class=\"p\">,</span><span class=\"w\">\n                  </span><span class=\"n\">custom</span><span class=\"o\">=</span><span class=\"s2\">\"clinvar_GRCh37.vcf.gz,ClinVar,vcf,exact,0,CLNSIG,CLNREVSTAT,CLNDN\"</span><span class=\"p\">))</span><span class=\"w\">\n</span><span class=\"n\">ensemblVEP</span><span class=\"p\">(</span><span class=\"n\">file</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">param</span><span class=\"p\">)</span><span class=\"w\">\n</span></code></pre> </div></div>\n\n<p>The second <code class=\"language-plaintext highlighter-rouge\">ensemblVEP</code> obtains <code class=\"language-plaintext highlighter-rouge\">clinvar.vcf</code> and <code class=\"language-plaintext highlighter-rouge\">clinvar.vcf_summary.html</code>. Annotation is made to a VCF file, and returns data with unparsed ‘CSQ’.</p>\n\n<p>The facility to parse the CSQ column of a VCF object is done for the documentation example.</p>\n\n<div class=\"language-r highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"c1\"># VCF output from the VEP web interface or the call above</span><span class=\"w\">\n</span><span class=\"n\">vep</span><span class=\"w\"> </span><span class=\"o\">&lt;-</span><span class=\"w\"> </span><span class=\"s2\">\"INF1.merge.trans.vcf\"</span><span class=\"w\">\n</span><span class=\"c1\"># Parse into a GRanges and include the 'VCFRowID' column.</span><span class=\"w\">\n</span><span class=\"n\">vcf</span><span class=\"w\"> </span><span class=\"o\">&lt;-</span><span class=\"w\"> </span><span class=\"n\">readVcf</span><span class=\"p\">(</span><span class=\"n\">vep</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"s2\">\"hg19\"</span><span class=\"p\">)</span><span class=\"w\">\n</span><span class=\"n\">csq</span><span class=\"w\"> </span><span class=\"o\">&lt;-</span><span class=\"w\"> </span><span class=\"n\">parseCSQToGRanges</span><span class=\"p\">(</span><span class=\"n\">vep</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">VCFRowID</span><span class=\"o\">=</span><span class=\"n\">rownames</span><span class=\"p\">(</span><span class=\"n\">vcf</span><span class=\"p\">))</span><span class=\"w\">\n</span><span class=\"n\">write.table</span><span class=\"p\">(</span><span class=\"n\">mcols</span><span class=\"p\">(</span><span class=\"n\">csq</span><span class=\"p\">),</span><span class=\"n\">file</span><span class=\"o\">=</span><span class=\"s2\">\"INF1.merge.trans.txt\"</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">quote</span><span class=\"o\">=</span><span class=\"kc\">FALSE</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">sep</span><span class=\"o\">=</span><span class=\"s2\">\"\\t\"</span><span class=\"p\">)</span><span class=\"w\">\n</span></code></pre> </div></div>\n\n<p>The dbNSFP counterpart is also possible</p>\n\n<div class=\"language-r highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"n\">BiocManager</span><span class=\"o\">::</span><span class=\"n\">install</span><span class=\"p\">(</span><span class=\"s2\">\"myvariant\"</span><span class=\"p\">)</span><span class=\"w\">\n</span><span class=\"n\">library</span><span class=\"p\">(</span><span class=\"n\">VariantAnnotation</span><span class=\"p\">)</span><span class=\"w\">\n</span><span class=\"n\">file</span><span class=\"w\"> </span><span class=\"o\">&lt;-</span><span class=\"w\"> </span><span class=\"n\">system.file</span><span class=\"p\">(</span><span class=\"s2\">\"extdata\"</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"s2\">\"dbsnp_mini.vcf\"</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">package</span><span class=\"o\">=</span><span class=\"s2\">\"myvariant\"</span><span class=\"p\">)</span><span class=\"w\">\n</span><span class=\"n\">vcf</span><span class=\"w\"> </span><span class=\"o\">&lt;-</span><span class=\"w\"> </span><span class=\"n\">readVcf</span><span class=\"p\">(</span><span class=\"n\">file</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">genome</span><span class=\"o\">=</span><span class=\"s2\">\"hg19\"</span><span class=\"p\">)</span><span class=\"w\">\n</span><span class=\"n\">rowRanges</span><span class=\"p\">(</span><span class=\"n\">vcf</span><span class=\"p\">)</span><span class=\"w\">\n</span><span class=\"n\">library</span><span class=\"p\">(</span><span class=\"n\">myvariant</span><span class=\"p\">)</span><span class=\"w\">\n</span><span class=\"n\">hgvs</span><span class=\"w\"> </span><span class=\"o\">&lt;-</span><span class=\"w\"> </span><span class=\"n\">formatHgvs</span><span class=\"p\">(</span><span class=\"n\">vcf</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">variant_type</span><span class=\"o\">=</span><span class=\"s2\">\"snp\"</span><span class=\"p\">)</span><span class=\"w\">\n</span><span class=\"n\">head</span><span class=\"p\">(</span><span class=\"n\">hgvs</span><span class=\"p\">)</span><span class=\"w\">\n</span><span class=\"n\">getVariants</span><span class=\"p\">(</span><span class=\"n\">hgvs</span><span class=\"p\">)</span><span class=\"w\">\n</span><span class=\"n\">rsids</span><span class=\"w\"> </span><span class=\"o\">&lt;-</span><span class=\"w\"> </span><span class=\"n\">paste</span><span class=\"p\">(</span><span class=\"s2\">\"rs\"</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">info</span><span class=\"p\">(</span><span class=\"n\">vcf</span><span class=\"p\">)</span><span class=\"o\">$</span><span class=\"n\">RS</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">sep</span><span class=\"o\">=</span><span class=\"s2\">\"\"</span><span class=\"p\">)</span><span class=\"w\">\n</span><span class=\"n\">head</span><span class=\"p\">(</span><span class=\"n\">rsids</span><span class=\"p\">)</span><span class=\"w\">\n</span><span class=\"n\">res</span><span class=\"w\"> </span><span class=\"o\">&lt;-</span><span class=\"w\"> </span><span class=\"n\">queryVariants</span><span class=\"p\">(</span><span class=\"n\">q</span><span class=\"o\">=</span><span class=\"n\">rsids</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">scopes</span><span class=\"o\">=</span><span class=\"s2\">\"dbsnp.rsid\"</span><span class=\"p\">,</span><span class=\"w\"> </span><span class=\"n\">fields</span><span class=\"o\">=</span><span class=\"s2\">\"all\"</span><span class=\"p\">)</span><span class=\"w\">\n</span><span class=\"n\">fields</span><span class=\"w\"> </span><span class=\"o\">&lt;-</span><span class=\"w\"> </span><span class=\"nf\">names</span><span class=\"p\">(</span><span class=\"n\">res</span><span class=\"p\">)</span><span class=\"w\">\n</span><span class=\"n\">cadd</span><span class=\"w\"> </span><span class=\"o\">&lt;-</span><span class=\"w\"> </span><span class=\"n\">grep</span><span class=\"p\">(</span><span class=\"s1\">'cadd'</span><span class=\"p\">,</span><span class=\"n\">fields</span><span class=\"p\">)</span><span class=\"w\">\n</span><span class=\"n\">res</span><span class=\"p\">[</span><span class=\"n\">fields</span><span class=\"p\">[</span><span class=\"n\">cadd</span><span class=\"p\">]]</span><span class=\"w\">\n</span></code></pre> </div></div>\n\n<p>Note that the CSQ field could also be handled by bcftools split-vep plugin, see <a href=\"http://samtools.github.io/bcftools/howtos/plugin.split-vep.html\">http://samtools.github.io/bcftools/howtos/plugin.split-vep.html</a>.</p>\n\n<h3 id=\"-docker-\">— docker —</h3>\n\n<p>See <code class=\"language-plaintext highlighter-rouge\">docker/Dockerfile </code> from the GitHub directory above, or https://github.com/Ensembl/ensembl-vep.</p>\n\n<h3 id=\"-virtual-machine-\">— Virtual machine —</h3>\n\n<p>See http://www.ensembl.org/info/data/virtual_machine.html which is possibly best for MicroSoft Windows and is not pursued here.</p>\n\n<p>ENSEMBL-synonym translation (hg19) file</p>\n","dir":"/applications/","name":"VEP.md","path":"applications/VEP.md","url":"/applications/VEP.html"},{"sort":55,"layout":"default","title":"R/xlsx","content":"# R/xlsx\n\nWhen there is message,\n\n```\nError: .onLoad failed in loadNamespace() for 'rJava', details:\n call: dyn.load(file, DLLpath = DLLpath, ...)\n error: unable to load shared object '/rds/user/jhz22/hpc-work/R/rJava/libs/rJava.so':\n libjvm.so: cannot open shared object file: No such file or directory\nExecution halted\nERROR: lazy loading failed for package ‘xlsx’\n* removing ‘/rds/user/jhz22/hpc-work/R/xlsx’\n* restoring previous ‘/rds/user/jhz22/hpc-work/R/xlsx’\n\n```\n\nthen see description on `rJava` earlier.\n","dir":"/applications/","name":"xlsx.md","path":"applications/xlsx.md","url":"/applications/xlsx.html"}]